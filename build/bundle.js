var app=function(){"use strict";function e(){}const t=e=>e;function n(e){return e()}function i(){return Object.create(null)}function r(e){e.forEach(n)}function o(e){return"function"==typeof e}function s(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let a;function c(t,...n){if(null==t)return e;const i=t.subscribe(...n);return i.unsubscribe?()=>i.unsubscribe():i}function l(e,t,n){e.$$.on_destroy.push(c(t,n))}function u(e,t,n,i){if(e){const r=f(e,t,n,i);return e[0](r)}}function f(e,t,n,i){return e[1]&&i?function(e,t){for(const n in t)e[n]=t[n];return e}(n.ctx.slice(),e[1](i(t))):n.ctx}function d(e,t,n,i){if(e[2]&&i){const r=e[2](i(n));if(void 0===t.dirty)return r;if("object"==typeof r){const e=[],n=Math.max(t.dirty.length,r.length);for(let i=0;i<n;i+=1)e[i]=t.dirty[i]|r[i];return e}return t.dirty|r}return t.dirty}function m(e,t,n,i,r,o){if(r){const s=f(t,n,i,o);e.p(s,r)}}function h(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let e=0;e<n;e++)t[e]=-1;return t}return-1}const p="undefined"!=typeof window;let g=p?()=>window.performance.now():()=>Date.now(),w=p?e=>requestAnimationFrame(e):e;const _=new Set;function x(e){_.forEach((t=>{t.c(e)||(_.delete(t),t.f())})),0!==_.size&&w(x)}function v(e){let t;return 0===_.size&&w(x),{promise:new Promise((n=>{_.add(t={c:e,f:n})})),abort(){_.delete(t)}}}function b(e,t){e.appendChild(t)}function $(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function y(e){const t=C("style");return function(e,t){b(e.head||e,t),t.sheet}($(e),t),t.sheet}function k(e,t,n){e.insertBefore(t,n||null)}function I(e){e.parentNode&&e.parentNode.removeChild(e)}function C(e){return document.createElement(e)}function M(e){return document.createTextNode(e)}function A(){return M(" ")}function q(){return M("")}function P(e,t,n,i){return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n,i)}function S(e){return function(t){return t.stopPropagation(),e.call(this,t)}}function R(e){return function(t){t.target===this&&e.call(this,t)}}function F(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function W(e){let t;return{p(...n){t=n,t.forEach((t=>e.push(t)))},r(){t.forEach((t=>e.splice(e.indexOf(t),1)))}}}function E(e){return""===e?null:+e}function X(e,t){t=""+t,e.data!==t&&(e.data=t)}function H(e,t){e.value=null==t?"":t}function T(e,t,n,i){null===n?e.style.removeProperty(t):e.style.setProperty(t,n,i?"important":"")}function L(e,t,n){for(let n=0;n<e.options.length;n+=1){const i=e.options[n];if(i.__value===t)return void(i.selected=!0)}n&&void 0===t||(e.selectedIndex=-1)}const O=new Map;let B,V=0;function N(e,t,n,i,r,o,s,a=0){const c=16.666/i;let l="{\n";for(let e=0;e<=1;e+=c){const i=t+(n-t)*o(e);l+=100*e+`%{${s(i,1-i)}}\n`}const u=l+`100% {${s(n,1-n)}}\n}`,f=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(u)}_${a}`,d=$(e),{stylesheet:m,rules:h}=O.get(d)||function(e,t){const n={stylesheet:y(t),rules:{}};return O.set(e,n),n}(d,e);h[f]||(h[f]=!0,m.insertRule(`@keyframes ${f} ${u}`,m.cssRules.length));const p=e.style.animation||"";return e.style.animation=`${p?`${p}, `:""}${f} ${i}ms linear ${r}ms 1 both`,V+=1,f}function Y(e,t){const n=(e.style.animation||"").split(", "),i=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),r=n.length-i.length;r&&(e.style.animation=i.join(", "),V-=r,V||w((()=>{V||(O.forEach((e=>{const{ownerNode:t}=e.stylesheet;t&&I(t)})),O.clear())})))}function j(e){B=e}function U(){if(!B)throw new Error("Function called outside component initialization");return B}function G(e){U().$$.on_mount.push(e)}function z(e){U().$$.on_destroy.push(e)}function D(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e.call(this,t)))}const Z=[],J=[];let K=[];const Q=[],ee=Promise.resolve();let te=!1;function ne(e){K.push(e)}function ie(e){Q.push(e)}const re=new Set;let oe,se=0;function ae(){if(0!==se)return;const e=B;do{try{for(;se<Z.length;){const e=Z[se];se++,j(e),ce(e.$$)}}catch(e){throw Z.length=0,se=0,e}for(j(null),Z.length=0,se=0;J.length;)J.pop()();for(let e=0;e<K.length;e+=1){const t=K[e];re.has(t)||(re.add(t),t())}K.length=0}while(Z.length);for(;Q.length;)Q.pop()();te=!1,re.clear(),j(e)}function ce(e){if(null!==e.fragment){e.update(),r(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(ne)}}function le(){return oe||(oe=Promise.resolve(),oe.then((()=>{oe=null}))),oe}function ue(e,t,n){e.dispatchEvent(function(e,t,{bubbles:n=!1,cancelable:i=!1}={}){const r=document.createEvent("CustomEvent");return r.initCustomEvent(e,n,i,t),r}(`${t?"intro":"outro"}${n}`))}const fe=new Set;let de;function me(){de={r:0,c:[],p:de}}function he(){de.r||r(de.c),de=de.p}function pe(e,t){e&&e.i&&(fe.delete(e),e.i(t))}function ge(e,t,n,i){if(e&&e.o){if(fe.has(e))return;fe.add(e),de.c.push((()=>{fe.delete(e),i&&(n&&e.d(1),i())})),e.o(t)}else i&&i()}const we={duration:0};const _e="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function xe(e,t){e.d(1),t.delete(e.key)}function ve(e,t){ge(e,1,1,(()=>{t.delete(e.key)}))}function be(e,t,n,i,o,s,a,c,l,u,f,d){let m=e.length,h=s.length,p=m;const g={};for(;p--;)g[e[p].key]=p;const w=[],_=new Map,x=new Map,v=[];for(p=h;p--;){const e=d(o,s,p),r=n(e);let c=a.get(r);c?i&&v.push((()=>c.p(e,t))):(c=u(r,e),c.c()),_.set(r,w[p]=c),r in g&&x.set(r,Math.abs(p-g[r]))}const b=new Set,$=new Set;function y(e){pe(e,1),e.m(c,f),a.set(e.key,e),f=e.first,h--}for(;m&&h;){const t=w[h-1],n=e[m-1],i=t.key,r=n.key;t===n?(f=t.first,m--,h--):_.has(r)?!a.has(i)||b.has(i)?y(t):$.has(r)?m--:x.get(i)>x.get(r)?($.add(i),y(t)):(b.add(r),m--):(l(n,a),m--)}for(;m--;){const t=e[m];_.has(t.key)||l(t,a)}for(;h;)y(w[h-1]);return r(v),w}function $e(e,t,n){const i=e.$$.props[t];void 0!==i&&(e.$$.bound[i]=n,n(e.$$.ctx[i]))}function ye(e){e&&e.c()}function ke(e,t,i,s){const{fragment:a,after_update:c}=e.$$;a&&a.m(t,i),s||ne((()=>{const t=e.$$.on_mount.map(n).filter(o);e.$$.on_destroy?e.$$.on_destroy.push(...t):r(t),e.$$.on_mount=[]})),c.forEach(ne)}function Ie(e,t){const n=e.$$;null!==n.fragment&&(!function(e){const t=[],n=[];K.forEach((i=>-1===e.indexOf(i)?t.push(i):n.push(i))),n.forEach((e=>e())),K=t}(n.after_update),r(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Ce(e,t){-1===e.$$.dirty[0]&&(Z.push(e),te||(te=!0,ee.then(ae)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Me(t,n,o,s,a,c,l,u=[-1]){const f=B;j(t);const d=t.$$={fragment:null,ctx:[],props:c,update:e,not_equal:a,bound:i(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(f?f.$$.context:[])),callbacks:i(),dirty:u,skip_bound:!1,root:n.target||f.$$.root};l&&l(d.root);let m=!1;if(d.ctx=o?o(t,n.props||{},((e,n,...i)=>{const r=i.length?i[0]:n;return d.ctx&&a(d.ctx[e],d.ctx[e]=r)&&(!d.skip_bound&&d.bound[e]&&d.bound[e](r),m&&Ce(t,e)),n})):[],d.update(),m=!0,r(d.before_update),d.fragment=!!s&&s(d.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);d.fragment&&d.fragment.l(e),e.forEach(I)}else d.fragment&&d.fragment.c();n.intro&&pe(t.$$.fragment),ke(t,n.target,n.anchor,n.customElement),ae()}j(f)}class Ae{$destroy(){Ie(this,1),this.$destroy=e}$on(t,n){if(!o(n))return e;const i=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return i.push(n),()=>{const e=i.indexOf(n);-1!==e&&i.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function qe(t){let n,i,r,o,s,a,c,l,u,f=!1;return c=W(t[4][0]),{c(){n=C("label"),i=C("input"),o=A(),s=M(t[2]),F(i,"type","radio"),F(i,"name","app-choice"),F(i,"id",r="tab-"+t[1]),i.__value=t[1],i.value=i.__value,T(i,"display","none"),F(i,"class","svelte-1f39crp"),F(n,"for",a="tab-"+t[1]),F(n,"class","tabs svelte-1f39crp"),T(n,"background-color",t[0]==t[1]?"blue":"white"),c.p(i)},m(e,r){k(e,n,r),b(n,i),i.checked=i.__value===t[0],b(n,o),b(n,s),l||(u=P(i,"change",t[3]),l=!0)},p(e,[t]){2&t&&r!==(r="tab-"+e[1])&&F(i,"id",r),2&t&&(i.__value=e[1],i.value=i.__value,f=!0),(f||1&t)&&(i.checked=i.__value===e[0]),4&t&&X(s,e[2]),2&t&&a!==(a="tab-"+e[1])&&F(n,"for",a),3&t&&T(n,"background-color",e[0]==e[1]?"blue":"white")},i:e,o:e,d(e){e&&I(n),c.r(),l=!1,u()}}}function Pe(e,t,n){let{id:i}=t,{curChoice:r}=t,{text:o}=t;return e.$$set=e=>{"id"in e&&n(1,i=e.id),"curChoice"in e&&n(0,r=e.curChoice),"text"in e&&n(2,o=e.text)},[r,i,o,function(){r=this.__value,n(0,r)},[[]]]}class Se extends Ae{constructor(e){super(),Me(this,e,Pe,qe,s,{id:1,curChoice:0,text:2})}}function Re(e,t){const n=e.replace(/[^A-Za-z0-9+/]/g,""),i=n.length,r=t?Math.ceil((3*i+1>>2)/t)*t:3*i+1>>2,o=new Uint8Array(r);let s,a,c=0,l=0;for(let e=0;e<i;e++)if(a=3&e,c|=((u=n.charCodeAt(e))>64&&u<91?u-65:u>96&&u<123?u-71:u>47&&u<58?u+4:43===u?62:47===u?63:0)<<6*(3-a),3===a||i-e==1){for(s=0;s<3&&l<r;)o[l]=c>>>(16>>>s&24)&255,s++,l++;c=0}var u;return o}function Fe(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65}function We(e){let t=2,n="";const i=e.length;let r=0;for(let o=0;o<i;o++)t=o%3,r|=e[o]<<(16>>>t&24),2!==t&&e.length-o!=1||(n+=String.fromCodePoint(Fe(r>>>18&63),Fe(r>>>12&63),Fe(r>>>6&63),Fe(63&r)),r=0);return n.substring(0,n.length-2+t)+(2===t?"":1===t?"=":"==")}function Ee(e){return We(new Uint8Array(e))}const Xe=[];function He(t,n=e){let i;const r=new Set;function o(e){if(s(t,e)&&(t=e,i)){const e=!Xe.length;for(const e of r)e[1](),Xe.push(e,t);if(e){for(let e=0;e<Xe.length;e+=2)Xe[e][0](Xe[e+1]);Xe.length=0}}}return{set:o,update:function(e){o(e(t))},subscribe:function(s,a=e){const c=[s,a];return r.add(c),1===r.size&&(i=n(o)||e),s(t),()=>{r.delete(c),0===r.size&&i&&(i(),i=null)}}}}const Te=He([]),Le=He(new Map);function Oe(e,t,n=!0){let i=document.createElement("input");i.setAttribute("type","file"),n&&i.setAttribute("multiple","true"),i.setAttribute("style","display: none"),i.setAttribute("accept",t),document.body.append(i),i.onchange=t=>{e(t),document.body.removeChild(i)},i.click()}function Be(e,t){let n=new Blob([e]),i=URL.createObjectURL(n),r=document.createElement("a");r.setAttribute("href",i),r.setAttribute("download",t),r.click()}function Ve(e,t,n=!1){if(n){for(let n=e.length-1;n>=0;n--)if(t(e[n]))return n}else for(let n=0;n<e.length;n++)if(t(e[n]))return n;return null}async function Ne(e){let t;if("single_frame"==e.type){let n=e.imgfileref;t="data:image/png;base64,"+We(new Uint8Array(await n.arrayBuffer()))}else{const n=function(e){let t;return c(e,(e=>t=e))(),t}(Le).get(e.spritesheetId);t=void 0!==n?"data:image/png;base64,"+n[0]:"data:image/png;base64,"}const n=new Image;return n.src=t,await n.decode(),n}async function Ye(e){const t="data:image/png;base64,"+Ee(await e.arrayBuffer()),n=new Image;return n.src=t,await n.decode(),[n.naturalWidth,n.naturalHeight]}function je(e){return!(!e||e.length>255)&&(!/[<>:"/\\|?*\u0000-\u001F]/g.test(e)&&!/^(con|prn|aux|nul|com\d|lpt\d)$/i.test(e)&&("."!==e&&".."!==e))}function Ue(e,t=0){setTimeout(e,t)}const Ge=new class{constructor(){this._val=-1}getNewId(){return this._val++,this._val}};function ze(t){let n,i,o,s,a;return{c(){n=C("button"),n.textContent="Add Icongrid",i=A(),o=C("button"),o.textContent="Clear Icongrid",F(n,"id","add-icongrid"),F(n,"class","svelte-1omodga"),F(o,"id","clear-icongrid"),F(o,"class","svelte-1omodga")},m(e,r){k(e,n,r),k(e,i,r),k(e,o,r),s||(a=[P(n,"click",t[15]),P(o,"click",t[16])],s=!0)},p:e,d(e){e&&I(n),e&&I(i),e&&I(o),s=!1,r(a)}}}function De(t){let n,i,o,s,c,l,u,f,d,m,h,p,g,w,_,x,v,$,y,q,S,R,W,E,H=t[1].length+"",L=t[0]&&ze(t);return{c(){var e,r;n=C("dialog"),n.innerHTML="<p>Creating Icongrid....</p>",i=A(),o=C("div"),s=C("img"),u=A(),f=C("div"),d=C("label"),m=C("input"),h=M("\r\n        Legacy Mode"),p=A(),g=C("p"),w=M("Number of icons selected: "),_=M(H),x=A(),v=C("button"),v.textContent="Clear Icons",$=A(),L&&L.c(),y=A(),q=C("button"),q.textContent="Add Icons",S=A(),R=C("button"),R.textContent="Generate Icongrid",e=s.src,r=c="",a||(a=document.createElement("a")),a.href=r,e!==a.href&&F(s,"src",""),F(s,"alt",l="The "+(t[0]?"":"final")+" icongrid will be displayed here."),F(o,"id","preview-div"),F(o,"class","svelte-1omodga"),F(m,"type","checkbox"),F(m,"name","legacy-mode"),F(m,"id","legacy-mode"),F(m,"class","svelte-1omodga"),F(d,"for","legacy-mode"),F(d,"id","legacy-mode-label"),F(d,"class","svelte-1omodga"),F(g,"class","svelte-1omodga"),F(v,"class","svelte-1omodga"),F(q,"id","add-icons"),F(q,"class","svelte-1omodga"),F(R,"id","generate-grid"),F(R,"class","svelte-1omodga"),F(f,"id","controls"),T(f,"grid-template-columns",t[5]),F(f,"class","svelte-1omodga")},m(e,r){k(e,n,r),t[12](n),k(e,i,r),k(e,o,r),b(o,s),t[13](s),k(e,u,r),k(e,f,r),b(f,d),b(d,m),m.checked=t[0],b(d,h),b(f,p),b(f,g),b(g,w),b(g,_),b(f,x),b(f,v),b(f,$),L&&L.m(f,null),b(f,y),b(f,q),b(f,S),b(f,R),W||(E=[P(m,"change",t[14]),P(v,"click",t[8]),P(q,"click",t[17]),P(R,"click",t[6])],W=!0)},p(e,[t]){1&t&&l!==(l="The "+(e[0]?"":"final")+" icongrid will be displayed here.")&&F(s,"alt",l),1&t&&(m.checked=e[0]),2&t&&H!==(H=e[1].length+"")&&X(_,H),e[0]?L?L.p(e,t):(L=ze(e),L.c(),L.m(f,y)):L&&(L.d(1),L=null),32&t&&T(f,"grid-template-columns",e[5])},i:e,o:e,d(e){e&&I(n),t[12](null),e&&I(i),e&&I(o),t[13](null),e&&I(u),e&&I(f),L&&L.d(),W=!1,r(E)}}}function Ze(e,t,n){let i,{wasm:r}=t,{charname:o}=t,s=!1,a=[],c=null,l=null,u=null;async function f(e){n(4,u=e.target.files[0]),c.setAttribute("src","data:image/png;base64,"+Ee(await u.arrayBuffer()))}function d(e){n(1,a=[])}function m(e){n(1,a=[...e.target.files])}z((()=>{document.removeEventListener("clearIcons",d)})),document.addEventListener("clearIcons",d);return e.$$set=e=>{"wasm"in e&&n(10,r=e.wasm),"charname"in e&&n(11,o=e.charname)},e.$$.update=()=>{1&e.$$.dirty&&n(5,i="2fr"+(s?" 1fr 1fr":"")+" 1fr 1fr 1fr 2fr")},[s,a,c,l,u,i,async function(){if(s)if(a.length>0)if(null!==u){l.showModal();const e=new Uint8Array(await u.arrayBuffer()),t=[];for(let e of a)t.push(Ee(await e.arrayBuffer()));const n=r.make_icongrid_legacy(e,t);c.setAttribute("src","data:image/png;base64,"+We(n)),l.close(),Be(n,"iconGrid.png")}else alert("No Icongrid selected! Please select an icongrid");else alert("No icons selected! Please select some icons");else{const{IconPacker:e}=r,t=e.new();if(a.length>0){l.showModal();for(let e of a)t.add_image(await e.arrayBuffer());let e=t.make_packed_image();c.setAttribute("src","data:image/png;base64,"+We(e)),l.close(),Be(e,`icon-${void 0!==o?o:"character"}.png`)}else alert("No icons selected! Please select some icons")}},f,d,m,r,o,function(e){J[e?"unshift":"push"]((()=>{l=e,n(3,l)}))},function(e){J[e?"unshift":"push"]((()=>{c=e,n(2,c)}))},function(){s=this.checked,n(0,s)},e=>Oe(f,"image/png",!1),()=>{n(4,u=null)},e=>Oe(m,"image/png")]}class Je extends Ae{constructor(e){super(),Me(this,e,Ze,De,s,{wasm:10,charname:11})}}class Ke{constructor(e){this.context=e,this.curFrames=[],this.curImgs=[],this.curFrameIndex=0,this.start=null,this.prev=null,this.ticks=0,this.animId=null,this.fps=24,this.animationScale=1,this.isPlaying=!1}resetAnimation(){this.curFrames=[],this.curImgs=[],this.curFrameIndex=0,this.start=null,this.prev=null,this.ticks=0}tick(e){this.start=e,null===this.prev&&(this.prev=e);const t=this.start-this.prev;if(this.ticks+=t,this.ticks>1e3/this.fps){const e=this.curFrames[this.curFrameIndex],t=this.curImgs[this.curFrameIndex];this.curFrameIndex=(this.curFrameIndex+1)%this.curFrames.length,this.clearCanvas(),this.drawImage(t,e),this.ticks=0}this.animId=requestAnimationFrame((e=>{this.tick(e)})),this.prev=this.start}drawImage(e,t,n=!1,i=!1){const r=t.rect,o=t.frameRect,s=t.transform,a=s.flipX?-1:1,c=s.flipY?-1:1,l=a*this.animationScale,u=c*this.animationScale;this.context.save(),this.context.scale(l,u),s.flipX&&this.context.translate(-s.newWidth,0),s.flipY&&this.context.translate(0,-s.newHeight),this.context.drawImage(e,r.x,r.y,r.width,r.height,-o.frameX*a,-o.frameY*c,s.newWidth,s.newHeight),this.context.restore(),i&&(this.context.clearRect(o.frameWidth*this.animationScale,0,this.context.canvas.width,this.context.canvas.height),this.context.clearRect(0,o.frameHeight*this.animationScale,this.context.canvas.width,this.context.canvas.height)),n&&(this.context.beginPath(),this.context.rect(0,0,o.frameWidth*this.animationScale,o.frameHeight*this.animationScale),this.context.stroke())}async initFrames(e){this.curFrames=e,this.curFrameIndex=0,this.curImgs=await Promise.all(this.curFrames.map((async e=>await Ne(e))))}play(){this.animId=requestAnimationFrame((e=>{this.tick(e)})),this.isPlaying=!0}stopAnimation(){null!==this.animId&&cancelAnimationFrame(this.animId),this.resetAnimation(),this.animId=null,this.isPlaying=!1}clearCanvas(){const e=this.context.canvas.width,t=this.context.canvas.height;this.context.clearRect(0,0,e,t)}}function Qe(t){let n;return{c(){n=C("div"),T(n,"width",tt),T(n,"height",tt+"px")},m(e,t){k(e,n,t)},p:e,d(e){e&&I(n)}}}function et(t){let n,i,o,s,a,c,l,u,f,d,m,h,p,g,w=t[0].animationPrefix+"",_=!t[1]&&Qe();return{c(){n=C("div"),i=C("input"),s=A(),a=C("canvas"),c=M("Rendering Error!\r\n        Please use a browser that supports canvas rendering! (like Chrome or Firefox)"),l=A(),_&&_.c(),u=A(),f=C("p"),d=M(w),m=A(),h=C("button"),h.textContent="Delete",F(i,"type","checkbox"),F(i,"name","selected-chkbox"),F(i,"id","selected-chkbox"),i.checked=o=t[0].selected,T(a,"display",t[1]?"block":"none"),F(a,"width",tt+"px"),F(a,"height",tt+"px"),F(n,"class","frame-container svelte-o46j4u"),T(n,"width",tt+"px")},m(e,r){k(e,n,r),b(n,i),b(n,s),b(n,a),b(a,c),t[8](a),b(n,l),_&&_.m(n,null),b(n,u),b(n,f),b(f,d),b(n,m),b(n,h),t[10](n),p||(g=[P(h,"click",S(t[9])),P(n,"click",t[4])],p=!0)},p(e,[t]){1&t&&o!==(o=e[0].selected)&&(i.checked=o),2&t&&T(a,"display",e[1]?"block":"none"),e[1]?_&&(_.d(1),_=null):_?_.p(e,t):(_=Qe(),_.c(),_.m(n,u)),1&t&&w!==(w=e[0].animationPrefix+"")&&X(d,w)},i:e,o:e,d(e){e&&I(n),t[8](null),_&&_.d(),t[10](null),p=!1,r(g)}}}let tt=120;function nt(e,t,n){let i,r,o,s;l(e,Le,(e=>n(12,i=e))),l(e,Te,(e=>n(13,r=e)));let a,{frameInfo:c}=t,{onRangeClick:u}=t,{rangeSelectionMode:f}=t,d=!1;async function m(){await a.initFrames([c]),a.clearCanvas(),a.animationScale=tt/Math.max(c.frameRect.frameWidth,c.frameRect.frameHeight),a.drawImage(a.curImgs[0],c,!1),n(1,d=!0)}function h(e){const t=r.indexOf(e);if(-1!==t){if(r.splice(t,1),Te.set(r),"spritesheet_frame"===c.type){const e=c.spritesheetId,[t,n]=i.get(e),r=n-1;r>0?Le.update((n=>(n.set(e,[t,r]),n))):Le.update((t=>(t.delete(e),t)))}}else console.log("[ERROR] Could not find element: "+e)}G((()=>{new IntersectionObserver((async(e,t)=>{const i=e[0];i.isIntersecting&&i.intersectionRatio>=.2?d||await m():n(1,d=!1)}),{root:document.getElementById("sprite-frames"),rootMargin:"0px",threshold:[.1,.2]}).observe(s),a=new Ke(o.getContext("2d"))}));return e.$$set=e=>{"frameInfo"in e&&n(0,c=e.frameInfo),"onRangeClick"in e&&n(6,u=e.onRangeClick),"rangeSelectionMode"in e&&n(7,f=e.rangeSelectionMode)},e.$$.update=()=>{3&e.$$.dirty&&d&&c._changed&&(m().then((()=>{})),n(0,c._changed=!1,c))},[c,d,o,s,function(){null!=u&&u(),f||n(0,c.selected=!c.selected,c)},h,u,f,function(e){J[e?"unshift":"push"]((()=>{o=e,n(2,o)}))},()=>{h(c)},function(e){J[e?"unshift":"push"]((()=>{s=e,n(3,s)}))}]}class it extends Ae{constructor(e){super(),Me(this,e,nt,et,s,{frameInfo:0,onRangeClick:6,rangeSelectionMode:7})}}const rt=e=>({}),ot=e=>({}),st=e=>({}),at=e=>({});function ct(e){let t,n,i,o,s,a,c,l,f,p,g,w,_,x,v,$;const y=e[5].header,q=u(y,e,e[4],at),W=e[5].default,E=u(W,e,e[4],null),H=e[5]["accept-btn"],T=u(H,e,e[4],ot);return{c(){t=C("dialog"),n=C("div"),q&&q.c(),i=A(),o=C("hr"),s=A(),E&&E.c(),a=A(),c=C("hr"),l=A(),T&&T.c(),f=A(),p=C("hr"),g=A(),w=C("button"),_=M(e[2]),w.autofocus=!0,F(w,"class","svelte-1ed8403"),F(n,"class","svelte-1ed8403"),F(t,"class","svelte-1ed8403")},m(r,u){k(r,t,u),b(t,n),q&&q.m(n,null),b(n,i),b(n,o),b(n,s),E&&E.m(n,null),b(n,a),b(n,c),b(n,l),T&&T.m(n,null),b(n,f),b(n,p),b(n,g),b(n,w),b(w,_),e[8](t),x=!0,w.focus(),v||($=[P(w,"click",e[7]),P(n,"click",S(e[6])),P(t,"close",e[9]),P(t,"click",R(e[10]))],v=!0)},p(e,[t]){q&&q.p&&(!x||16&t)&&m(q,y,e,e[4],x?d(y,e[4],t,st):h(e[4]),at),E&&E.p&&(!x||16&t)&&m(E,W,e,e[4],x?d(W,e[4],t,null):h(e[4]),null),T&&T.p&&(!x||16&t)&&m(T,H,e,e[4],x?d(H,e[4],t,rt):h(e[4]),ot),(!x||4&t)&&X(_,e[2])},i(e){x||(pe(q,e),pe(E,e),pe(T,e),x=!0)},o(e){ge(q,e),ge(E,e),ge(T,e),x=!1},d(n){n&&I(t),q&&q.d(n),E&&E.d(n),T&&T.d(n),e[8](null),v=!1,r($)}}}function lt(e,t,n){let i,{$$slots:r={},$$scope:o}=t,{showModal:s}=t,{onClose:a=(()=>{})}=t,{closeButtonMsg:c="Close"}=t;return e.$$set=e=>{"showModal"in e&&n(0,s=e.showModal),"onClose"in e&&n(1,a=e.onClose),"closeButtonMsg"in e&&n(2,c=e.closeButtonMsg),"$$scope"in e&&n(4,o=e.$$scope)},e.$$.update=()=>{9&e.$$.dirty&&i&&(s?i.showModal():i.close())},[s,a,c,i,o,r,function(t){D.call(this,e,t)},()=>i.close(),function(e){J[e?"unshift":"push"]((()=>{i=e,n(3,i)}))},()=>{n(0,s=!1),a()},()=>i.close()]}class ut extends Ae{constructor(e){super(),Me(this,e,lt,ct,s,{showModal:0,onClose:1,closeButtonMsg:2})}}const{Map:ft}=_e;function dt(e,t,n){const i=e.slice();return i[14]=t[n],i}function mt(e,t){let n,i,r,o=t[14]+"";return{key:e,first:null,c(){n=C("option"),i=M(o),n.__value=r=t[14],n.value=n.__value,this.first=n},m(e,t){k(e,n,t),b(n,i)},p(e,s){t=e,2&s&&o!==(o=t[14]+"")&&X(i,o),2&s&&r!==(r=t[14])&&(n.__value=r,n.value=n.__value)},d(e){e&&I(n)}}}function ht(e){let t,n,i,o,s,a,c,l,u;return{c(){t=C("label"),n=C("input"),i=M("\r\n                FPS"),o=A(),s=C("label"),a=C("input"),c=M("\r\n                Animation Scale"),F(n,"type","number"),F(n,"name","fps"),F(n,"id","fps"),F(n,"min","1"),F(n,"max","120"),F(t,"for","fps"),F(a,"type","number"),F(a,"name","anim-scale"),F(a,"id","anim-scale"),F(a,"min","0.01"),F(a,"max","4"),F(a,"step","0.01"),F(s,"for","fps")},m(r,f){k(r,t,f),b(t,n),H(n,e[2].fps),b(t,i),k(r,o,f),k(r,s,f),b(s,a),H(a,e[2].animationScale),b(s,c),l||(u=[P(n,"input",e[10]),P(a,"input",e[11])],l=!0)},p(e,t){4&t&&E(n.value)!==e[2].fps&&H(n,e[2].fps),4&t&&E(a.value)!==e[2].animationScale&&H(a,e[2].animationScale)},d(e){e&&I(t),e&&I(o),e&&I(s),l=!1,r(u)}}}function pt(e){let t,n,i,o,s,a,c,l,u,f,d,m=[],h=new ft,p=e[2]?.isPlaying?"Stop":"Play",g=e[1];const w=e=>e[14];for(let t=0;t<g.length;t+=1){let n=dt(e,g,t),i=w(n);h.set(i,m[t]=mt(i,n))}let _=e[2]&&ht(e);return{c(){t=C("div"),n=C("select");for(let e=0;e<m.length;e+=1)m[e].c();i=A(),o=C("button"),s=M(p),a=M(" Animation"),c=A(),_&&_.c(),l=A(),u=C("canvas"),F(n,"name","anim-prefix"),F(n,"id","anim-prefix"),void 0===e[4]&&ne((()=>e[9].call(n)))},m(r,h){k(r,t,h),b(t,n);for(let e=0;e<m.length;e+=1)m[e]&&m[e].m(n,null);L(n,e[4],!0),b(t,i),b(t,o),b(o,s),b(o,a),b(t,c),_&&_.m(t,null),k(r,l,h),k(r,u,h),e[12](u),f||(d=[P(n,"change",e[8]),P(n,"change",e[9]),P(o,"click",e[5])],f=!0)},p(e,i){2&i&&(g=e[1],m=be(m,i,w,1,e,g,h,n,xe,mt,null,dt)),18&i&&L(n,e[4]),4&i&&p!==(p=e[2]?.isPlaying?"Stop":"Play")&&X(s,p),e[2]?_?_.p(e,i):(_=ht(e),_.c(),_.m(t,null)):_&&(_.d(1),_=null)},d(n){n&&I(t);for(let e=0;e<m.length;e+=1)m[e].d();_&&_.d(),n&&I(l),n&&I(u),e[12](null),f=!1,r(d)}}}function gt(t){let n;return{c(){n=C("h4"),n.textContent="View Animation",F(n,"slot","header")},m(e,t){k(e,n,t)},p:e,d(e){e&&I(n)}}}function wt(e){let t,n,i;function r(t){e[13](t)}let o={$$slots:{header:[gt],default:[pt]},$$scope:{ctx:e}};return void 0!==e[0]&&(o.showModal=e[0]),t=new ut({props:o}),J.push((()=>$e(t,"showModal",r))),{c(){ye(t.$$.fragment)},m(e,n){ke(t,e,n),i=!0},p(e,[i]){const r={};131102&i&&(r.$$scope={dirty:i,ctx:e}),!n&&1&i&&(n=!0,r.showModal=e[0],ie((()=>n=!1))),t.$set(r)},i(e){i||(pe(t.$$.fragment,e),i=!0)},o(e){ge(t.$$.fragment,e),i=!1},d(e){Ie(t,e)}}}function _t(e,t,n){let i;l(e,Te,(e=>n(7,i=e)));let r,{showView:o=!1}=t,s=null,a=new Map,c=[],u=null;G((()=>{n(2,u=new Ke(s.getContext("2d")))}));return e.$$set=e=>{"showView"in e&&n(0,o=e.showView)},e.$$.update=()=>{if(5&e.$$.dirty&&null!==u&&(o?(console.log("Clearing canvas: ",u.isPlaying),u.clearCanvas()):u.stopAnimation(),n(2,u),n(0,o)),195&e.$$.dirty&&o){n(6,a=new Map),n(1,c=[]);for(let e of i)if(a.has(e.animationPrefix)){let t=a.get(e.animationPrefix);a.set(e.animationPrefix,[...t,e])}else a.set(e.animationPrefix,[e]);for(let e of a.keys())n(1,c=[...c,e])}},[o,c,u,s,r,async function(){null===u.animId?(await u.initFrames(a.get(r)),u.play(),n(2,u.context.canvas.width=.9*window.innerWidth,u),n(2,u.context.canvas.height=.9*window.innerHeight,u)):u.stopAnimation(),console.log("Anim is "+u.animId),n(2,u),n(0,o)},a,i,()=>{u.stopAnimation(),n(2,u),n(0,o)},function(){r=function(e){const t=e.querySelector(":checked");return t&&t.__value}(this),n(4,r),n(1,c),n(0,o),n(7,i),n(6,a)},function(){u.fps=E(this.value),n(2,u),n(0,o)},function(){u.animationScale=E(this.value),n(2,u),n(0,o)},function(e){J[e?"unshift":"push"]((()=>{s=e,n(3,s)}))},function(e){o=e,n(0,o)}]}class xt extends Ae{constructor(e){super(),Me(this,e,_t,wt,s,{showView:0})}}function vt(e,t,n){const i=e.slice();return i[34]=t[n],i[35]=t,i[36]=n,i}function bt(e,t){let n,i,o,s,a,c,l,u,f,d,m,h,p,g,w,_,x,v,$,y,q,R,W,E,H,T,L,O,B,V,N,Y,j,U,G,z,D,Z,J,K,Q,ee=t[34].animationPrefix+"",te=t[34].rect.width+"",ne=t[34].rect.height+"",ie=t[34].frameRect.frameX+"",re=t[34].frameRect.frameY+"",oe=t[34].frameRect.frameWidth+"",se=t[34].frameRect.frameHeight+"",ae=t[34].transform.newWidth+"",ce=t[34].transform.newHeight+"",le=t[34].transform.flipX+"",ue=t[34].transform.flipY+"",fe=t[36];function de(...e){return t[17](t[36],t[34],...e)}const me=()=>t[18](n,fe),he=()=>t[18](null,fe);function pe(...e){return t[19](t[36],t[34],...e)}return{key:e,first:null,c(){n=C("tr"),i=C("td"),o=C("input"),c=A(),l=C("td"),u=M(ee),f=A(),d=C("td"),m=M(te),h=A(),p=C("td"),g=M(ne),w=A(),_=C("td"),x=M(ie),v=A(),$=C("td"),y=M(re),q=A(),R=C("td"),W=M(oe),E=A(),H=C("td"),T=M(se),L=A(),O=C("td"),B=M(ae),V=A(),N=C("td"),Y=M(ce),j=A(),U=C("td"),G=M(le),z=A(),D=C("td"),Z=M(ue),J=A(),F(o,"type","checkbox"),F(o,"name",s="select-"+t[34].sprId),F(o,"id",a="select-"+t[34].sprId),F(o,"class","svelte-1qvrxoo"),F(i,"class","svelte-1qvrxoo"),F(l,"class","svelte-1qvrxoo"),F(d,"class","svelte-1qvrxoo"),F(p,"class","svelte-1qvrxoo"),F(_,"class","svelte-1qvrxoo"),F($,"class","svelte-1qvrxoo"),F(R,"class","svelte-1qvrxoo"),F(H,"class","svelte-1qvrxoo"),F(O,"class","svelte-1qvrxoo"),F(N,"class","svelte-1qvrxoo"),F(U,"class","svelte-1qvrxoo"),F(D,"class","svelte-1qvrxoo"),this.first=n},m(e,t){k(e,n,t),b(n,i),b(i,o),b(n,c),b(n,l),b(l,u),b(n,f),b(n,d),b(d,m),b(n,h),b(n,p),b(p,g),b(n,w),b(n,_),b(_,x),b(n,v),b(n,$),b($,y),b(n,q),b(n,R),b(R,W),b(n,E),b(n,H),b(H,T),b(n,L),b(n,O),b(O,B),b(n,V),b(n,N),b(N,Y),b(n,j),b(n,U),b(U,G),b(n,z),b(n,D),b(D,Z),b(n,J),me(),K||(Q=[P(o,"change",de),P(n,"click",S(pe))],K=!0)},p(e,n){t=e,4096&n[0]&&s!==(s="select-"+t[34].sprId)&&F(o,"name",s),4096&n[0]&&a!==(a="select-"+t[34].sprId)&&F(o,"id",a),4096&n[0]&&ee!==(ee=t[34].animationPrefix+"")&&X(u,ee),4096&n[0]&&te!==(te=t[34].rect.width+"")&&X(m,te),4096&n[0]&&ne!==(ne=t[34].rect.height+"")&&X(g,ne),4096&n[0]&&ie!==(ie=t[34].frameRect.frameX+"")&&X(x,ie),4096&n[0]&&re!==(re=t[34].frameRect.frameY+"")&&X(y,re),4096&n[0]&&oe!==(oe=t[34].frameRect.frameWidth+"")&&X(W,oe),4096&n[0]&&se!==(se=t[34].frameRect.frameHeight+"")&&X(T,se),4096&n[0]&&ae!==(ae=t[34].transform.newWidth+"")&&X(B,ae),4096&n[0]&&ce!==(ce=t[34].transform.newHeight+"")&&X(Y,ce),4096&n[0]&&le!==(le=t[34].transform.flipX+"")&&X(G,le),4096&n[0]&&ue!==(ue=t[34].transform.flipY+"")&&X(Z,ue),fe!==t[36]&&(he(),fe=t[36],me())},d(e){e&&I(n),he(),K=!1,r(Q)}}}function $t(e){let t,n,i,o,s,a,c,l,u,f,d,m,h,p,g,w,_,x,v,$,y,q,S,R,W,E,X,H,T,L,O,B,V,N,Y,j,U,G,z,D,Z,J,K,Q,ee,te,ne,ie,re,oe=[],se=new Map,ae=e[12];const ce=e=>e[34].sprId;for(let t=0;t<ae.length;t+=1){let n=vt(e,ae,t),i=ce(n);se.set(i,oe[t]=bt(i,n))}return{c(){t=C("div"),n=C("div"),i=C("table"),o=C("thead"),o.innerHTML='<th class="svelte-1qvrxoo"></th> \n                    <th class="svelte-1qvrxoo">Prefix</th> \n                    <th class="svelte-1qvrxoo">Width</th> \n                    <th class="svelte-1qvrxoo">Height</th> \n                    <th class="svelte-1qvrxoo">Frame X</th> \n                    <th class="svelte-1qvrxoo">Frame Y</th> \n                    <th class="svelte-1qvrxoo">Frame Width</th> \n                    <th class="svelte-1qvrxoo">Frame Height</th> \n                    <th class="svelte-1qvrxoo">New Image Width</th> \n                    <th class="svelte-1qvrxoo">New Image Height</th> \n                    <th class="svelte-1qvrxoo">flip X</th> \n                    <th class="svelte-1qvrxoo">flip Y</th>',s=A(),a=C("tbody");for(let e=0;e<oe.length;e+=1)oe[e].c();c=A(),l=C("div"),u=C("div"),f=C("label"),d=M("Frame X\r\n                    "),m=C("input"),h=A(),p=C("label"),g=M("Frame Y\r\n                    "),w=C("input"),_=A(),x=C("label"),v=M("Frame Width\r\n                    "),$=C("input"),y=A(),q=C("label"),S=M("Frame Height\r\n                    "),R=C("input"),W=A(),E=C("label"),X=M("Image Width\r\n                    "),H=C("input"),T=A(),L=C("label"),O=M("Image Height\r\n                    "),B=C("input"),V=A(),N=C("label"),Y=M("Flip X\r\n                    "),j=C("input"),U=A(),G=C("label"),z=M("Flip Y\r\n                    "),D=C("input"),Z=A(),J=C("label"),K=M("Animation Scale\r\n                    "),Q=C("input"),ee=A(),te=C("div"),ne=C("canvas"),F(i,"class","not-selectable svelte-1qvrxoo"),F(n,"id","table-div"),F(n,"class","svelte-1qvrxoo"),F(m,"type","number"),F(m,"name","frame-x"),F(m,"id","frame-x"),F(m,"class","svelte-1qvrxoo"),F(f,"class","xmlview-input svelte-1qvrxoo"),F(f,"for","frame-x"),F(w,"type","number"),F(w,"name","frame-y"),F(w,"id","frame-y"),F(w,"class","svelte-1qvrxoo"),F(p,"class","xmlview-input svelte-1qvrxoo"),F(p,"for","frame-y"),F($,"type","number"),F($,"name","frame-width"),F($,"id","frame-width"),F($,"class","svelte-1qvrxoo"),F(x,"class","xmlview-input svelte-1qvrxoo"),F(x,"for","frame-width"),F(R,"type","number"),F(R,"name","frame-height"),F(R,"id","frame-height"),F(R,"class","svelte-1qvrxoo"),F(q,"class","xmlview-input svelte-1qvrxoo"),F(q,"for","frame-height"),F(H,"type","number"),F(H,"name","scale-x"),F(H,"id","scale-x"),F(H,"min","1"),F(H,"class","svelte-1qvrxoo"),F(E,"class","xmlview-input svelte-1qvrxoo"),F(E,"for","scale-x"),F(B,"type","number"),F(B,"name","scale-y"),F(B,"id","scale-y"),F(B,"min","1"),F(B,"class","svelte-1qvrxoo"),F(L,"class","xmlview-input svelte-1qvrxoo"),F(L,"for","scale-y"),F(j,"type","checkbox"),F(j,"name","flip-x"),F(j,"id","flip-x"),F(j,"class","svelte-1qvrxoo"),F(N,"class","xmlview-input svelte-1qvrxoo"),F(N,"for","flip-x"),F(D,"type","checkbox"),F(D,"name","flip-y"),F(D,"id","flip-y"),F(D,"class","svelte-1qvrxoo"),F(G,"class","xmlview-input svelte-1qvrxoo"),F(G,"for","flip-y"),F(Q,"type","number"),F(Q,"name","animation-scale"),F(Q,"id","animation-scale"),F(Q,"min","0.01"),F(Q,"step","0.01"),F(Q,"class","svelte-1qvrxoo"),F(J,"class","xmlview-input svelte-1qvrxoo"),F(J,"for","animation-scale"),F(u,"class","controls-horizontal svelte-1qvrxoo"),F(ne,"width","550px"),F(ne,"height","500px"),F(ne,"class","svelte-1qvrxoo"),F(te,"class","canvas-div svelte-1qvrxoo"),F(t,"id","view-container"),F(t,"class","svelte-1qvrxoo")},m(r,I){k(r,t,I),b(t,n),b(n,i),b(i,o),b(i,s),b(i,a);for(let e=0;e<oe.length;e+=1)oe[e]&&oe[e].m(a,null);b(t,c),b(t,l),b(l,u),b(u,f),b(f,d),b(f,m),e[20](m),b(u,h),b(u,p),b(p,g),b(p,w),e[21](w),b(u,_),b(u,x),b(x,v),b(x,$),e[22]($),b(u,y),b(u,q),b(q,S),b(q,R),e[23](R),b(u,W),b(u,E),b(E,X),b(E,H),e[24](H),b(u,T),b(u,L),b(L,O),b(L,B),e[25](B),b(u,V),b(u,N),b(N,Y),b(N,j),e[26](j),b(u,U),b(u,G),b(G,z),b(G,D),e[27](D),b(u,Z),b(u,J),b(J,K),b(J,Q),e[28](Q),b(l,ee),b(l,te),b(te,ne),e[29](ne),ie||(re=[P(m,"input",e[16]),P(w,"input",e[16]),P($,"input",e[16]),P(R,"input",e[16]),P(H,"input",e[16]),P(B,"input",e[16]),P(j,"input",e[16]),P(D,"input",e[16]),P(Q,"input",e[14])],ie=!0)},p(e,t){46080&t[0]&&(ae=e[12],oe=be(oe,t,ce,1,e,ae,se,a,xe,bt,null,vt))},d(n){n&&I(t);for(let e=0;e<oe.length;e+=1)oe[e].d();e[20](null),e[21](null),e[22](null),e[23](null),e[24](null),e[25](null),e[26](null),e[27](null),e[28](null),e[29](null),ie=!1,r(re)}}}function yt(t){let n;return{c(){n=C("div"),n.innerHTML="<h4>XML View</h4>",F(n,"slot","header")},m(e,t){k(e,n,t)},p:e,d(e){e&&I(n)}}}function kt(e){let t,n,i;function r(t){e[30](t)}let o={closeButtonMsg:"Save and Close",$$slots:{header:[yt],default:[$t]},$$scope:{ctx:e}};return void 0!==e[0]&&(o.showModal=e[0]),t=new ut({props:o}),J.push((()=>$e(t,"showModal",r))),{c(){ye(t.$$.fragment)},m(e,n){ke(t,e,n),i=!0},p(e,i){const r={};8190&i[0]|64&i[1]&&(r.$$scope={dirty:i,ctx:e}),!n&&1&i[0]&&(n=!0,r.showModal=e[0],ie((()=>n=!1))),t.$set(r)},i(e){i||(pe(t.$$.fragment,e),i=!0)},o(e){ge(t.$$.fragment,e),i=!1},d(e){Ie(t,e)}}}function It(e,t,n){let i;l(e,Te,(e=>n(12,i=e)));let{showView:r=!1}=t,o=null,s=null,a=null,c=null,u=null,f=null,d=null,m=null,h=null,p=null,g=[],w=null,_=new Ke(null);async function x(e){w&&(await _.initFrames([e]),_.clearCanvas(),_.drawImage(_.curImgs[0],e,!0))}function v(e){o=i[e];for(const e of g)e&&(e.style.backgroundColor="white");n(10,g[e].style.backgroundColor="blue",g),n(2,a.value=""+o.frameRect.frameX,a),n(3,c.value=""+o.frameRect.frameY,c),n(4,u.value=""+o.frameRect.frameWidth,u),n(5,f.value=""+o.frameRect.frameHeight,f),n(6,d.value=""+o.transform.newWidth,d),n(7,m.value=""+o.transform.newHeight,m),n(8,h.checked=o.transform.flipX,h),n(9,p.checked=o.transform.flipY,p)}G((()=>{_=new Ke(w.getContext("2d")),n(1,s.value=""+_.animationScale,s)}));return e.$$set=e=>{"showView"in e&&n(0,r=e.showView)},[r,s,a,c,u,f,d,m,h,p,g,w,i,x,function(e){_.animationScale=parseFloat(e.target.value),x(o).then((()=>{}))},v,function(e){o.frameRect.frameX=+a.value,o.frameRect.frameY=+c.value,o.frameRect.frameWidth=+u.value,o.frameRect.frameHeight=+f.value,o.transform.newWidth=+d.value,o.transform.newHeight=+m.value,o.transform.flipX=h.checked,o.transform.flipY=p.checked,o._changed=!0,Te.set(i),x(o).then((()=>{}))},async(e,t,n)=>{v(e),await x(t)},function(e,t){J[e?"unshift":"push"]((()=>{g[t]=e,n(10,g)}))},async(e,t,n)=>{v(e),await x(t)},function(e){J[e?"unshift":"push"]((()=>{a=e,n(2,a)}))},function(e){J[e?"unshift":"push"]((()=>{c=e,n(3,c)}))},function(e){J[e?"unshift":"push"]((()=>{u=e,n(4,u)}))},function(e){J[e?"unshift":"push"]((()=>{f=e,n(5,f)}))},function(e){J[e?"unshift":"push"]((()=>{d=e,n(6,d)}))},function(e){J[e?"unshift":"push"]((()=>{m=e,n(7,m)}))},function(e){J[e?"unshift":"push"]((()=>{h=e,n(8,h)}))},function(e){J[e?"unshift":"push"]((()=>{p=e,n(9,p)}))},function(e){J[e?"unshift":"push"]((()=>{s=e,n(1,s)}))},function(e){J[e?"unshift":"push"]((()=>{w=e,n(11,w)}))},function(e){r=e,n(0,r)}]}class Ct extends Ae{constructor(e){super(),Me(this,e,It,kt,s,{showView:0},null,[-1,-1])}}class Mt{constructor(e,t,n,i,r){this.sprId=e,this.type=t,this.imgfileref=n,this.xmlfileref=i,this.selected=!1,this.spritesheetId=r,this.animationPrefix="",this.rect={x:0,y:0,width:null,height:null},this.transform={newWidth:null,newHeight:null,flipX:!1,flipY:!1},this.frameRect={frameX:0,frameY:0,frameWidth:null,frameHeight:null},this._changed=!1}clone(){const e=new Mt(this.sprId,this.type,this.imgfileref,this.xmlfileref,this.spritesheetId);return e.selected=this.selected,e.animationPrefix=this.animationPrefix,e.rect=Object.assign({},this.rect),e.transform=Object.assign({},this.transform),e.frameRect=Object.assign({},this.frameRect),e}}function At(e){let t,n,i,o,s,a,c,l,u,f,d,m,h,p,g,w,_,x,v,$,y,q,S,R,X,T,L,O,B,V,N,Y,j,U,G,z,D,Z,J,K,Q,ee,te,ne,ie,re,oe,se;return re=W(e[4][0]),{c(){t=C("div"),n=C("label"),n.textContent="Image Padding",i=A(),o=C("input"),s=A(),a=C("br"),c=A(),l=C("br"),u=A(),f=C("br"),d=A(),m=C("label"),m.textContent="Animation Name Prefixing",h=A(),p=C("br"),g=A(),w=C("label"),_=C("input"),x=M("\r\n            Use character name as prefix"),v=A(),$=C("label"),y=C("input"),q=M("\r\n            Use custom name as prefix"),S=A(),R=C("label"),R.textContent="Custom Prefix",X=A(),T=C("input"),O=A(),B=C("label"),V=C("input"),N=M("\r\n            Do not use a prefix"),Y=A(),j=C("br"),U=A(),G=C("label"),z=C("input"),D=M("\r\n            Use Prefix even if frame is imported from existing Spritesheet"),Z=A(),J=C("label"),J.textContent="Image Sequence Generation",K=A(),Q=C("br"),ee=A(),te=C("label"),ne=C("input"),ie=M("\r\n            Generate Unique Frames Only when exporting as Image Sequence"),F(n,"for","padding"),F(o,"type","number"),F(o,"name","padding"),F(o,"id","padding"),F(o,"min","0"),F(o,"max","20"),F(m,"for","prefix-type"),F(_,"type","radio"),F(_,"name","prefix-type"),F(_,"id","prefix-type-character-name"),_.__value="character-name",_.value=_.__value,F(w,"for","prefix-type-character-name"),F(y,"type","radio"),F(y,"name","prefix-type"),F(y,"id","prefix-type-custom-prefix"),y.__value="custom-prefix",y.value=y.__value,F($,"for","prefix-type-custom-prefix"),F(R,"for","custom-prefix"),F(T,"type","text"),F(T,"id","custom-prefix"),T.disabled=L="custom-prefix"!==e[1].prefixType,F(V,"type","radio"),F(V,"name","prefix-type"),F(V,"id","prefix-type-no-prefix"),V.__value="no-prefix",V.value=V.__value,F(B,"for","prefix-type-no-prefix"),F(z,"type","checkbox"),F(z,"name","use-prefix-on-existing-xmls"),F(z,"id","use-prefix-on-existing-xmls"),F(G,"for","use-prefix-on-existing-xmls"),F(J,"for","img-seq-gen"),F(ne,"type","checkbox"),F(ne,"name","img-seq-gen"),F(ne,"id","img-seq-gen"),F(te,"for","img-seq-gen"),F(t,"id","modal-content"),F(t,"class","svelte-6d2dce"),re.p(_,y,V)},m(r,I){k(r,t,I),b(t,n),b(t,i),b(t,o),H(o,e[1].padding),b(t,s),b(t,a),b(t,c),b(t,l),b(t,u),b(t,f),b(t,d),b(t,m),b(t,h),b(t,p),b(t,g),b(t,w),b(w,_),_.checked=_.__value===e[1].prefixType,b(w,x),b(t,v),b(t,$),b($,y),y.checked=y.__value===e[1].prefixType,b($,q),b(t,S),b(t,R),b(t,X),b(t,T),H(T,e[1].customPrefix),b(t,O),b(t,B),b(B,V),V.checked=V.__value===e[1].prefixType,b(B,N),b(t,Y),b(t,j),b(t,U),b(t,G),b(G,z),z.checked=e[1].usePrefixOnXMLFrames,b(G,D),b(t,Z),b(t,J),b(t,K),b(t,Q),b(t,ee),b(t,te),b(te,ne),ne.checked=e[1].uniqueFramesOnly,b(te,ie),oe||(se=[P(o,"input",e[2]),P(_,"change",e[3]),P(y,"change",e[5]),P(T,"input",e[6]),P(V,"change",e[7]),P(z,"change",e[8]),P(ne,"change",e[9])],oe=!0)},p(e,t){2&t&&E(o.value)!==e[1].padding&&H(o,e[1].padding),2&t&&(_.checked=_.__value===e[1].prefixType),2&t&&(y.checked=y.__value===e[1].prefixType),2&t&&L!==(L="custom-prefix"!==e[1].prefixType)&&(T.disabled=L),2&t&&T.value!==e[1].customPrefix&&H(T,e[1].customPrefix),2&t&&(V.checked=V.__value===e[1].prefixType),2&t&&(z.checked=e[1].usePrefixOnXMLFrames),2&t&&(ne.checked=e[1].uniqueFramesOnly)},d(e){e&&I(t),re.r(),oe=!1,r(se)}}}function qt(t){let n;return{c(){n=C("h4"),n.textContent="Settings",F(n,"slot","header"),F(n,"class","svelte-6d2dce")},m(e,t){k(e,n,t)},p:e,d(e){e&&I(n)}}}function Pt(e){let t,n,i;function r(t){e[10](t)}let o={$$slots:{header:[qt],default:[At]},$$scope:{ctx:e}};return void 0!==e[0]&&(o.showModal=e[0]),t=new ut({props:o}),J.push((()=>$e(t,"showModal",r))),{c(){ye(t.$$.fragment)},m(e,n){ke(t,e,n),i=!0},p(e,[i]){const r={};2050&i&&(r.$$scope={dirty:i,ctx:e}),!n&&1&i&&(n=!0,r.showModal=e[0],ie((()=>n=!1))),t.$set(r)},i(e){i||(pe(t.$$.fragment,e),i=!0)},o(e){ge(t.$$.fragment,e),i=!1},d(e){Ie(t,e)}}}function St(e,t,n){let{showView:i=!1}=t,{settings:r={padding:2,prefixType:"no-prefix",usePrefixOnXMLFrames:!1,customPrefix:"",uniqueFramesOnly:!1}}=t;return e.$$set=e=>{"showView"in e&&n(0,i=e.showView),"settings"in e&&n(1,r=e.settings)},[i,r,function(){r.padding=E(this.value),n(1,r)},function(){r.prefixType=this.__value,n(1,r)},[[]],function(){r.prefixType=this.__value,n(1,r)},function(){r.customPrefix=this.value,n(1,r)},function(){r.prefixType=this.__value,n(1,r)},function(){r.usePrefixOnXMLFrames=this.checked,n(1,r)},function(){r.uniqueFramesOnly=this.checked,n(1,r)},function(e){i=e,n(0,i)}]}class Rt extends Ae{constructor(e){super(),Me(this,e,St,Pt,s,{showView:0,settings:1})}}function Ft(e){return(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1)}function Wt(n){let i,s,a,c;const l=n[7].default,f=u(l,n,n[6],null);return{c(){i=C("div"),f&&f.c(),F(i,"class","drop-up-menu svelte-1m12fbh")},m(e,t){k(e,i,t),f&&f.m(i,null),n[10](i),c=!0},p(e,t){n=e,f&&f.p&&(!c||64&t)&&m(f,l,n,n[6],c?d(l,n[6],t,null):h(n[6]),null)},i(r){c||(pe(f,r),ne((()=>{c&&(a&&a.end(1),s=function(n,i,r){const s={direction:"in"};let a,c,l=i(n,r,s),u=!1,f=0;function d(){a&&Y(n,a)}function m(){const{delay:i=0,duration:r=300,easing:o=t,tick:s=e,css:m}=l||we;m&&(a=N(n,0,1,r,i,o,m,f++)),s(0,1);const h=g()+i,p=h+r;c&&c.abort(),u=!0,ne((()=>ue(n,!0,"start"))),c=v((e=>{if(u){if(e>=p)return s(1,0),ue(n,!0,"end"),d(),u=!1;if(e>=h){const t=o((e-h)/r);s(t,1-t)}}return u}))}let h=!1;return{start(){h||(h=!0,Y(n),o(l)?(l=l(s),le().then(m)):m())},invalidate(){h=!1},end(){u&&(d(),u=!1)}}}(i,n[4],{duration:100,easing:Ft}),s.start())})),c=!0)},o(l){ge(f,l),s&&s.invalidate(),a=function(n,i,s){const a={direction:"out"};let c,l=i(n,s,a),u=!0;const f=de;function d(){const{delay:i=0,duration:o=300,easing:s=t,tick:a=e,css:d}=l||we;d&&(c=N(n,1,0,o,i,s,d));const m=g()+i,h=m+o;ne((()=>ue(n,!1,"start"))),v((e=>{if(u){if(e>=h)return a(0,1),ue(n,!1,"end"),--f.r||r(f.c),!1;if(e>=m){const t=s((e-m)/o);a(1-t,t)}}return u}))}return f.r+=1,o(l)?le().then((()=>{l=l(a),d()})):d(),{end(e){e&&l.tick&&l.tick(1,0),u&&(c&&Y(n,c),u=!1)}}}(i,n[4],{duration:100,easing:Ft}),c=!1},d(e){e&&I(i),f&&f.d(e),n[10](null),e&&a&&a.end()}}}function Et(e){let t,n,i,r,o,s,a,c=e[2]&&Wt(e);return{c(){t=C("button"),n=M(e[0]),i=A(),c&&c.c(),r=q()},m(l,u){k(l,t,u),b(t,n),e[8](t),k(l,i,u),c&&c.m(l,u),k(l,r,u),o=!0,s||(a=P(t,"click",R(S(e[9]))),s=!0)},p(e,[t]){(!o||1&t)&&X(n,e[0]),e[2]?c?(c.p(e,t),4&t&&pe(c,1)):(c=Wt(e),c.c(),pe(c,1),c.m(r.parentNode,r)):c&&(me(),ge(c,1,1,(()=>{c=null})),he())},i(e){o||(pe(c),o=!0)},o(e){ge(c),o=!1},d(n){n&&I(t),e[8](null),n&&I(i),c&&c.d(n),n&&I(r),s=!1,a()}}}function Xt(e,n,i){let{$$slots:r={},$$scope:o}=n,s=!1,{buttonText:a}=n,c=null,l=null,u=0;const f=()=>{i(5,u=l?l.getBoundingClientRect().left:0)};function d(e){c&&e.target!==c&&i(2,s=!1)}G((()=>{f(),window.addEventListener("resize",f),document.addEventListener("click",d)})),z((()=>{window.removeEventListener("resize",f),document.removeEventListener("click",d)}));return e.$$set=e=>{"buttonText"in e&&i(0,a=e.buttonText),"$$scope"in e&&i(6,o=e.$$scope)},e.$$.update=()=>{34&e.$$.dirty&&c&&i(1,c.style.transform=`translateX(${u-15}px)`,c)},[a,c,s,l,function(e,n){const i=function(e,{delay:n=0,duration:i=400,easing:r=t}={}){const o=+getComputedStyle(e).opacity;return{delay:n,duration:i,easing:r,css:e=>"opacity: "+e*o}}(e,n);return{duration:n.duration,css:i.css}},u,o,r,function(e){J[e?"unshift":"push"]((()=>{l=e,i(3,l)}))},()=>{i(2,s=!s)},function(e){J[e?"unshift":"push"]((()=>{c=e,i(1,c),i(5,u)}))}]}class Ht extends Ae{constructor(e){super(),Me(this,e,Xt,Et,s,{buttonText:0})}}function Tt(e){let t,n,i,o,s,a,c,l,u,f,d,m,h,p=(null!==e[7]?e[7].name:"")+"",g=(null!==e[8]?e[8].name:"")+"";return{c(){t=C("button"),t.textContent="Spritesheet (.png)",n=A(),i=C("button"),i.textContent="XML File (.xml)",o=A(),s=C("p"),a=M("Spritesheet selected: "),c=M(p),l=A(),u=C("p"),f=M("XML selected: "),d=M(g)},m(r,p){k(r,t,p),k(r,n,p),k(r,i,p),k(r,o,p),k(r,s,p),b(s,a),b(s,c),k(r,l,p),k(r,u,p),b(u,f),b(u,d),m||(h=[P(t,"click",e[31]),P(i,"click",e[32])],m=!0)},p(e,t){128&t[0]&&p!==(p=(null!==e[7]?e[7].name:"")+"")&&X(c,p),256&t[0]&&g!==(g=(null!==e[8]?e[8].name:"")+"")&&X(d,g)},d(e){e&&I(t),e&&I(n),e&&I(i),e&&I(o),e&&I(s),e&&I(l),e&&I(u),m=!1,r(h)}}}function Lt(t){let n;return{c(){n=C("p"),n.textContent="Select Spritesheet or XML file",F(n,"slot","header")},m(e,t){k(e,n,t)},p:e,d(e){e&&I(n)}}}function Ot(t){let n,i,r;return{c(){n=C("button"),n.textContent="Add Spritesheet and XML",F(n,"slot","accept-btn")},m(e,o){k(e,n,o),i||(r=P(n,"click",t[30]),i=!0)},p:e,d(e){e&&I(n),i=!1,r()}}}function Bt(t){let n;return{c(){n=C("input"),F(n,"type","text"),F(n,"name","anim-prefix"),F(n,"id","anim-prefix"),n.value="name"},m(e,i){k(e,n,i),t[35](n)},p:e,d(e){e&&I(n),t[35](null)}}}function Vt(t){let n;return{c(){n=C("p"),n.textContent="Enter animation prefix",F(n,"slot","header")},m(e,t){k(e,n,t)},p:e,d(e){e&&I(n)}}}function Nt(t){let n,i,r;return{c(){n=C("button"),n.textContent="Set animation prefix",F(n,"slot","accept-btn")},m(e,o){k(e,n,o),i||(r=P(n,"click",t[34]),i=!0)},p:e,d(e){e&&I(n),i=!1,r()}}}function Yt(t){let n,i,o,s,a;return{c(){n=C("button"),n.textContent="View XML structure",i=A(),o=C("button"),o.textContent="View Animation"},m(e,r){k(e,n,r),k(e,i,r),k(e,o,r),s||(a=[P(n,"click",S(t[42])),P(o,"click",S(t[43]))],s=!0)},p:e,d(e){e&&I(n),e&&I(i),e&&I(o),s=!1,r(a)}}}function jt(t){let n,i,o,s,a,c,l,u,f;return{c(){n=C("button"),n.textContent="Set animation prefix",i=A(),o=C("button"),o.textContent="Delete Selection",s=A(),a=C("button"),a.textContent="Clone Selection",c=A(),l=C("button"),l.textContent="Toggle Select on Range"},m(e,r){k(e,n,r),k(e,i,r),k(e,o,r),k(e,s,r),k(e,a,r),k(e,c,r),k(e,l,r),u||(f=[P(n,"click",S(t[46])),P(o,"click",S(t[19])),P(a,"click",S(t[20])),P(l,"click",S(t[24]))],u=!0)},p:e,d(e){e&&I(n),e&&I(i),e&&I(o),e&&I(s),e&&I(a),e&&I(c),e&&I(l),u=!1,r(f)}}}function Ut(t){let n,i,o,s,a;return{c(){n=C("button"),n.textContent="Generate XML",i=A(),o=C("button"),o.textContent="Generate PNG sequence"},m(e,r){k(e,n,r),k(e,i,r),k(e,o,r),s||(a=[P(n,"click",t[49]),P(o,"click",t[50])],s=!0)},p:e,d(e){e&&I(n),e&&I(i),e&&I(o),s=!1,r(a)}}}function Gt(e){let t,n,i,o,s,a,c,l,u,f,d,m,h,p,g,w,_,x,v,$,y,q,S,R,W,E,H,T,L,O,B,V,N,Y,j,U,G,z,D,Z,K,Q,ee;function te(t){e[33](t)}let ne={$$slots:{"accept-btn":[Ot],header:[Lt],default:[Tt]},$$scope:{ctx:e}};function re(t){e[36](t)}void 0!==e[2]&&(ne.showModal=e[2]),u=new ut({props:ne}),J.push((()=>$e(u,"showModal",te)));let oe={$$slots:{"accept-btn":[Nt],header:[Vt],default:[Bt]},$$scope:{ctx:e}};function se(t){e[37](t)}function ae(t){e[38](t)}void 0!==e[3]&&(oe.showModal=e[3]),m=new ut({props:oe}),J.push((()=>$e(m,"showModal",re)));let ce={};function le(t){e[39](t)}void 0!==e[4]&&(ce.showView=e[4]),void 0!==e[1]&&(ce.settings=e[1]),g=new Rt({props:ce}),J.push((()=>$e(g,"showView",se))),J.push((()=>$e(g,"settings",ae)));let ue={};function fe(t){e[40](t)}void 0!==e[5]&&(ue.showView=e[5]),v=new xt({props:ue}),J.push((()=>$e(v,"showView",le)));let de={};return void 0!==e[6]&&(de.showView=e[6]),q=new Ct({props:de}),J.push((()=>$e(q,"showView",fe))),T=new Ht({props:{buttonText:"View",$$slots:{default:[Yt]},$$scope:{ctx:e}}}),Y=new Ht({props:{buttonText:"Selection",$$slots:{default:[jt]},$$scope:{ctx:e}}}),Z=new Ht({props:{buttonText:"Generate",$$slots:{default:[Ut]},$$scope:{ctx:e}}}),{c(){t=C("dialog"),n=C("div"),i=C("label"),o=M(e[11]),s=A(),a=C("progress"),l=A(),ye(u.$$.fragment),d=A(),ye(m.$$.fragment),p=A(),ye(g.$$.fragment),x=A(),ye(v.$$.fragment),y=A(),ye(q.$$.fragment),R=A(),W=C("div"),E=C("button"),E.textContent="Settings",H=A(),ye(T.$$.fragment),L=A(),O=C("label"),B=C("input"),V=M("\r\n        Select all"),N=A(),ye(Y.$$.fragment),j=A(),U=C("button"),U.textContent="Add PNGs",G=A(),z=C("button"),z.textContent="Add Spritesheet",D=A(),ye(Z.$$.fragment),F(i,"for","gen-progress"),F(a,"id","gen-progress"),a.value=c=Math.round(100*e[10]),F(a,"max","100"),F(B,"type","checkbox"),F(B,"name","select-all"),F(B,"id","select-all"),F(O,"for","select-all"),F(W,"id","controls"),F(W,"class","svelte-1xe4acl")},m(r,c){k(r,t,c),b(t,n),b(n,i),b(i,o),b(n,s),b(n,a),e[29](t),k(r,l,c),ke(u,r,c),k(r,d,c),ke(m,r,c),k(r,p,c),ke(g,r,c),k(r,x,c),ke(v,r,c),k(r,y,c),ke(q,r,c),k(r,R,c),k(r,W,c),b(W,E),b(W,H),ke(T,W,null),b(W,L),b(W,O),b(O,B),e[44](B),b(O,V),b(W,N),ke(Y,W,null),b(W,j),b(W,U),b(W,G),b(W,z),b(W,D),ke(Z,W,null),K=!0,Q||(ee=[P(E,"click",e[41]),P(B,"change",e[45]),P(U,"click",e[47]),P(z,"click",e[48])],Q=!0)},p(e,t){(!K||2048&t[0])&&X(o,e[11]),(!K||1024&t[0]&&c!==(c=Math.round(100*e[10])))&&(a.value=c);const n={};388&t[0]|2097152&t[1]&&(n.$$scope={dirty:t,ctx:e}),!f&&4&t[0]&&(f=!0,n.showModal=e[2],ie((()=>f=!1))),u.$set(n);const i={};520&t[0]|2097152&t[1]&&(i.$$scope={dirty:t,ctx:e}),!h&&8&t[0]&&(h=!0,i.showModal=e[3],ie((()=>h=!1))),m.$set(i);const r={};!w&&16&t[0]&&(w=!0,r.showView=e[4],ie((()=>w=!1))),!_&&2&t[0]&&(_=!0,r.settings=e[1],ie((()=>_=!1))),g.$set(r);const s={};!$&&32&t[0]&&($=!0,s.showView=e[5],ie((()=>$=!1))),v.$set(s);const l={};!S&&64&t[0]&&(S=!0,l.showView=e[6],ie((()=>S=!1))),q.$set(l);const d={};96&t[0]|2097152&t[1]&&(d.$$scope={dirty:t,ctx:e}),T.$set(d);const p={};8&t[0]|2097152&t[1]&&(p.$$scope={dirty:t,ctx:e}),Y.$set(p);const x={};2097152&t[1]&&(x.$$scope={dirty:t,ctx:e}),Z.$set(x)},i(e){K||(pe(u.$$.fragment,e),pe(m.$$.fragment,e),pe(g.$$.fragment,e),pe(v.$$.fragment,e),pe(q.$$.fragment,e),pe(T.$$.fragment,e),pe(Y.$$.fragment,e),pe(Z.$$.fragment,e),K=!0)},o(e){ge(u.$$.fragment,e),ge(m.$$.fragment,e),ge(g.$$.fragment,e),ge(v.$$.fragment,e),ge(q.$$.fragment,e),ge(T.$$.fragment,e),ge(Y.$$.fragment,e),ge(Z.$$.fragment,e),K=!1},d(n){n&&I(t),e[29](null),n&&I(l),Ie(u,n),n&&I(d),Ie(m,n),n&&I(p),Ie(g,n),n&&I(x),Ie(v,n),n&&I(y),Ie(q,n),n&&I(R),n&&I(W),Ie(T),e[44](null),Ie(Y),Ie(Z),Q=!1,r(ee)}}}function zt(e,t,n){let i,r;l(e,Te,(e=>n(28,i=e))),l(e,Le,(e=>n(51,r=e)));let{wasm:o}=t,{charname:s}=t,{rangeSelectionMode:a=!1}=t,c={padding:2,prefixType:"no-prefix",usePrefixOnXMLFrames:!1,customPrefix:"",uniqueFramesOnly:!1};async function u(e){const t=e.target;let n=[];for(let e of t.files){const[t,i]=await Ye(e),r=new Mt(e.name+"::"+Ge.getNewId(),"single_frame",e,null,null);r.rect.width=t,r.rect.height=i,r.transform.newWidth=t,r.transform.newHeight=i,r.frameRect.frameWidth=t,r.frameRect.frameHeight=i,r.animationPrefix=e.name.substring(0,e.name.indexOf(".png")),n.push(r)}Te.update((e=>[...e,...n]))}async function f(e,t,n){if(null==t)return alert("Please select a spritesheet"),!0;if(null==n)return alert("Please select an XML"),!0;let i=await t.arrayBuffer();const r=await async function(e){const t=await crypto.subtle.digest("SHA-1",e);return We(new Uint8Array(t))}(new Uint8Array(i)),o=Ee(i);Le.update((e=>(e.has(r)||e.set(r,[o,0]),e)));const s=await n.text(),a=(new DOMParser).parseFromString(s,"text/xml").getElementsByTagName("SubTexture"),c=[];for(let e of a){const i=e.getAttribute("name"),o=Ve(i,(e=>!(e>="0"&&e<="9")),!0),s=new Mt(t.name+"::"+Ge.getNewId(),"spritesheet_frame",t,n,r);s.animationPrefix=i.substring(0,o+1),s.rect={x:parseInt(e.getAttribute("x")),y:parseInt(e.getAttribute("y")),width:parseInt(e.getAttribute("width")),height:parseInt(e.getAttribute("height"))},s.frameRect={frameX:parseInt(e.getAttribute("frameX"))||0,frameY:parseInt(e.getAttribute("frameY"))||0,frameWidth:parseInt(e.getAttribute("frameWidth"))||s.rect.width,frameHeight:parseInt(e.getAttribute("frameHeight"))||s.rect.height},s.transform.newWidth=s.rect.width,s.transform.newHeight=s.rect.height,c.push(s)}return Te.update((e=>[...e,...c])),Le.update((e=>{const[t,n]=e.get(r);return e.set(r,[t,n+a.length]),e})),t=null,n=null,!1}function d(e){for(let t=0;t<i.length;t++){let n=i[t];n.selected&&(n.animationPrefix=e,n.selected=!1)}Te.set(i)}let m=!1,h=!1,p=!1,g=!1,w=!1,_=null,x=null,v=null,b=null;function $(e){n(7,_=e.target.files[0])}function y(e){n(8,x=e.target.files[0])}function k(e){Te.update((t=>t.map((t=>(t.selected=e,t)))))}let I=0,C="Adding images: 0%",M=null;async function A(e){if(console.log(c),!je(s)||!je(s+".zip"))return void alert("Please enter a valid filename as the name of your character!");if(i.length<=0)return void alert("Please add some images/spritesheets!");n(11,C="Adding images: 0%"),n(10,I=0),M.showModal();const{GrowingPacker:t}=o,a=t.new(s,c.padding),l=Array.from(r.entries()).length+i.length;let u=0;Ue((()=>{for(const e of r){const t=e[0],i=e[1][0];console.log("adding "+t+" to store!"),a.add_image_to_store(t,Re(i,null)),u++,n(10,I=u/l),n(11,C=`Adding images: ${Math.round(100*I)}%`)}})),Ue((async()=>{let t="";switch(c.prefixType){case"character-name":t=s+" ";break;case"custom-prefix":t=c.customPrefix+" "}for(const e of i){switch(e.type){case"single_frame":console.log("Reading single frame"+e.sprId);const n=await e.imgfileref.arrayBuffer();a.add_single_frame(new Uint8Array(n),t+e.animationPrefix,e.transform.newWidth,e.transform.newHeight,e.transform.flipX,e.transform.flipY,BigInt(e.frameRect.frameX),BigInt(e.frameRect.frameY),BigInt(e.frameRect.frameWidth),BigInt(e.frameRect.frameHeight));break;case"spritesheet_frame":console.log("Putting spritesheet frame"+e.sprId),Ue((()=>{a.add_spritesheet_frame(e.spritesheetId,(c.usePrefixOnXMLFrames?t:"")+e.animationPrefix,e.rect.x,e.rect.y,e.rect.width,e.rect.height,e.transform.newWidth,e.transform.newHeight,e.transform.flipX,e.transform.flipY,BigInt(e.frameRect.frameX),BigInt(e.frameRect.frameY),BigInt(e.frameRect.frameWidth),BigInt(e.frameRect.frameHeight))}))}u++,n(10,I=u/l),n(11,C=`Adding images: ${Math.round(100*I)}%`)}e(a)}))}async function q(e){Ue((()=>{n(11,C="Generating spritesheet and XML...."),Ue((()=>{Be(e.make_packed_image(),s+".zip"),M.close()}))}))}async function P(e){Ue((()=>{n(11,C="Zipping individual frames...."),Ue((()=>{Be(e.make_img_sequence(c.uniqueFramesOnly),s+".zip"),M.close()}))}))}return e.$$set=e=>{"wasm"in e&&n(26,o=e.wasm),"charname"in e&&n(27,s=e.charname),"rangeSelectionMode"in e&&n(25,a=e.rangeSelectionMode)},e.$$.update=()=>{268435457&e.$$.dirty[0]&&null!=b&&n(0,b.checked=i.length>0&&i.every((e=>e.selected))||!1,b)},[b,c,m,h,p,g,w,_,x,v,I,C,M,u,f,d,$,y,k,function(){for(let e=i.length-1;e>=0;e--){const t=i[e];if(t.selected&&(i.splice(e,1),"spritesheet_frame"===t.type)){const e=t.spritesheetId,[n,i]=r.get(e),o=i-1;o>0?Le.update((t=>(t.set(e,[n,o]),t))):Le.update((t=>(t.delete(e),t)))}}Te.set(i)},function(){for(let e=0;e<i.length;e++){const t=i[e];if(t.selected){const e=t.clone();e.selected=!1,e.sprId+="-copy"+Ge.getNewId(),Te.update((t=>[...t,e])),t.selected=!1}}},A,q,P,function(){n(25,a=!0),document.getElementById("sprite-frames").style.backgroundColor="#33333333"},a,o,s,i,function(e){J[e?"unshift":"push"]((()=>{M=e,n(12,M)}))},async e=>{await f(0,_,x)||n(2,m=!1)},()=>{Oe($,"image/png",!1)},()=>{Oe(y,"text/xml",!1)},function(e){m=e,n(2,m)},()=>{d(v.value),n(3,h=!1)},function(e){J[e?"unshift":"push"]((()=>{v=e,n(9,v)}))},function(e){h=e,n(3,h)},function(e){p=e,n(4,p)},function(e){c=e,n(1,c)},function(e){g=e,n(5,g)},function(e){w=e,n(6,w)},()=>{n(4,p=!0)},()=>{n(6,w=!0)},()=>{n(5,g=!0)},function(e){J[e?"unshift":"push"]((()=>{b=e,n(0,b),n(28,i)}))},()=>{k(b.checked)},()=>{n(3,h=!0)},()=>{Oe(u,"image/png",!0)},()=>{n(2,m=!0)},()=>{A(q).then((()=>{}))},()=>{A(P).then((()=>{}))}]}class Dt extends Ae{constructor(e){super(),Me(this,e,zt,Gt,s,{wasm:26,charname:27,rangeSelectionMode:25},null,[-1,-1])}}function Zt(e,t,n){const i=e.slice();return i[10]=t[n],i[11]=t,i[12]=n,i}function Jt(e,t){let n,i,r,o;function s(){return t[5](t[12])}function a(e){t[6](e,t[10],t[11],t[12])}let c={rangeSelectionMode:t[2],onRangeClick:s};return void 0!==t[10]&&(c.frameInfo=t[10]),i=new it({props:c}),J.push((()=>$e(i,"frameInfo",a))),{key:e,first:null,c(){n=q(),ye(i.$$.fragment),this.first=n},m(e,t){k(e,n,t),ke(i,e,t),o=!0},p(e,n){t=e;const o={};4&n&&(o.rangeSelectionMode=t[2]),8&n&&(o.onRangeClick=s),!r&&8&n&&(r=!0,o.frameInfo=t[10],ie((()=>r=!1))),i.$set(o)},i(e){o||(pe(i.$$.fragment,e),o=!0)},o(e){ge(i.$$.fragment,e),o=!1},d(e){e&&I(n),Ie(i,e)}}}function Kt(e){let t,n,i,r,o,s=[],a=new Map,c=e[3];const l=e=>e[10].sprId;for(let t=0;t<c.length;t+=1){let n=Zt(e,c,t),i=l(n);a.set(i,s[t]=Jt(i,n))}function u(t){e[7](t)}let f={charname:e[1],wasm:e[0]};return void 0!==e[2]&&(f.rangeSelectionMode=e[2]),i=new Dt({props:f}),J.push((()=>$e(i,"rangeSelectionMode",u))),{c(){t=C("div");for(let e=0;e<s.length;e+=1)s[e].c();n=A(),ye(i.$$.fragment),F(t,"id","sprite-frames"),F(t,"class","svelte-8tybqo")},m(e,r){k(e,t,r);for(let e=0;e<s.length;e+=1)s[e]&&s[e].m(t,null);k(e,n,r),ke(i,e,r),o=!0},p(e,[n]){28&n&&(c=e[3],me(),s=be(s,n,l,1,e,c,a,t,ve,Jt,null,Zt),he());const o={};2&n&&(o.charname=e[1]),1&n&&(o.wasm=e[0]),!r&&4&n&&(r=!0,o.rangeSelectionMode=e[2],ie((()=>r=!1))),i.$set(o)},i(e){if(!o){for(let e=0;e<c.length;e+=1)pe(s[e]);pe(i.$$.fragment,e),o=!0}},o(e){for(let e=0;e<s.length;e+=1)ge(s[e]);ge(i.$$.fragment,e),o=!1},d(e){e&&I(t);for(let e=0;e<s.length;e+=1)s[e].d();e&&I(n),Ie(i,e)}}}function Qt(e,t,n){let i;l(e,Te,(e=>n(3,i=e)));let{wasm:r}=t,{charname:o}=t,s=!1,a=null,c=null;function u(e){if(s){if(null===a)return void(a=e);if(null===c)return c=e,n(2,s=!1),document.getElementById("sprite-frames").style.backgroundColor=null,Te.update((e=>{let t,n;a<=c?(t=a,n=c):(t=c,n=a);for(let i=t;i<=n;i++)e[i].selected=!e[i].selected;return e})),a=null,void(c=null)}}return e.$$set=e=>{"wasm"in e&&n(0,r=e.wasm),"charname"in e&&n(1,o=e.charname)},[r,o,s,i,u,e=>{u(e)},function(e,t,n,r){n[r]=e,Te.set(i)},function(e){s=e,n(2,s)}]}class en extends Ae{constructor(e){super(),Me(this,e,Qt,Kt,s,{wasm:0,charname:1})}}function tn(e){let t,n,i;function r(t){e[6](t)}let o={wasm:e[0]};return void 0!==e[1]&&(o.charname=e[1]),t=new Je({props:o}),J.push((()=>$e(t,"charname",r))),{c(){ye(t.$$.fragment)},m(e,n){ke(t,e,n),i=!0},p(e,i){const r={};1&i&&(r.wasm=e[0]),!n&&2&i&&(n=!0,r.charname=e[1],ie((()=>n=!1))),t.$set(r)},i(e){i||(pe(t.$$.fragment,e),i=!0)},o(e){ge(t.$$.fragment,e),i=!1},d(e){Ie(t,e)}}}function nn(e){let t,n;return t=new en({props:{charname:e[1],wasm:e[0]}}),{c(){ye(t.$$.fragment)},m(e,i){ke(t,e,i),n=!0},p(e,n){const i={};2&n&&(i.charname=e[1]),1&n&&(i.wasm=e[0]),t.$set(i)},i(e){n||(pe(t.$$.fragment,e),n=!0)},o(e){ge(t.$$.fragment,e),n=!1},d(e){Ie(t,e)}}}function rn(e){let t,n,i,r,o,s,a,c,l,u,f,d,m,h,p,g,w,_,x,v,$;function y(t){e[4](t)}let M={id:"spsh",text:"Spritesheet Generation"};function q(t){e[5](t)}void 0!==e[2]&&(M.curChoice=e[2]),u=new Se({props:M}),J.push((()=>$e(u,"curChoice",y)));let S={id:"icongrid",text:"Icongrid Generation"};void 0!==e[2]&&(S.curChoice=e[2]),m=new Se({props:S}),J.push((()=>$e(m,"curChoice",q)));const R=[nn,tn],W=[];function E(e,t){return"spsh"==e[2]?0:"icongrid"==e[2]?1:-1}return~(w=E(e))&&(_=W[w]=R[w](e)),{c(){t=C("main"),n=C("h1"),n.textContent="FNF Spritesheet and XML Generator Web (experimental version)",i=A(),r=C("div"),o=C("label"),o.textContent="Character Name:",s=A(),a=C("input"),c=A(),l=C("div"),ye(u.$$.fragment),d=A(),ye(m.$$.fragment),p=A(),g=C("div"),_&&_.c(),F(n,"id","title"),F(n,"class","svelte-1p0njb9"),F(o,"for","char-name"),F(o,"class","svelte-1p0njb9"),F(a,"type","text"),F(a,"name","char-name"),F(a,"id","char-name"),F(r,"id","character-name-control"),F(r,"class","svelte-1p0njb9"),F(l,"id","app-tabs"),F(l,"class","svelte-1p0njb9"),F(g,"id","tab-container"),F(g,"class","svelte-1p0njb9")},m(f,h){k(f,t,h),b(t,n),b(t,i),b(t,r),b(r,o),b(r,s),b(r,a),H(a,e[1]),b(t,c),b(t,l),ke(u,l,null),b(l,d),ke(m,l,null),b(t,p),b(t,g),~w&&W[w].m(g,null),x=!0,v||($=P(a,"input",e[3]),v=!0)},p(e,[t]){2&t&&a.value!==e[1]&&H(a,e[1]);const n={};!f&&4&t&&(f=!0,n.curChoice=e[2],ie((()=>f=!1))),u.$set(n);const i={};!h&&4&t&&(h=!0,i.curChoice=e[2],ie((()=>h=!1))),m.$set(i);let r=w;w=E(e),w===r?~w&&W[w].p(e,t):(_&&(me(),ge(W[r],1,1,(()=>{W[r]=null})),he()),~w?(_=W[w],_?_.p(e,t):(_=W[w]=R[w](e),_.c()),pe(_,1),_.m(g,null)):_=null)},i(e){x||(pe(u.$$.fragment,e),pe(m.$$.fragment,e),pe(_),x=!0)},o(e){ge(u.$$.fragment,e),ge(m.$$.fragment,e),ge(_),x=!1},d(e){e&&I(t),Ie(u),Ie(m),~w&&W[w].d(),v=!1,$()}}}function on(e,t,n){let i,{wasm:r}=t,o="spsh";return e.$$set=e=>{"wasm"in e&&n(0,r=e.wasm)},[r,i,o,function(){i=this.value,n(1,i)},function(e){o=e,n(2,o)},function(e){o=e,n(2,o)},function(e){i=e,n(1,i)}]}class sn extends Ae{constructor(e){super(),Me(this,e,on,rn,s,{wasm:0})}}let an;const cn=new Array(128).fill(void 0);function ln(e){return cn[e]}cn.push(void 0,null,!0,!1);let un=0,fn=null;function dn(){return null!==fn&&0!==fn.byteLength||(fn=new Uint8Array(an.memory.buffer)),fn}const mn=new TextEncoder("utf-8"),hn="function"==typeof mn.encodeInto?function(e,t){return mn.encodeInto(e,t)}:function(e,t){const n=mn.encode(e);return t.set(n),{read:e.length,written:n.length}};function pn(e,t,n){if(void 0===n){const n=mn.encode(e),i=t(n.length);return dn().subarray(i,i+n.length).set(n),un=n.length,i}let i=e.length,r=t(i);const o=dn();let s=0;for(;s<i;s++){const t=e.charCodeAt(s);if(t>127)break;o[r+s]=t}if(s!==i){0!==s&&(e=e.slice(s)),r=n(r,i,i=s+3*e.length);const t=dn().subarray(r+s,r+i);s+=hn(e,t).written}return un=s,r}let gn=null;function wn(){return null!==gn&&0!==gn.byteLength||(gn=new Int32Array(an.memory.buffer)),gn}let _n=cn.length;function xn(e){const t=ln(e);return function(e){e<132||(cn[e]=_n,_n=e)}(e),t}const vn=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});function bn(e,t){return vn.decode(dn().subarray(e,e+t))}function $n(e){_n===cn.length&&cn.push(cn.length+1);const t=_n;return _n=cn[t],cn[t]=e,t}function yn(e,t){const n=t(1*e.length);return dn().set(e,n/1),un=e.length,n}function kn(e,t){return dn().subarray(e/1,e/1+t)}vn.decode();class In{static __wrap(e){const t=Object.create(In.prototype);return t.ptr=e,t}__destroy_into_raw(){const e=this.ptr;return this.ptr=0,e}free(){const e=this.__destroy_into_raw();an.__wbg_growingpacker_free(e)}static new(e,t){const n=pn(e,an.__wbindgen_malloc,an.__wbindgen_realloc),i=un,r=an.growingpacker_new(n,i,t);return In.__wrap(r)}add_image_to_store(e,t){const n=pn(e,an.__wbindgen_malloc,an.__wbindgen_realloc),i=un,r=yn(t,an.__wbindgen_malloc),o=un;an.growingpacker_add_image_to_store(this.ptr,n,i,r,o)}add_single_frame(e,t,n,i,r,o,s,a,c,l){const u=yn(e,an.__wbindgen_malloc),f=un,d=pn(t,an.__wbindgen_malloc,an.__wbindgen_realloc),m=un;an.growingpacker_add_single_frame(this.ptr,u,f,d,m,n,i,r,o,s,a,c,l)}add_spritesheet_frame(e,t,n,i,r,o,s,a,c,l,u,f,d,m){const h=pn(e,an.__wbindgen_malloc,an.__wbindgen_realloc),p=un,g=pn(t,an.__wbindgen_malloc,an.__wbindgen_realloc),w=un;an.growingpacker_add_spritesheet_frame(this.ptr,h,p,g,w,n,i,r,o,s,a,c,l,u,f,d,m)}make_packed_image(){try{const i=an.__wbindgen_add_to_stack_pointer(-16);an.growingpacker_make_packed_image(i,this.ptr);var e=wn()[i/4+0],t=wn()[i/4+1],n=kn(e,t).slice();return an.__wbindgen_free(e,1*t),n}finally{an.__wbindgen_add_to_stack_pointer(16)}}make_img_sequence(e){try{const r=an.__wbindgen_add_to_stack_pointer(-16);an.growingpacker_make_img_sequence(r,this.ptr,e);var t=wn()[r/4+0],n=wn()[r/4+1],i=kn(t,n).slice();return an.__wbindgen_free(t,1*n),i}finally{an.__wbindgen_add_to_stack_pointer(16)}}}class Cn{static __wrap(e){const t=Object.create(Cn.prototype);return t.ptr=e,t}__destroy_into_raw(){const e=this.ptr;return this.ptr=0,e}free(){const e=this.__destroy_into_raw();an.__wbg_iconpacker_free(e)}static new(){const e=an.iconpacker_new();return Cn.__wrap(e)}add_image(e){an.iconpacker_add_image(this.ptr,$n(e))}make_packed_image(){try{const i=an.__wbindgen_add_to_stack_pointer(-16);an.iconpacker_make_packed_image(i,this.ptr);var e=wn()[i/4+0],t=wn()[i/4+1],n=kn(e,t).slice();return an.__wbindgen_free(e,1*t),n}finally{an.__wbindgen_add_to_stack_pointer(16)}}}function Mn(){const e={wbg:{}};return e.wbg.__wbindgen_string_get=function(e,t){const n=ln(t),i="string"==typeof n?n:void 0;var r=null==i?0:pn(i,an.__wbindgen_malloc,an.__wbindgen_realloc),o=un;wn()[e/4+1]=o,wn()[e/4+0]=r},e.wbg.__wbindgen_object_drop_ref=function(e){xn(e)},e.wbg.__wbg_new_abda76e883ba8a5f=function(){return $n(new Error)},e.wbg.__wbg_stack_658279fe44541cf6=function(e,t){const n=pn(ln(t).stack,an.__wbindgen_malloc,an.__wbindgen_realloc),i=un;wn()[e/4+1]=i,wn()[e/4+0]=n},e.wbg.__wbg_error_f851667af71bcfc6=function(e,t){try{console.error(bn(e,t))}finally{an.__wbindgen_free(e,t)}},e.wbg.__wbg_get_27fe3dac1c4d0224=function(e,t){return $n(ln(e)[t>>>0])},e.wbg.__wbg_length_e498fbc24f9c1d4f=function(e){return ln(e).length},e.wbg.__wbg_buffer_cf65c07de34b9a08=function(e){return $n(ln(e).buffer)},e.wbg.__wbg_new_537b7341ce90bb31=function(e){return $n(new Uint8Array(ln(e)))},e.wbg.__wbg_set_17499e8aa4003ebd=function(e,t,n){ln(e).set(ln(t),n>>>0)},e.wbg.__wbg_length_27a2afe8ab42b09f=function(e){return ln(e).length},e.wbg.__wbindgen_throw=function(e,t){throw new Error(bn(e,t))},e.wbg.__wbindgen_memory=function(){return $n(an.memory)},e}function An(e,t){return an=e.exports,qn.__wbindgen_wasm_module=t,gn=null,fn=null,an}async function qn(e){const t=Mn();("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:i}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if("application/wasm"==e.headers.get("Content-Type"))throw t;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}(await e,t);return An(n,i)}var Pn=Object.freeze({__proto__:null,GrowingPacker:In,IconPacker:Cn,default:qn,initSync:function(e){const t=Mn();return e instanceof WebAssembly.Module||(e=new WebAssembly.Module(e)),An(new WebAssembly.Instance(e,t),e)},init_panic_hook:function(){an.init_panic_hook()},make_icongrid_legacy:function(e,t){try{const o=an.__wbindgen_add_to_stack_pointer(-16),s=yn(e,an.__wbindgen_malloc),a=un;an.make_icongrid_legacy(o,s,a,$n(t));var n=wn()[o/4+0],i=wn()[o/4+1],r=kn(n,i).slice();return an.__wbindgen_free(n,1*i),r}finally{an.__wbindgen_add_to_stack_pointer(16)}}});return(async()=>{const e=await(async(e={})=>{let{importHook:t,serverPath:n}=e,i="./build/assets/rust_img_lib-e9f6c2aa.wasm";return null!=n&&(i=n+/[^\/\\]*$/.exec(i)[0]),null!=t&&(i=t(i)),await qn(i),Pn})();e.init_panic_hook();return new sn({target:document.body,props:{wasm:e}})})()}();
//# sourceMappingURL=bundle.js.map
