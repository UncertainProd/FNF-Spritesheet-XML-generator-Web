var app=function(){"use strict";function e(){}const t=e=>e;function n(e){return e()}function i(){return Object.create(null)}function r(e){e.forEach(n)}function o(e){return"function"==typeof e}function s(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let a;function c(t,...n){if(null==t)return e;const i=t.subscribe(...n);return i.unsubscribe?()=>i.unsubscribe():i}function l(e,t,n){e.$$.on_destroy.push(c(t,n))}function u(e,t,n,i){if(e){const r=f(e,t,n,i);return e[0](r)}}function f(e,t,n,i){return e[1]&&i?function(e,t){for(const n in t)e[n]=t[n];return e}(n.ctx.slice(),e[1](i(t))):n.ctx}function d(e,t,n,i){if(e[2]&&i){const r=e[2](i(n));if(void 0===t.dirty)return r;if("object"==typeof r){const e=[],n=Math.max(t.dirty.length,r.length);for(let i=0;i<n;i+=1)e[i]=t.dirty[i]|r[i];return e}return t.dirty|r}return t.dirty}function h(e,t,n,i,r,o){if(r){const s=f(t,n,i,o);e.p(s,r)}}function m(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let e=0;e<n;e++)t[e]=-1;return t}return-1}const p="undefined"!=typeof window;let g=p?()=>window.performance.now():()=>Date.now(),w=p?e=>requestAnimationFrame(e):e;const _=new Set;function v(e){_.forEach((t=>{t.c(e)||(_.delete(t),t.f())})),0!==_.size&&w(v)}function x(e){let t;return 0===_.size&&w(v),{promise:new Promise((n=>{_.add(t={c:e,f:n})})),abort(){_.delete(t)}}}function b(e,t){e.appendChild(t)}function y(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function $(e){const t=M("style");return function(e,t){b(e.head||e,t),t.sheet}(y(e),t),t.sheet}function k(e,t,n){e.insertBefore(t,n||null)}function I(e){e.parentNode&&e.parentNode.removeChild(e)}function M(e){return document.createElement(e)}function C(e){return document.createTextNode(e)}function A(){return C(" ")}function P(e,t,n,i){return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n,i)}function S(e){return function(t){return t.stopPropagation(),e.call(this,t)}}function R(e){return function(t){t.target===this&&e.call(this,t)}}function q(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function F(e){let t;return{p(...n){t=n,t.forEach((t=>e.push(t)))},r(){t.forEach((t=>e.splice(e.indexOf(t),1)))}}}function W(e){return""===e?null:+e}function X(e,t){t=""+t,e.data!==t&&(e.data=t)}function E(e,t){e.value=null==t?"":t}function H(e,t,n,i){null===n?e.style.removeProperty(t):e.style.setProperty(t,n,i?"important":"")}function L(e,t,n){for(let n=0;n<e.options.length;n+=1){const i=e.options[n];if(i.__value===t)return void(i.selected=!0)}n&&void 0===t||(e.selectedIndex=-1)}const B=new Map;let T,O=0;function V(e,t,n,i,r,o,s,a=0){const c=16.666/i;let l="{\n";for(let e=0;e<=1;e+=c){const i=t+(n-t)*o(e);l+=100*e+`%{${s(i,1-i)}}\n`}const u=l+`100% {${s(n,1-n)}}\n}`,f=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(u)}_${a}`,d=y(e),{stylesheet:h,rules:m}=B.get(d)||function(e,t){const n={stylesheet:$(t),rules:{}};return B.set(e,n),n}(d,e);m[f]||(m[f]=!0,h.insertRule(`@keyframes ${f} ${u}`,h.cssRules.length));const p=e.style.animation||"";return e.style.animation=`${p?`${p}, `:""}${f} ${i}ms linear ${r}ms 1 both`,O+=1,f}function Y(e,t){const n=(e.style.animation||"").split(", "),i=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),r=n.length-i.length;r&&(e.style.animation=i.join(", "),O-=r,O||w((()=>{O||(B.forEach((e=>{const{ownerNode:t}=e.stylesheet;t&&I(t)})),B.clear())})))}function N(e){T=e}function j(){if(!T)throw new Error("Function called outside component initialization");return T}function U(e){j().$$.on_mount.push(e)}function z(e){j().$$.on_destroy.push(e)}function G(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e.call(this,t)))}const D=[],Z=[];let J=[];const K=[],Q=Promise.resolve();let ee=!1;function te(e){J.push(e)}function ne(e){K.push(e)}const ie=new Set;let re,oe=0;function se(){if(0!==oe)return;const e=T;do{try{for(;oe<D.length;){const e=D[oe];oe++,N(e),ae(e.$$)}}catch(e){throw D.length=0,oe=0,e}for(N(null),D.length=0,oe=0;Z.length;)Z.pop()();for(let e=0;e<J.length;e+=1){const t=J[e];ie.has(t)||(ie.add(t),t())}J.length=0}while(D.length);for(;K.length;)K.pop()();ee=!1,ie.clear(),N(e)}function ae(e){if(null!==e.fragment){e.update(),r(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(te)}}function ce(){return re||(re=Promise.resolve(),re.then((()=>{re=null}))),re}function le(e,t,n){e.dispatchEvent(function(e,t,{bubbles:n=!1,cancelable:i=!1}={}){const r=document.createEvent("CustomEvent");return r.initCustomEvent(e,n,i,t),r}(`${t?"intro":"outro"}${n}`))}const ue=new Set;let fe;function de(){fe={r:0,c:[],p:fe}}function he(){fe.r||r(fe.c),fe=fe.p}function me(e,t){e&&e.i&&(ue.delete(e),e.i(t))}function pe(e,t,n,i){if(e&&e.o){if(ue.has(e))return;ue.add(e),fe.c.push((()=>{ue.delete(e),i&&(n&&e.d(1),i())})),e.o(t)}else i&&i()}const ge={duration:0};function we(n,i,r){const s={direction:"in"};let a,c,l=i(n,r,s),u=!1,f=0;function d(){a&&Y(n,a)}function h(){const{delay:i=0,duration:r=300,easing:o=t,tick:s=e,css:h}=l||ge;h&&(a=V(n,0,1,r,i,o,h,f++)),s(0,1);const m=g()+i,p=m+r;c&&c.abort(),u=!0,te((()=>le(n,!0,"start"))),c=x((e=>{if(u){if(e>=p)return s(1,0),le(n,!0,"end"),d(),u=!1;if(e>=m){const t=o((e-m)/r);s(t,1-t)}}return u}))}let m=!1;return{start(){m||(m=!0,Y(n),o(l)?(l=l(s),ce().then(h)):h())},invalidate(){m=!1},end(){u&&(d(),u=!1)}}}function _e(n,i,s){const a={direction:"out"};let c,l=i(n,s,a),u=!0;const f=fe;function d(){const{delay:i=0,duration:o=300,easing:s=t,tick:a=e,css:d}=l||ge;d&&(c=V(n,1,0,o,i,s,d));const h=g()+i,m=h+o;te((()=>le(n,!1,"start"))),x((e=>{if(u){if(e>=m)return a(0,1),le(n,!1,"end"),--f.r||r(f.c),!1;if(e>=h){const t=s((e-h)/o);a(1-t,t)}}return u}))}return f.r+=1,o(l)?ce().then((()=>{l=l(a),d()})):d(),{end(e){e&&l.tick&&l.tick(1,0),u&&(c&&Y(n,c),u=!1)}}}const ve="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function xe(e,t){e.d(1),t.delete(e.key)}function be(e,t){pe(e,1,1,(()=>{t.delete(e.key)}))}function ye(e,t,n,i,o,s,a,c,l,u,f,d){let h=e.length,m=s.length,p=h;const g={};for(;p--;)g[e[p].key]=p;const w=[],_=new Map,v=new Map,x=[];for(p=m;p--;){const e=d(o,s,p),r=n(e);let c=a.get(r);c?i&&x.push((()=>c.p(e,t))):(c=u(r,e),c.c()),_.set(r,w[p]=c),r in g&&v.set(r,Math.abs(p-g[r]))}const b=new Set,y=new Set;function $(e){me(e,1),e.m(c,f),a.set(e.key,e),f=e.first,m--}for(;h&&m;){const t=w[m-1],n=e[h-1],i=t.key,r=n.key;t===n?(f=t.first,h--,m--):_.has(r)?!a.has(i)||b.has(i)?$(t):y.has(r)?h--:v.get(i)>v.get(r)?(y.add(i),$(t)):(b.add(r),h--):(l(n,a),h--)}for(;h--;){const t=e[h];_.has(t.key)||l(t,a)}for(;m;)$(w[m-1]);return r(x),w}function $e(e,t,n){const i=e.$$.props[t];void 0!==i&&(e.$$.bound[i]=n,n(e.$$.ctx[i]))}function ke(e){e&&e.c()}function Ie(e,t,i,s){const{fragment:a,after_update:c}=e.$$;a&&a.m(t,i),s||te((()=>{const t=e.$$.on_mount.map(n).filter(o);e.$$.on_destroy?e.$$.on_destroy.push(...t):r(t),e.$$.on_mount=[]})),c.forEach(te)}function Me(e,t){const n=e.$$;null!==n.fragment&&(!function(e){const t=[],n=[];J.forEach((i=>-1===e.indexOf(i)?t.push(i):n.push(i))),n.forEach((e=>e())),J=t}(n.after_update),r(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Ce(e,t){-1===e.$$.dirty[0]&&(D.push(e),ee||(ee=!0,Q.then(se)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Ae(t,n,o,s,a,c,l,u=[-1]){const f=T;N(t);const d=t.$$={fragment:null,ctx:[],props:c,update:e,not_equal:a,bound:i(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(f?f.$$.context:[])),callbacks:i(),dirty:u,skip_bound:!1,root:n.target||f.$$.root};l&&l(d.root);let h=!1;if(d.ctx=o?o(t,n.props||{},((e,n,...i)=>{const r=i.length?i[0]:n;return d.ctx&&a(d.ctx[e],d.ctx[e]=r)&&(!d.skip_bound&&d.bound[e]&&d.bound[e](r),h&&Ce(t,e)),n})):[],d.update(),h=!0,r(d.before_update),d.fragment=!!s&&s(d.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);d.fragment&&d.fragment.l(e),e.forEach(I)}else d.fragment&&d.fragment.c();n.intro&&me(t.$$.fragment),Ie(t,n.target,n.anchor,n.customElement),se()}N(f)}class Pe{$destroy(){Me(this,1),this.$destroy=e}$on(t,n){if(!o(n))return e;const i=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return i.push(n),()=>{const e=i.indexOf(n);-1!==e&&i.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function Se(t){let n,i,r,o,s,a,c,l,u,f=!1;return c=F(t[4][0]),{c(){n=M("label"),i=M("input"),o=A(),s=C(t[2]),q(i,"type","radio"),q(i,"name","app-choice"),q(i,"id",r="tab-"+t[1]),i.__value=t[1],i.value=i.__value,H(i,"display","none"),q(i,"class","svelte-1f39crp"),q(n,"for",a="tab-"+t[1]),q(n,"class","tabs svelte-1f39crp"),H(n,"background-color",t[0]==t[1]?"blue":"white"),c.p(i)},m(e,r){k(e,n,r),b(n,i),i.checked=i.__value===t[0],b(n,o),b(n,s),l||(u=P(i,"change",t[3]),l=!0)},p(e,[t]){2&t&&r!==(r="tab-"+e[1])&&q(i,"id",r),2&t&&(i.__value=e[1],i.value=i.__value,f=!0),(f||1&t)&&(i.checked=i.__value===e[0]),4&t&&X(s,e[2]),2&t&&a!==(a="tab-"+e[1])&&q(n,"for",a),3&t&&H(n,"background-color",e[0]==e[1]?"blue":"white")},i:e,o:e,d(e){e&&I(n),c.r(),l=!1,u()}}}function Re(e,t,n){let{id:i}=t,{curChoice:r}=t,{text:o}=t;return e.$$set=e=>{"id"in e&&n(1,i=e.id),"curChoice"in e&&n(0,r=e.curChoice),"text"in e&&n(2,o=e.text)},[r,i,o,function(){r=this.__value,n(0,r)},[[]]]}class qe extends Pe{constructor(e){super(),Ae(this,e,Re,Se,s,{id:1,curChoice:0,text:2})}}function Fe(e,t){const n=e.replace(/[^A-Za-z0-9+/]/g,""),i=n.length,r=t?Math.ceil((3*i+1>>2)/t)*t:3*i+1>>2,o=new Uint8Array(r);let s,a,c=0,l=0;for(let e=0;e<i;e++)if(a=3&e,c|=((u=n.charCodeAt(e))>64&&u<91?u-65:u>96&&u<123?u-71:u>47&&u<58?u+4:43===u?62:47===u?63:0)<<6*(3-a),3===a||i-e==1){for(s=0;s<3&&l<r;)o[l]=c>>>(16>>>s&24)&255,s++,l++;c=0}var u;return o}function We(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65}function Xe(e){let t=2,n="";const i=e.length;let r=0;for(let o=0;o<i;o++)t=o%3,r|=e[o]<<(16>>>t&24),2!==t&&e.length-o!=1||(n+=String.fromCodePoint(We(r>>>18&63),We(r>>>12&63),We(r>>>6&63),We(63&r)),r=0);return n.substring(0,n.length-2+t)+(2===t?"":1===t?"=":"==")}function Ee(e){return Xe(new Uint8Array(e))}const He=[];function Le(t,n=e){let i;const r=new Set;function o(e){if(s(t,e)&&(t=e,i)){const e=!He.length;for(const e of r)e[1](),He.push(e,t);if(e){for(let e=0;e<He.length;e+=2)He[e][0](He[e+1]);He.length=0}}}return{set:o,update:function(e){o(e(t))},subscribe:function(s,a=e){const c=[s,a];return r.add(c),1===r.size&&(i=n(o)||e),s(t),()=>{r.delete(c),0===r.size&&i&&(i(),i=null)}}}}const Be=Le([]),Te=Le(new Map);function Oe(e,t,n=!0){let i=document.createElement("input");i.setAttribute("type","file"),n&&i.setAttribute("multiple","true"),i.setAttribute("style","display: none"),i.setAttribute("accept",t),document.body.append(i),i.onchange=t=>{e(t),document.body.removeChild(i)},i.click()}function Ve(e,t){let n=new Blob([e]),i=URL.createObjectURL(n),r=document.createElement("a");r.setAttribute("href",i),r.setAttribute("download",t),r.click()}function Ye(e,t,n=!1){if(n){for(let n=e.length-1;n>=0;n--)if(t(e[n]))return n}else for(let n=0;n<e.length;n++)if(t(e[n]))return n;return null}async function Ne(e){let t;if("single_frame"==e.type){let n=e.imgfileref;t="data:image/png;base64,"+Xe(new Uint8Array(await n.arrayBuffer()))}else{const n=function(e){let t;return c(e,(e=>t=e))(),t}(Te).get(e.spritesheetId);t=void 0!==n?"data:image/png;base64,"+n[0]:"data:image/png;base64,"}const n=new Image;return n.src=t,await n.decode(),n}async function je(e){const t="data:image/png;base64,"+Ee(await e.arrayBuffer()),n=new Image;return n.src=t,await n.decode(),[n.naturalWidth,n.naturalHeight]}function Ue(e){return!(!e||e.length>255)&&(!/[<>:"/\\|?*\u0000-\u001F]/g.test(e)&&!/^(con|prn|aux|nul|com\d|lpt\d)$/i.test(e)&&("."!==e&&".."!==e))}function ze(e,t=0){setTimeout(e,t)}const Ge=new class{constructor(){this._val=-1}getNewId(){return this._val++,this._val}};function De(t){let n,i,o,s,a;return{c(){n=M("button"),n.textContent="Add Icongrid",i=A(),o=M("button"),o.textContent="Clear Icongrid",q(n,"id","add-icongrid"),q(n,"class","svelte-1omodga"),q(o,"id","clear-icongrid"),q(o,"class","svelte-1omodga")},m(e,r){k(e,n,r),k(e,i,r),k(e,o,r),s||(a=[P(n,"click",t[15]),P(o,"click",t[16])],s=!0)},p:e,d(e){e&&I(n),e&&I(i),e&&I(o),s=!1,r(a)}}}function Ze(t){let n,i,o,s,c,l,u,f,d,h,m,p,g,w,_,v,x,y,$,S,R,F,W,E,L=t[1].length+"",B=t[0]&&De(t);return{c(){var e,r;n=M("dialog"),n.innerHTML="<p>Creating Icongrid....</p>",i=A(),o=M("div"),s=M("img"),u=A(),f=M("div"),d=M("label"),h=M("input"),m=C("\r\n        Legacy Mode"),p=A(),g=M("p"),w=C("Number of icons selected: "),_=C(L),v=A(),x=M("button"),x.textContent="Clear Icons",y=A(),B&&B.c(),$=A(),S=M("button"),S.textContent="Add Icons",R=A(),F=M("button"),F.textContent="Generate Icongrid",e=s.src,r=c="",a||(a=document.createElement("a")),a.href=r,e!==a.href&&q(s,"src",""),q(s,"alt",l="The "+(t[0]?"":"final")+" icongrid will be displayed here."),q(o,"id","preview-div"),q(o,"class","svelte-1omodga"),q(h,"type","checkbox"),q(h,"name","legacy-mode"),q(h,"id","legacy-mode"),q(h,"class","svelte-1omodga"),q(d,"for","legacy-mode"),q(d,"id","legacy-mode-label"),q(d,"class","svelte-1omodga"),q(g,"class","svelte-1omodga"),q(x,"class","svelte-1omodga"),q(S,"id","add-icons"),q(S,"class","svelte-1omodga"),q(F,"id","generate-grid"),q(F,"class","svelte-1omodga"),q(f,"id","controls"),H(f,"grid-template-columns",t[5]),q(f,"class","svelte-1omodga")},m(e,r){k(e,n,r),t[12](n),k(e,i,r),k(e,o,r),b(o,s),t[13](s),k(e,u,r),k(e,f,r),b(f,d),b(d,h),h.checked=t[0],b(d,m),b(f,p),b(f,g),b(g,w),b(g,_),b(f,v),b(f,x),b(f,y),B&&B.m(f,null),b(f,$),b(f,S),b(f,R),b(f,F),W||(E=[P(h,"change",t[14]),P(x,"click",t[8]),P(S,"click",t[17]),P(F,"click",t[6])],W=!0)},p(e,[t]){1&t&&l!==(l="The "+(e[0]?"":"final")+" icongrid will be displayed here.")&&q(s,"alt",l),1&t&&(h.checked=e[0]),2&t&&L!==(L=e[1].length+"")&&X(_,L),e[0]?B?B.p(e,t):(B=De(e),B.c(),B.m(f,$)):B&&(B.d(1),B=null),32&t&&H(f,"grid-template-columns",e[5])},i:e,o:e,d(e){e&&I(n),t[12](null),e&&I(i),e&&I(o),t[13](null),e&&I(u),e&&I(f),B&&B.d(),W=!1,r(E)}}}function Je(e,t,n){let i,{wasm:r}=t,{charname:o}=t,s=!1,a=[],c=null,l=null,u=null;async function f(e){n(4,u=e.target.files[0]),c.setAttribute("src","data:image/png;base64,"+Ee(await u.arrayBuffer()))}function d(e){n(1,a=[])}function h(e){n(1,a=[...e.target.files])}z((()=>{document.removeEventListener("clearIcons",d)})),document.addEventListener("clearIcons",d);return e.$$set=e=>{"wasm"in e&&n(10,r=e.wasm),"charname"in e&&n(11,o=e.charname)},e.$$.update=()=>{1&e.$$.dirty&&n(5,i="2fr"+(s?" 1fr 1fr":"")+" 1fr 1fr 1fr 2fr")},[s,a,c,l,u,i,async function(){if(s)if(a.length>0)if(null!==u){l.showModal();const e=new Uint8Array(await u.arrayBuffer()),t=[];for(let e of a)t.push(Ee(await e.arrayBuffer()));const n=r.make_icongrid_legacy(e,t);c.setAttribute("src","data:image/png;base64,"+Xe(n)),l.close(),Ve(n,"iconGrid.png")}else alert("No Icongrid selected! Please select an icongrid");else alert("No icons selected! Please select some icons");else{const{IconPacker:e}=r,t=e.new();if(a.length>0){l.showModal();for(let e of a)t.add_image(await e.arrayBuffer());let e=t.make_packed_image();c.setAttribute("src","data:image/png;base64,"+Xe(e)),l.close(),Ve(e,`icon-${void 0!==o?o:"character"}.png`)}else alert("No icons selected! Please select some icons")}},f,d,h,r,o,function(e){Z[e?"unshift":"push"]((()=>{l=e,n(3,l)}))},function(e){Z[e?"unshift":"push"]((()=>{c=e,n(2,c)}))},function(){s=this.checked,n(0,s)},e=>Oe(f,"image/png",!1),()=>{n(4,u=null)},e=>Oe(h,"image/png")]}class Ke extends Pe{constructor(e){super(),Ae(this,e,Je,Ze,s,{wasm:10,charname:11})}}class Qe{constructor(e){this.context=e,this.curFrames=[],this.curImgs=[],this.curFrameIndex=0,this.start=null,this.prev=null,this.ticks=0,this.animId=null,this.fps=24,this.animationScale=1,this.isPlaying=!1}resetAnimation(){this.curFrames=[],this.curImgs=[],this.curFrameIndex=0,this.start=null,this.prev=null,this.ticks=0}tick(e){this.start=e,null===this.prev&&(this.prev=e);const t=this.start-this.prev;if(this.ticks+=t,this.ticks>1e3/this.fps){const e=this.curFrames[this.curFrameIndex],t=this.curImgs[this.curFrameIndex];this.curFrameIndex=(this.curFrameIndex+1)%this.curFrames.length,this.clearCanvas(),this.drawImage(t,e),this.ticks=0}this.animId=requestAnimationFrame((e=>{this.tick(e)})),this.prev=this.start}drawImage(e,t,n=!1,i=!1){const r=t.rect,o=t.frameRect,s=t.transform,a=s.flipX?-1:1,c=s.flipY?-1:1,l=a*this.animationScale,u=c*this.animationScale;this.context.save(),this.context.scale(l,u),s.flipX&&this.context.translate(-s.newWidth,0),s.flipY&&this.context.translate(0,-s.newHeight),this.context.drawImage(e,r.x,r.y,r.width,r.height,-o.frameX*a,-o.frameY*c,s.newWidth,s.newHeight),this.context.restore(),i&&(this.context.clearRect(o.frameWidth*this.animationScale,0,this.context.canvas.width,this.context.canvas.height),this.context.clearRect(0,o.frameHeight*this.animationScale,this.context.canvas.width,this.context.canvas.height)),n&&(this.context.beginPath(),this.context.rect(0,0,o.frameWidth*this.animationScale,o.frameHeight*this.animationScale),this.context.stroke())}async initFrames(e){this.curFrames=e,this.curFrameIndex=0,this.curImgs=await Promise.all(this.curFrames.map((async e=>await Ne(e))))}play(){this.animId=requestAnimationFrame((e=>{this.tick(e)})),this.isPlaying=!0}stopAnimation(){null!==this.animId&&cancelAnimationFrame(this.animId),this.resetAnimation(),this.animId=null,this.isPlaying=!1}clearCanvas(){const e=this.context.canvas.width,t=this.context.canvas.height;this.context.clearRect(0,0,e,t)}}function et(t){let n;return{c(){n=M("div"),H(n,"width",nt),H(n,"height",nt+"px")},m(e,t){k(e,n,t)},p:e,d(e){e&&I(n)}}}function tt(t){let n,i,o,s,a,c,l,u,f,d,h,m,p,g,w=t[0].animationPrefix+"",_=!t[1]&&et();return{c(){n=M("div"),i=M("input"),s=A(),a=M("canvas"),c=C("Rendering Error!\r\n        Please use a browser that supports canvas rendering! (like Chrome or Firefox)"),l=A(),_&&_.c(),u=A(),f=M("p"),d=C(w),h=A(),m=M("button"),m.textContent="Delete",q(i,"type","checkbox"),q(i,"name","selected-chkbox"),q(i,"id","selected-chkbox"),i.checked=o=t[0].selected,H(a,"display",t[1]?"block":"none"),q(a,"width",nt+"px"),q(a,"height",nt+"px"),q(n,"class","frame-container svelte-o46j4u"),H(n,"width",nt+"px")},m(e,r){k(e,n,r),b(n,i),b(n,s),b(n,a),b(a,c),t[8](a),b(n,l),_&&_.m(n,null),b(n,u),b(n,f),b(f,d),b(n,h),b(n,m),t[10](n),p||(g=[P(m,"click",S(t[9])),P(n,"click",t[4])],p=!0)},p(e,[t]){1&t&&o!==(o=e[0].selected)&&(i.checked=o),2&t&&H(a,"display",e[1]?"block":"none"),e[1]?_&&(_.d(1),_=null):_?_.p(e,t):(_=et(),_.c(),_.m(n,u)),1&t&&w!==(w=e[0].animationPrefix+"")&&X(d,w)},i:e,o:e,d(e){e&&I(n),t[8](null),_&&_.d(),t[10](null),p=!1,r(g)}}}let nt=120;function it(e,t,n){let i,r,o,s;l(e,Te,(e=>n(12,i=e))),l(e,Be,(e=>n(13,r=e)));let a,{frameInfo:c}=t,{onRangeClick:u}=t,{rangeSelectionMode:f}=t,d=!1;async function h(){await a.initFrames([c]),a.clearCanvas(),a.animationScale=nt/Math.max(c.frameRect.frameWidth,c.frameRect.frameHeight),a.drawImage(a.curImgs[0],c,!1),n(1,d=!0)}function m(e){const t=r.indexOf(e);if(-1!==t){if(r.splice(t,1),Be.set(r),"spritesheet_frame"===c.type){const e=c.spritesheetId,[t,n]=i.get(e),r=n-1;r>0?Te.update((n=>(n.set(e,[t,r]),n))):Te.update((t=>(t.delete(e),t)))}}else console.log("[ERROR] Could not find element: "+e)}U((()=>{new IntersectionObserver((async(e,t)=>{const i=e[0];i.isIntersecting&&i.intersectionRatio>=.2?d||await h():n(1,d=!1)}),{root:document.getElementById("sprite-frames"),rootMargin:"0px",threshold:[.1,.2]}).observe(s),a=new Qe(o.getContext("2d"))}));return e.$$set=e=>{"frameInfo"in e&&n(0,c=e.frameInfo),"onRangeClick"in e&&n(6,u=e.onRangeClick),"rangeSelectionMode"in e&&n(7,f=e.rangeSelectionMode)},e.$$.update=()=>{3&e.$$.dirty&&d&&c._changed&&(h().then((()=>{})),n(0,c._changed=!1,c))},[c,d,o,s,function(){null!=u&&u(),f||n(0,c.selected=!c.selected,c)},m,u,f,function(e){Z[e?"unshift":"push"]((()=>{o=e,n(2,o)}))},()=>{m(c)},function(e){Z[e?"unshift":"push"]((()=>{s=e,n(3,s)}))}]}class rt extends Pe{constructor(e){super(),Ae(this,e,it,tt,s,{frameInfo:0,onRangeClick:6,rangeSelectionMode:7})}}function ot(e){return(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1)}const st=e=>({}),at=e=>({}),ct=e=>({}),lt=e=>({});function ut(e){let t,n,i,o,s,a,c,l,f,p,g,w,_,v,x,y;const $=e[5].header,F=u($,e,e[4],lt),W=e[5].default,E=u(W,e,e[4],null),H=e[5]["accept-btn"],L=u(H,e,e[4],at);return{c(){t=M("dialog"),n=M("div"),F&&F.c(),i=A(),o=M("hr"),s=A(),E&&E.c(),a=A(),c=M("hr"),l=A(),L&&L.c(),f=A(),p=M("hr"),g=A(),w=M("button"),_=C(e[2]),w.autofocus=!0,q(w,"class","svelte-1ed8403"),q(n,"class","svelte-1ed8403"),q(t,"class","svelte-1ed8403")},m(r,u){k(r,t,u),b(t,n),F&&F.m(n,null),b(n,i),b(n,o),b(n,s),E&&E.m(n,null),b(n,a),b(n,c),b(n,l),L&&L.m(n,null),b(n,f),b(n,p),b(n,g),b(n,w),b(w,_),e[8](t),v=!0,w.focus(),x||(y=[P(w,"click",e[7]),P(n,"click",S(e[6])),P(t,"close",e[9]),P(t,"click",R(e[10]))],x=!0)},p(e,[t]){F&&F.p&&(!v||16&t)&&h(F,$,e,e[4],v?d($,e[4],t,ct):m(e[4]),lt),E&&E.p&&(!v||16&t)&&h(E,W,e,e[4],v?d(W,e[4],t,null):m(e[4]),null),L&&L.p&&(!v||16&t)&&h(L,H,e,e[4],v?d(H,e[4],t,st):m(e[4]),at),(!v||4&t)&&X(_,e[2])},i(e){v||(me(F,e),me(E,e),me(L,e),v=!0)},o(e){pe(F,e),pe(E,e),pe(L,e),v=!1},d(n){n&&I(t),F&&F.d(n),E&&E.d(n),L&&L.d(n),e[8](null),x=!1,r(y)}}}function ft(e,t,n){let i,{$$slots:r={},$$scope:o}=t,{showModal:s}=t,{onClose:a=(()=>{})}=t,{closeButtonMsg:c="Close"}=t;return e.$$set=e=>{"showModal"in e&&n(0,s=e.showModal),"onClose"in e&&n(1,a=e.onClose),"closeButtonMsg"in e&&n(2,c=e.closeButtonMsg),"$$scope"in e&&n(4,o=e.$$scope)},e.$$.update=()=>{9&e.$$.dirty&&i&&(s?i.showModal():i.close())},[s,a,c,i,o,r,function(t){G.call(this,e,t)},()=>i.close(),function(e){Z[e?"unshift":"push"]((()=>{i=e,n(3,i)}))},()=>{n(0,s=!1),a()},()=>i.close()]}class dt extends Pe{constructor(e){super(),Ae(this,e,ft,ut,s,{showModal:0,onClose:1,closeButtonMsg:2})}}const{Map:ht}=ve;function mt(e,t,n){const i=e.slice();return i[14]=t[n],i}function pt(e,t){let n,i,r,o=t[14]+"";return{key:e,first:null,c(){n=M("option"),i=C(o),n.__value=r=t[14],n.value=n.__value,this.first=n},m(e,t){k(e,n,t),b(n,i)},p(e,s){t=e,2&s&&o!==(o=t[14]+"")&&X(i,o),2&s&&r!==(r=t[14])&&(n.__value=r,n.value=n.__value)},d(e){e&&I(n)}}}function gt(e){let t,n,i,o,s,a,c,l,u;return{c(){t=M("label"),n=M("input"),i=C("\r\n                FPS"),o=A(),s=M("label"),a=M("input"),c=C("\r\n                Animation Scale"),q(n,"type","number"),q(n,"name","fps"),q(n,"id","fps"),q(n,"min","1"),q(n,"max","120"),q(t,"for","fps"),q(a,"type","number"),q(a,"name","anim-scale"),q(a,"id","anim-scale"),q(a,"min","0.01"),q(a,"max","4"),q(a,"step","0.01"),q(s,"for","fps")},m(r,f){k(r,t,f),b(t,n),E(n,e[2].fps),b(t,i),k(r,o,f),k(r,s,f),b(s,a),E(a,e[2].animationScale),b(s,c),l||(u=[P(n,"input",e[10]),P(a,"input",e[11])],l=!0)},p(e,t){4&t&&W(n.value)!==e[2].fps&&E(n,e[2].fps),4&t&&W(a.value)!==e[2].animationScale&&E(a,e[2].animationScale)},d(e){e&&I(t),e&&I(o),e&&I(s),l=!1,r(u)}}}function wt(e){let t,n,i,o,s,a,c,l,u,f,d,h=[],m=new ht,p=e[2]?.isPlaying?"Stop":"Play",g=e[1];const w=e=>e[14];for(let t=0;t<g.length;t+=1){let n=mt(e,g,t),i=w(n);m.set(i,h[t]=pt(i,n))}let _=e[2]&&gt(e);return{c(){t=M("div"),n=M("select");for(let e=0;e<h.length;e+=1)h[e].c();i=A(),o=M("button"),s=C(p),a=C(" Animation"),c=A(),_&&_.c(),l=A(),u=M("canvas"),q(n,"name","anim-prefix"),q(n,"id","anim-prefix"),void 0===e[4]&&te((()=>e[9].call(n)))},m(r,m){k(r,t,m),b(t,n);for(let e=0;e<h.length;e+=1)h[e]&&h[e].m(n,null);L(n,e[4],!0),b(t,i),b(t,o),b(o,s),b(o,a),b(t,c),_&&_.m(t,null),k(r,l,m),k(r,u,m),e[12](u),f||(d=[P(n,"change",e[8]),P(n,"change",e[9]),P(o,"click",e[5])],f=!0)},p(e,i){2&i&&(g=e[1],h=ye(h,i,w,1,e,g,m,n,xe,pt,null,mt)),18&i&&L(n,e[4]),4&i&&p!==(p=e[2]?.isPlaying?"Stop":"Play")&&X(s,p),e[2]?_?_.p(e,i):(_=gt(e),_.c(),_.m(t,null)):_&&(_.d(1),_=null)},d(n){n&&I(t);for(let e=0;e<h.length;e+=1)h[e].d();_&&_.d(),n&&I(l),n&&I(u),e[12](null),f=!1,r(d)}}}function _t(t){let n;return{c(){n=M("h4"),n.textContent="View Animation",q(n,"slot","header")},m(e,t){k(e,n,t)},p:e,d(e){e&&I(n)}}}function vt(e){let t,n,i;function r(t){e[13](t)}let o={$$slots:{header:[_t],default:[wt]},$$scope:{ctx:e}};return void 0!==e[0]&&(o.showModal=e[0]),t=new dt({props:o}),Z.push((()=>$e(t,"showModal",r))),{c(){ke(t.$$.fragment)},m(e,n){Ie(t,e,n),i=!0},p(e,[i]){const r={};131102&i&&(r.$$scope={dirty:i,ctx:e}),!n&&1&i&&(n=!0,r.showModal=e[0],ne((()=>n=!1))),t.$set(r)},i(e){i||(me(t.$$.fragment,e),i=!0)},o(e){pe(t.$$.fragment,e),i=!1},d(e){Me(t,e)}}}function xt(e,t,n){let i;l(e,Be,(e=>n(7,i=e)));let r,{showView:o=!1}=t,s=null,a=new Map,c=[],u=null;U((()=>{n(2,u=new Qe(s.getContext("2d")))}));return e.$$set=e=>{"showView"in e&&n(0,o=e.showView)},e.$$.update=()=>{if(5&e.$$.dirty&&null!==u&&(o?(console.log("Clearing canvas: ",u.isPlaying),u.clearCanvas()):u.stopAnimation(),n(2,u),n(0,o)),195&e.$$.dirty&&o){n(6,a=new Map),n(1,c=[]);for(let e of i)if(a.has(e.animationPrefix)){let t=a.get(e.animationPrefix);a.set(e.animationPrefix,[...t,e])}else a.set(e.animationPrefix,[e]);for(let e of a.keys())n(1,c=[...c,e])}},[o,c,u,s,r,async function(){null===u.animId?(await u.initFrames(a.get(r)),u.play(),n(2,u.context.canvas.width=.9*window.innerWidth,u),n(2,u.context.canvas.height=.9*window.innerHeight,u)):u.stopAnimation(),console.log("Anim is "+u.animId),n(2,u),n(0,o)},a,i,()=>{u.stopAnimation(),n(2,u),n(0,o)},function(){r=function(e){const t=e.querySelector(":checked");return t&&t.__value}(this),n(4,r),n(1,c),n(0,o),n(7,i),n(6,a)},function(){u.fps=W(this.value),n(2,u),n(0,o)},function(){u.animationScale=W(this.value),n(2,u),n(0,o)},function(e){Z[e?"unshift":"push"]((()=>{s=e,n(3,s)}))},function(e){o=e,n(0,o)}]}class bt extends Pe{constructor(e){super(),Ae(this,e,xt,vt,s,{showView:0})}}function yt(e,t,n){const i=e.slice();return i[34]=t[n],i[35]=t,i[36]=n,i}function $t(e,t){let n,i,o,s,a,c,l,u,f,d,h,m,p,g,w,_,v,x,y,$,R,F,W,E,H,L,B,T,O,V,Y,N,j,U,z,G,D,Z,J,K,Q,ee=t[34].animationPrefix+"",te=t[34].rect.width+"",ne=t[34].rect.height+"",ie=t[34].frameRect.frameX+"",re=t[34].frameRect.frameY+"",oe=t[34].frameRect.frameWidth+"",se=t[34].frameRect.frameHeight+"",ae=t[34].transform.newWidth+"",ce=t[34].transform.newHeight+"",le=t[34].transform.flipX+"",ue=t[34].transform.flipY+"",fe=t[36];function de(...e){return t[17](t[36],t[34],...e)}const he=()=>t[18](n,fe),me=()=>t[18](null,fe);function pe(...e){return t[19](t[36],t[34],...e)}return{key:e,first:null,c(){n=M("tr"),i=M("td"),o=M("input"),c=A(),l=M("td"),u=C(ee),f=A(),d=M("td"),h=C(te),m=A(),p=M("td"),g=C(ne),w=A(),_=M("td"),v=C(ie),x=A(),y=M("td"),$=C(re),R=A(),F=M("td"),W=C(oe),E=A(),H=M("td"),L=C(se),B=A(),T=M("td"),O=C(ae),V=A(),Y=M("td"),N=C(ce),j=A(),U=M("td"),z=C(le),G=A(),D=M("td"),Z=C(ue),J=A(),q(o,"type","checkbox"),q(o,"name",s="select-"+t[34].sprId),q(o,"id",a="select-"+t[34].sprId),q(o,"class","svelte-1qvrxoo"),q(i,"class","svelte-1qvrxoo"),q(l,"class","svelte-1qvrxoo"),q(d,"class","svelte-1qvrxoo"),q(p,"class","svelte-1qvrxoo"),q(_,"class","svelte-1qvrxoo"),q(y,"class","svelte-1qvrxoo"),q(F,"class","svelte-1qvrxoo"),q(H,"class","svelte-1qvrxoo"),q(T,"class","svelte-1qvrxoo"),q(Y,"class","svelte-1qvrxoo"),q(U,"class","svelte-1qvrxoo"),q(D,"class","svelte-1qvrxoo"),this.first=n},m(e,t){k(e,n,t),b(n,i),b(i,o),b(n,c),b(n,l),b(l,u),b(n,f),b(n,d),b(d,h),b(n,m),b(n,p),b(p,g),b(n,w),b(n,_),b(_,v),b(n,x),b(n,y),b(y,$),b(n,R),b(n,F),b(F,W),b(n,E),b(n,H),b(H,L),b(n,B),b(n,T),b(T,O),b(n,V),b(n,Y),b(Y,N),b(n,j),b(n,U),b(U,z),b(n,G),b(n,D),b(D,Z),b(n,J),he(),K||(Q=[P(o,"change",de),P(n,"click",S(pe))],K=!0)},p(e,n){t=e,4096&n[0]&&s!==(s="select-"+t[34].sprId)&&q(o,"name",s),4096&n[0]&&a!==(a="select-"+t[34].sprId)&&q(o,"id",a),4096&n[0]&&ee!==(ee=t[34].animationPrefix+"")&&X(u,ee),4096&n[0]&&te!==(te=t[34].rect.width+"")&&X(h,te),4096&n[0]&&ne!==(ne=t[34].rect.height+"")&&X(g,ne),4096&n[0]&&ie!==(ie=t[34].frameRect.frameX+"")&&X(v,ie),4096&n[0]&&re!==(re=t[34].frameRect.frameY+"")&&X($,re),4096&n[0]&&oe!==(oe=t[34].frameRect.frameWidth+"")&&X(W,oe),4096&n[0]&&se!==(se=t[34].frameRect.frameHeight+"")&&X(L,se),4096&n[0]&&ae!==(ae=t[34].transform.newWidth+"")&&X(O,ae),4096&n[0]&&ce!==(ce=t[34].transform.newHeight+"")&&X(N,ce),4096&n[0]&&le!==(le=t[34].transform.flipX+"")&&X(z,le),4096&n[0]&&ue!==(ue=t[34].transform.flipY+"")&&X(Z,ue),fe!==t[36]&&(me(),fe=t[36],he())},d(e){e&&I(n),me(),K=!1,r(Q)}}}function kt(e){let t,n,i,o,s,a,c,l,u,f,d,h,m,p,g,w,_,v,x,y,$,S,R,F,W,X,E,H,L,B,T,O,V,Y,N,j,U,z,G,D,Z,J,K,Q,ee,te,ne,ie,re,oe=[],se=new Map,ae=e[12];const ce=e=>e[34].sprId;for(let t=0;t<ae.length;t+=1){let n=yt(e,ae,t),i=ce(n);se.set(i,oe[t]=$t(i,n))}return{c(){t=M("div"),n=M("div"),i=M("table"),o=M("thead"),o.innerHTML='<th class="svelte-1qvrxoo"></th> \n                    <th class="svelte-1qvrxoo">Prefix</th> \n                    <th class="svelte-1qvrxoo">Width</th> \n                    <th class="svelte-1qvrxoo">Height</th> \n                    <th class="svelte-1qvrxoo">Frame X</th> \n                    <th class="svelte-1qvrxoo">Frame Y</th> \n                    <th class="svelte-1qvrxoo">Frame Width</th> \n                    <th class="svelte-1qvrxoo">Frame Height</th> \n                    <th class="svelte-1qvrxoo">New Image Width</th> \n                    <th class="svelte-1qvrxoo">New Image Height</th> \n                    <th class="svelte-1qvrxoo">flip X</th> \n                    <th class="svelte-1qvrxoo">flip Y</th>',s=A(),a=M("tbody");for(let e=0;e<oe.length;e+=1)oe[e].c();c=A(),l=M("div"),u=M("div"),f=M("label"),d=C("Frame X\r\n                    "),h=M("input"),m=A(),p=M("label"),g=C("Frame Y\r\n                    "),w=M("input"),_=A(),v=M("label"),x=C("Frame Width\r\n                    "),y=M("input"),$=A(),S=M("label"),R=C("Frame Height\r\n                    "),F=M("input"),W=A(),X=M("label"),E=C("Image Width\r\n                    "),H=M("input"),L=A(),B=M("label"),T=C("Image Height\r\n                    "),O=M("input"),V=A(),Y=M("label"),N=C("Flip X\r\n                    "),j=M("input"),U=A(),z=M("label"),G=C("Flip Y\r\n                    "),D=M("input"),Z=A(),J=M("label"),K=C("Animation Scale\r\n                    "),Q=M("input"),ee=A(),te=M("div"),ne=M("canvas"),q(i,"class","not-selectable svelte-1qvrxoo"),q(n,"id","table-div"),q(n,"class","svelte-1qvrxoo"),q(h,"type","number"),q(h,"name","frame-x"),q(h,"id","frame-x"),q(h,"class","svelte-1qvrxoo"),q(f,"class","xmlview-input svelte-1qvrxoo"),q(f,"for","frame-x"),q(w,"type","number"),q(w,"name","frame-y"),q(w,"id","frame-y"),q(w,"class","svelte-1qvrxoo"),q(p,"class","xmlview-input svelte-1qvrxoo"),q(p,"for","frame-y"),q(y,"type","number"),q(y,"name","frame-width"),q(y,"id","frame-width"),q(y,"class","svelte-1qvrxoo"),q(v,"class","xmlview-input svelte-1qvrxoo"),q(v,"for","frame-width"),q(F,"type","number"),q(F,"name","frame-height"),q(F,"id","frame-height"),q(F,"class","svelte-1qvrxoo"),q(S,"class","xmlview-input svelte-1qvrxoo"),q(S,"for","frame-height"),q(H,"type","number"),q(H,"name","scale-x"),q(H,"id","scale-x"),q(H,"min","1"),q(H,"class","svelte-1qvrxoo"),q(X,"class","xmlview-input svelte-1qvrxoo"),q(X,"for","scale-x"),q(O,"type","number"),q(O,"name","scale-y"),q(O,"id","scale-y"),q(O,"min","1"),q(O,"class","svelte-1qvrxoo"),q(B,"class","xmlview-input svelte-1qvrxoo"),q(B,"for","scale-y"),q(j,"type","checkbox"),q(j,"name","flip-x"),q(j,"id","flip-x"),q(j,"class","svelte-1qvrxoo"),q(Y,"class","xmlview-input svelte-1qvrxoo"),q(Y,"for","flip-x"),q(D,"type","checkbox"),q(D,"name","flip-y"),q(D,"id","flip-y"),q(D,"class","svelte-1qvrxoo"),q(z,"class","xmlview-input svelte-1qvrxoo"),q(z,"for","flip-y"),q(Q,"type","number"),q(Q,"name","animation-scale"),q(Q,"id","animation-scale"),q(Q,"min","0.01"),q(Q,"step","0.01"),q(Q,"class","svelte-1qvrxoo"),q(J,"class","xmlview-input svelte-1qvrxoo"),q(J,"for","animation-scale"),q(u,"class","controls-horizontal svelte-1qvrxoo"),q(ne,"width","550px"),q(ne,"height","500px"),q(ne,"class","svelte-1qvrxoo"),q(te,"class","canvas-div svelte-1qvrxoo"),q(t,"id","view-container"),q(t,"class","svelte-1qvrxoo")},m(r,I){k(r,t,I),b(t,n),b(n,i),b(i,o),b(i,s),b(i,a);for(let e=0;e<oe.length;e+=1)oe[e]&&oe[e].m(a,null);b(t,c),b(t,l),b(l,u),b(u,f),b(f,d),b(f,h),e[20](h),b(u,m),b(u,p),b(p,g),b(p,w),e[21](w),b(u,_),b(u,v),b(v,x),b(v,y),e[22](y),b(u,$),b(u,S),b(S,R),b(S,F),e[23](F),b(u,W),b(u,X),b(X,E),b(X,H),e[24](H),b(u,L),b(u,B),b(B,T),b(B,O),e[25](O),b(u,V),b(u,Y),b(Y,N),b(Y,j),e[26](j),b(u,U),b(u,z),b(z,G),b(z,D),e[27](D),b(u,Z),b(u,J),b(J,K),b(J,Q),e[28](Q),b(l,ee),b(l,te),b(te,ne),e[29](ne),ie||(re=[P(h,"input",e[16]),P(w,"input",e[16]),P(y,"input",e[16]),P(F,"input",e[16]),P(H,"input",e[16]),P(O,"input",e[16]),P(j,"input",e[16]),P(D,"input",e[16]),P(Q,"input",e[14])],ie=!0)},p(e,t){46080&t[0]&&(ae=e[12],oe=ye(oe,t,ce,1,e,ae,se,a,xe,$t,null,yt))},d(n){n&&I(t);for(let e=0;e<oe.length;e+=1)oe[e].d();e[20](null),e[21](null),e[22](null),e[23](null),e[24](null),e[25](null),e[26](null),e[27](null),e[28](null),e[29](null),ie=!1,r(re)}}}function It(t){let n;return{c(){n=M("div"),n.innerHTML="<h4>XML View</h4>",q(n,"slot","header")},m(e,t){k(e,n,t)},p:e,d(e){e&&I(n)}}}function Mt(e){let t,n,i;function r(t){e[30](t)}let o={closeButtonMsg:"Save and Close",$$slots:{header:[It],default:[kt]},$$scope:{ctx:e}};return void 0!==e[0]&&(o.showModal=e[0]),t=new dt({props:o}),Z.push((()=>$e(t,"showModal",r))),{c(){ke(t.$$.fragment)},m(e,n){Ie(t,e,n),i=!0},p(e,i){const r={};8190&i[0]|64&i[1]&&(r.$$scope={dirty:i,ctx:e}),!n&&1&i[0]&&(n=!0,r.showModal=e[0],ne((()=>n=!1))),t.$set(r)},i(e){i||(me(t.$$.fragment,e),i=!0)},o(e){pe(t.$$.fragment,e),i=!1},d(e){Me(t,e)}}}function Ct(e,t,n){let i;l(e,Be,(e=>n(12,i=e)));let{showView:r=!1}=t,o=null,s=null,a=null,c=null,u=null,f=null,d=null,h=null,m=null,p=null,g=[],w=null,_=new Qe(null);async function v(e){w&&(await _.initFrames([e]),_.clearCanvas(),_.drawImage(_.curImgs[0],e,!0))}function x(e){o=i[e];for(const e of g)e&&(e.style.backgroundColor="white");n(10,g[e].style.backgroundColor="blue",g),n(2,a.value=""+o.frameRect.frameX,a),n(3,c.value=""+o.frameRect.frameY,c),n(4,u.value=""+o.frameRect.frameWidth,u),n(5,f.value=""+o.frameRect.frameHeight,f),n(6,d.value=""+o.transform.newWidth,d),n(7,h.value=""+o.transform.newHeight,h),n(8,m.checked=o.transform.flipX,m),n(9,p.checked=o.transform.flipY,p)}U((()=>{_=new Qe(w.getContext("2d")),n(1,s.value=""+_.animationScale,s)}));return e.$$set=e=>{"showView"in e&&n(0,r=e.showView)},[r,s,a,c,u,f,d,h,m,p,g,w,i,v,function(e){_.animationScale=parseFloat(e.target.value),v(o).then((()=>{}))},x,function(e){o.frameRect.frameX=+a.value,o.frameRect.frameY=+c.value,o.frameRect.frameWidth=+u.value,o.frameRect.frameHeight=+f.value,o.transform.newWidth=+d.value,o.transform.newHeight=+h.value,o.transform.flipX=m.checked,o.transform.flipY=p.checked,o._changed=!0,Be.set(i),v(o).then((()=>{}))},async(e,t,n)=>{x(e),await v(t)},function(e,t){Z[e?"unshift":"push"]((()=>{g[t]=e,n(10,g)}))},async(e,t,n)=>{x(e),await v(t)},function(e){Z[e?"unshift":"push"]((()=>{a=e,n(2,a)}))},function(e){Z[e?"unshift":"push"]((()=>{c=e,n(3,c)}))},function(e){Z[e?"unshift":"push"]((()=>{u=e,n(4,u)}))},function(e){Z[e?"unshift":"push"]((()=>{f=e,n(5,f)}))},function(e){Z[e?"unshift":"push"]((()=>{d=e,n(6,d)}))},function(e){Z[e?"unshift":"push"]((()=>{h=e,n(7,h)}))},function(e){Z[e?"unshift":"push"]((()=>{m=e,n(8,m)}))},function(e){Z[e?"unshift":"push"]((()=>{p=e,n(9,p)}))},function(e){Z[e?"unshift":"push"]((()=>{s=e,n(1,s)}))},function(e){Z[e?"unshift":"push"]((()=>{w=e,n(11,w)}))},function(e){r=e,n(0,r)}]}class At extends Pe{constructor(e){super(),Ae(this,e,Ct,Mt,s,{showView:0},null,[-1,-1])}}class Pt{constructor(e,t,n,i,r){this.sprId=e,this.type=t,this.imgfileref=n,this.xmlfileref=i,this.selected=!1,this.spritesheetId=r,this.animationPrefix="",this.rect={x:0,y:0,width:null,height:null},this.transform={newWidth:null,newHeight:null,flipX:!1,flipY:!1},this.frameRect={frameX:0,frameY:0,frameWidth:null,frameHeight:null},this._changed=!1}clone(){const e=new Pt(this.sprId,this.type,this.imgfileref,this.xmlfileref,this.spritesheetId);return e.selected=this.selected,e.animationPrefix=this.animationPrefix,e.rect=Object.assign({},this.rect),e.transform=Object.assign({},this.transform),e.frameRect=Object.assign({},this.frameRect),e}}function St(e){let t,n,i,o,s,a,c,l,u,f,d,h,m,p,g,w,_,v,x,y,$,S,R,X,H,L,B,T,O,V,Y,N,j,U,z,G,D,Z,J,K;return Z=F(e[4][0]),{c(){t=M("div"),n=M("label"),n.textContent="Image Padding",i=A(),o=M("input"),s=A(),a=M("br"),c=A(),l=M("br"),u=A(),f=M("br"),d=A(),h=M("label"),h.textContent="Animation Name Prefixing",m=A(),p=M("br"),g=A(),w=M("label"),_=M("input"),v=C("\r\n            Use character name as prefix"),x=A(),y=M("label"),$=M("input"),S=C("\r\n            Use custom name as prefix"),R=A(),X=M("label"),X.textContent="Custom Prefix",H=A(),L=M("input"),T=A(),O=M("label"),V=M("input"),Y=C("\r\n            Do not use a prefix"),N=A(),j=M("br"),U=A(),z=M("label"),G=M("input"),D=C("\r\n            Use Prefix even if frame is imported from existing Spritesheet"),q(n,"for","padding"),q(o,"type","number"),q(o,"name","padding"),q(o,"id","padding"),q(o,"min","0"),q(o,"max","20"),q(h,"for","prefix-type"),q(_,"type","radio"),q(_,"name","prefix-type"),q(_,"id","prefix-type-character-name"),_.__value="character-name",_.value=_.__value,q(w,"for","prefix-type-character-name"),q($,"type","radio"),q($,"name","prefix-type"),q($,"id","prefix-type-custom-prefix"),$.__value="custom-prefix",$.value=$.__value,q(y,"for","prefix-type-custom-prefix"),q(X,"for","custom-prefix"),q(L,"type","text"),q(L,"id","custom-prefix"),L.disabled=B="custom-prefix"!==e[1].prefixType,q(V,"type","radio"),q(V,"name","prefix-type"),q(V,"id","prefix-type-no-prefix"),V.__value="no-prefix",V.value=V.__value,q(O,"for","prefix-type-no-prefix"),q(G,"type","checkbox"),q(G,"name","use-prefix-on-existing-xmls"),q(G,"id","use-prefix-on-existing-xmls"),q(z,"for","use-prefix-on-existing-xmls"),q(t,"id","modal-content"),q(t,"class","svelte-6d2dce"),Z.p(_,$,V)},m(r,I){k(r,t,I),b(t,n),b(t,i),b(t,o),E(o,e[1].padding),b(t,s),b(t,a),b(t,c),b(t,l),b(t,u),b(t,f),b(t,d),b(t,h),b(t,m),b(t,p),b(t,g),b(t,w),b(w,_),_.checked=_.__value===e[1].prefixType,b(w,v),b(t,x),b(t,y),b(y,$),$.checked=$.__value===e[1].prefixType,b(y,S),b(t,R),b(t,X),b(t,H),b(t,L),E(L,e[1].customPrefix),b(t,T),b(t,O),b(O,V),V.checked=V.__value===e[1].prefixType,b(O,Y),b(t,N),b(t,j),b(t,U),b(t,z),b(z,G),G.checked=e[1].usePrefixOnXMLFrames,b(z,D),J||(K=[P(o,"input",e[2]),P(_,"change",e[3]),P($,"change",e[5]),P(L,"input",e[6]),P(V,"change",e[7]),P(G,"change",e[8])],J=!0)},p(e,t){2&t&&W(o.value)!==e[1].padding&&E(o,e[1].padding),2&t&&(_.checked=_.__value===e[1].prefixType),2&t&&($.checked=$.__value===e[1].prefixType),2&t&&B!==(B="custom-prefix"!==e[1].prefixType)&&(L.disabled=B),2&t&&L.value!==e[1].customPrefix&&E(L,e[1].customPrefix),2&t&&(V.checked=V.__value===e[1].prefixType),2&t&&(G.checked=e[1].usePrefixOnXMLFrames)},d(e){e&&I(t),Z.r(),J=!1,r(K)}}}function Rt(t){let n;return{c(){n=M("h4"),n.textContent="Settings",q(n,"slot","header"),q(n,"class","svelte-6d2dce")},m(e,t){k(e,n,t)},p:e,d(e){e&&I(n)}}}function qt(e){let t,n,i;function r(t){e[9](t)}let o={$$slots:{header:[Rt],default:[St]},$$scope:{ctx:e}};return void 0!==e[0]&&(o.showModal=e[0]),t=new dt({props:o}),Z.push((()=>$e(t,"showModal",r))),{c(){ke(t.$$.fragment)},m(e,n){Ie(t,e,n),i=!0},p(e,[i]){const r={};1026&i&&(r.$$scope={dirty:i,ctx:e}),!n&&1&i&&(n=!0,r.showModal=e[0],ne((()=>n=!1))),t.$set(r)},i(e){i||(me(t.$$.fragment,e),i=!0)},o(e){pe(t.$$.fragment,e),i=!1},d(e){Me(t,e)}}}function Ft(e,t,n){let{showView:i=!1}=t,{settings:r={padding:2,prefixType:"no-prefix",usePrefixOnXMLFrames:!1,customPrefix:""}}=t;return e.$$set=e=>{"showView"in e&&n(0,i=e.showView),"settings"in e&&n(1,r=e.settings)},[i,r,function(){r.padding=W(this.value),n(1,r)},function(){r.prefixType=this.__value,n(1,r)},[[]],function(){r.prefixType=this.__value,n(1,r)},function(){r.customPrefix=this.value,n(1,r)},function(){r.prefixType=this.__value,n(1,r)},function(){r.usePrefixOnXMLFrames=this.checked,n(1,r)},function(e){i=e,n(0,i)}]}class Wt extends Pe{constructor(e){super(),Ae(this,e,Ft,qt,s,{showView:0,settings:1})}}function Xt(e){let t,n,i,o,s,a,c,l,u,f,d,h,m,p=(null!==e[9]?e[9].name:"")+"",g=(null!==e[10]?e[10].name:"")+"";return{c(){t=M("button"),t.textContent="Spritesheet (.png)",n=A(),i=M("button"),i.textContent="XML File (.xml)",o=A(),s=M("p"),a=C("Spritesheet selected: "),c=C(p),l=A(),u=M("p"),f=C("XML selected: "),d=C(g)},m(r,p){k(r,t,p),k(r,n,p),k(r,i,p),k(r,o,p),k(r,s,p),b(s,a),b(s,c),k(r,l,p),k(r,u,p),b(u,f),b(u,d),h||(m=[P(t,"click",e[34]),P(i,"click",e[35])],h=!0)},p(e,t){512&t[0]&&p!==(p=(null!==e[9]?e[9].name:"")+"")&&X(c,p),1024&t[0]&&g!==(g=(null!==e[10]?e[10].name:"")+"")&&X(d,g)},d(e){e&&I(t),e&&I(n),e&&I(i),e&&I(o),e&&I(s),e&&I(l),e&&I(u),h=!1,r(m)}}}function Et(t){let n;return{c(){n=M("p"),n.textContent="Select Spritesheet or XML file",q(n,"slot","header")},m(e,t){k(e,n,t)},p:e,d(e){e&&I(n)}}}function Ht(t){let n,i,r;return{c(){n=M("button"),n.textContent="Add Spritesheet and XML",q(n,"slot","accept-btn")},m(e,o){k(e,n,o),i||(r=P(n,"click",t[33]),i=!0)},p:e,d(e){e&&I(n),i=!1,r()}}}function Lt(t){let n;return{c(){n=M("input"),q(n,"type","text"),q(n,"name","anim-prefix"),q(n,"id","anim-prefix"),n.value="name"},m(e,i){k(e,n,i),t[38](n)},p:e,d(e){e&&I(n),t[38](null)}}}function Bt(t){let n;return{c(){n=M("p"),n.textContent="Enter animation prefix",q(n,"slot","header")},m(e,t){k(e,n,t)},p:e,d(e){e&&I(n)}}}function Tt(t){let n,i,r;return{c(){n=M("button"),n.textContent="Set animation prefix",q(n,"slot","accept-btn")},m(e,o){k(e,n,o),i||(r=P(n,"click",t[37]),i=!0)},p:e,d(e){e&&I(n),i=!1,r()}}}function Ot(e){let t,n,i,o,s,a,c,l,u;return{c(){t=M("div"),n=M("button"),n.textContent="View XML structure",i=A(),o=M("button"),o.textContent="View Animation",q(t,"class","view-menu svelte-ie7kio"),q(t,"id","view-opts")},m(r,s){k(r,t,s),b(t,n),b(t,i),b(t,o),e[48](t),c=!0,l||(u=[P(n,"click",S(e[46])),P(o,"click",S(e[47]))],l=!0)},p(t,n){e=t},i(n){c||(te((()=>{c&&(a&&a.end(1),s=we(t,e[22],{duration:100,easing:ot}),s.start())})),c=!0)},o(n){s&&s.invalidate(),a=_e(t,e[22],{duration:100,easing:ot}),c=!1},d(n){n&&I(t),e[48](null),n&&a&&a.end(),l=!1,r(u)}}}function Vt(e){let t,n,i,o,s,a,c,l,u,f,d,h,m;return{c(){t=M("div"),n=M("button"),n.textContent="Set animation prefix",i=A(),o=M("button"),o.textContent="Delete Selection",s=A(),a=M("button"),a.textContent="Clone Selection",c=A(),l=M("button"),l.textContent="Toggle Select on Range",q(t,"class","view-menu svelte-ie7kio"),q(t,"id","view-selection-opts")},m(r,u){k(r,t,u),b(t,n),b(t,i),b(t,o),b(t,s),b(t,a),b(t,c),b(t,l),e[53](t),d=!0,h||(m=[P(n,"click",S(e[52])),P(o,"click",S(e[24])),P(a,"click",S(e[25])),P(l,"click",S(e[27]))],h=!0)},p(t,n){e=t},i(n){d||(te((()=>{d&&(f&&f.end(1),u=we(t,e[22],{duration:100,easing:ot}),u.start())})),d=!0)},o(n){u&&u.invalidate(),f=_e(t,e[22],{duration:100,easing:ot}),d=!1},d(n){n&&I(t),e[53](null),n&&f&&f.end(),h=!1,r(m)}}}function Yt(e){let t,n,i,o,s,a,c,l,u,f,d,h,m,p,g,w,_,v,x,y,$,F,W,E,H,L,B,T,O,V,Y,N,j,U,z,G,D,J,K,Q,ee,te,ie,re,oe;function se(t){e[36](t)}let ae={$$slots:{"accept-btn":[Ht],header:[Et],default:[Xt]},$$scope:{ctx:e}};function ce(t){e[39](t)}void 0!==e[4]&&(ae.showModal=e[4]),u=new dt({props:ae}),Z.push((()=>$e(u,"showModal",se)));let le={$$slots:{"accept-btn":[Tt],header:[Bt],default:[Lt]},$$scope:{ctx:e}};function ue(t){e[40](t)}function fe(t){e[41](t)}void 0!==e[5]&&(le.showModal=e[5]),h=new dt({props:le}),Z.push((()=>$e(h,"showModal",ce)));let ge={};function we(t){e[42](t)}void 0!==e[6]&&(ge.showView=e[6]),void 0!==e[1]&&(ge.settings=e[1]),g=new Wt({props:ge}),Z.push((()=>$e(g,"showView",ue))),Z.push((()=>$e(g,"settings",fe)));let _e={};function ve(t){e[43](t)}void 0!==e[7]&&(_e.showView=e[7]),x=new bt({props:_e}),Z.push((()=>$e(x,"showView",we)));let xe={};void 0!==e[8]&&(xe.showView=e[8]),F=new At({props:xe}),Z.push((()=>$e(F,"showView",ve)));let be=e[2]&&Ot(e),ye=e[3]&&Vt(e);return{c(){t=M("dialog"),n=M("div"),i=M("label"),o=C(e[15]),s=A(),a=M("progress"),l=A(),ke(u.$$.fragment),d=A(),ke(h.$$.fragment),p=A(),ke(g.$$.fragment),v=A(),ke(x.$$.fragment),$=A(),ke(F.$$.fragment),E=A(),H=M("div"),L=M("button"),L.textContent="Settings",B=A(),T=M("button"),T.textContent="View",O=A(),be&&be.c(),V=A(),Y=M("label"),N=M("input"),j=C("\r\n        Select all"),U=A(),z=M("button"),z.textContent="Selection",G=A(),ye&&ye.c(),D=A(),J=M("button"),J.textContent="Add PNGs",K=A(),Q=M("button"),Q.textContent="Add Spritesheet",ee=A(),te=M("button"),te.textContent="Generate XML",q(i,"for","gen-progress"),q(a,"id","gen-progress"),a.value=c=Math.round(100*e[14]),q(a,"max","100"),q(N,"type","checkbox"),q(N,"name","select-all"),q(N,"id","select-all"),q(Y,"for","select-all"),q(H,"id","controls"),q(H,"class","svelte-ie7kio")},m(r,c){k(r,t,c),b(t,n),b(n,i),b(i,o),b(n,s),b(n,a),e[32](t),k(r,l,c),Ie(u,r,c),k(r,d,c),Ie(h,r,c),k(r,p,c),Ie(g,r,c),k(r,v,c),Ie(x,r,c),k(r,$,c),Ie(F,r,c),k(r,E,c),k(r,H,c),b(H,L),b(H,B),b(H,T),b(H,O),be&&be.m(H,null),b(H,V),b(H,Y),b(Y,N),e[49](N),b(Y,j),b(H,U),b(H,z),b(H,G),ye&&ye.m(H,null),b(H,D),b(H,J),b(H,K),b(H,Q),b(H,ee),b(H,te),ie=!0,re||(oe=[P(L,"click",e[44]),P(T,"click",R(S(e[45]))),P(N,"change",e[50]),P(z,"click",S(e[51])),P(J,"click",e[54]),P(Q,"click",e[55]),P(te,"click",e[56])],re=!0)},p(e,t){(!ie||32768&t[0])&&X(o,e[15]),(!ie||16384&t[0]&&c!==(c=Math.round(100*e[14])))&&(a.value=c);const n={};1552&t[0]|268435456&t[1]&&(n.$$scope={dirty:t,ctx:e}),!f&&16&t[0]&&(f=!0,n.showModal=e[4],ne((()=>f=!1))),u.$set(n);const i={};2080&t[0]|268435456&t[1]&&(i.$$scope={dirty:t,ctx:e}),!m&&32&t[0]&&(m=!0,i.showModal=e[5],ne((()=>m=!1))),h.$set(i);const r={};!w&&64&t[0]&&(w=!0,r.showView=e[6],ne((()=>w=!1))),!_&&2&t[0]&&(_=!0,r.settings=e[1],ne((()=>_=!1))),g.$set(r);const s={};!y&&128&t[0]&&(y=!0,s.showView=e[7],ne((()=>y=!1))),x.$set(s);const l={};!W&&256&t[0]&&(W=!0,l.showView=e[8],ne((()=>W=!1))),F.$set(l),e[2]?be?(be.p(e,t),4&t[0]&&me(be,1)):(be=Ot(e),be.c(),me(be,1),be.m(H,V)):be&&(de(),pe(be,1,1,(()=>{be=null})),he()),e[3]?ye?(ye.p(e,t),8&t[0]&&me(ye,1)):(ye=Vt(e),ye.c(),me(ye,1),ye.m(H,D)):ye&&(de(),pe(ye,1,1,(()=>{ye=null})),he())},i(e){ie||(me(u.$$.fragment,e),me(h.$$.fragment,e),me(g.$$.fragment,e),me(x.$$.fragment,e),me(F.$$.fragment,e),me(be),me(ye),ie=!0)},o(e){pe(u.$$.fragment,e),pe(h.$$.fragment,e),pe(g.$$.fragment,e),pe(x.$$.fragment,e),pe(F.$$.fragment,e),pe(be),pe(ye),ie=!1},d(n){n&&I(t),e[32](null),n&&I(l),Me(u,n),n&&I(d),Me(h,n),n&&I(p),Me(g,n),n&&I(v),Me(x,n),n&&I($),Me(F,n),n&&I(E),n&&I(H),be&&be.d(),e[49](null),ye&&ye.d(),re=!1,r(oe)}}}function Nt(e,n,i){let r,o;l(e,Be,(e=>i(31,r=e))),l(e,Te,(e=>i(57,o=e)));let{wasm:s}=n,{charname:a}=n,{rangeSelectionMode:c=!1}=n,u={padding:2,prefixType:"no-prefix",usePrefixOnXMLFrames:!1,customPrefix:""};async function f(e){const t=e.target;let n=[];for(let e of t.files){const[t,i]=await je(e),r=new Pt(e.name+"::"+Ge.getNewId(),"single_frame",e,null,null);r.rect.width=t,r.rect.height=i,r.transform.newWidth=t,r.transform.newHeight=i,r.frameRect.frameWidth=t,r.frameRect.frameHeight=i,r.animationPrefix=e.name.substring(0,e.name.indexOf(".png")),n.push(r)}Be.update((e=>[...e,...n]))}async function d(e,t,n){if(null==t)return alert("Please select a spritesheet"),!0;if(null==n)return alert("Please select an XML"),!0;let i=await t.arrayBuffer();const r=await async function(e){const t=await crypto.subtle.digest("SHA-1",e);return Xe(new Uint8Array(t))}(new Uint8Array(i)),o=Ee(i);Te.update((e=>(e.has(r)||e.set(r,[o,0]),e)));const s=await n.text(),a=(new DOMParser).parseFromString(s,"text/xml").getElementsByTagName("SubTexture"),c=[];for(let e of a){const i=e.getAttribute("name"),o=Ye(i,(e=>!(e>="0"&&e<="9")),!0),s=new Pt(t.name+"::"+Ge.getNewId(),"spritesheet_frame",t,n,r);s.animationPrefix=i.substring(0,o+1),s.rect={x:parseInt(e.getAttribute("x")),y:parseInt(e.getAttribute("y")),width:parseInt(e.getAttribute("width")),height:parseInt(e.getAttribute("height"))},s.frameRect={frameX:parseInt(e.getAttribute("frameX"))||0,frameY:parseInt(e.getAttribute("frameY"))||0,frameWidth:parseInt(e.getAttribute("frameWidth"))||s.rect.width,frameHeight:parseInt(e.getAttribute("frameHeight"))||s.rect.height},s.transform.newWidth=s.rect.width,s.transform.newHeight=s.rect.height,c.push(s)}return Be.update((e=>[...e,...c])),Te.update((e=>{const[t,n]=e.get(r);return e.set(r,[t,n+a.length]),e})),t=null,n=null,!1}function h(e){for(let t=0;t<r.length;t++){let n=r[t];n.selected&&(n.animationPrefix=e,n.selected=!1)}Be.set(r)}let m=!1,p=!1,g=!1,w=!1,_=!1,v=!1,x=!1,b=null,y=null,$=null,k=null,I=null,M=null;const C=e=>{I&&e.target!==I&&i(2,m=!1),M&&e.target!==M&&i(3,p=!1)};function A(e){i(9,b=e.target.files[0])}function P(e){i(10,y=e.target.files[0])}function S(e){Be.update((t=>t.map((t=>(t.selected=e,t)))))}U((()=>{document.body.addEventListener("click",C)})),z((()=>{document.body.removeEventListener("click",C)}));let R=0,q="Adding images: 0%",F=null;async function W(){if(console.log(u),!Ue(a)||!Ue(a+".zip"))return void alert("Please enter a valid filename as the name of your character!");if(r.length<=0)return void alert("Please add some images/spritesheets!");i(15,q="Adding images: 0%"),i(14,R=0),F.showModal();const{GrowingPacker:e}=s,t=e.new(a,u.padding),n=Array.from(o.entries()).length+r.length;let c=0;ze((()=>{for(const e of o){const r=e[0],o=e[1][0];console.log("adding "+r+" to store!"),t.add_image_to_store(r,Fe(o,null)),c++,i(14,R=c/n),i(15,q=`Adding images: ${Math.round(100*R)}%`)}})),ze((async()=>{let e="";switch(u.prefixType){case"character-name":e=a+" ";break;case"custom-prefix":e=u.customPrefix+" "}for(const o of r){switch(o.type){case"single_frame":console.log("Reading single frame"+o.sprId);const n=await o.imgfileref.arrayBuffer();t.add_single_frame(new Uint8Array(n),e+o.animationPrefix,o.transform.newWidth,o.transform.newHeight,o.transform.flipX,o.transform.flipY,BigInt(o.frameRect.frameX),BigInt(o.frameRect.frameY),BigInt(o.frameRect.frameWidth),BigInt(o.frameRect.frameHeight));break;case"spritesheet_frame":console.log("Putting spritesheet frame"+o.sprId),ze((()=>{t.add_spritesheet_frame(o.spritesheetId,(u.usePrefixOnXMLFrames?e:"")+o.animationPrefix,o.rect.x,o.rect.y,o.rect.width,o.rect.height,o.transform.newWidth,o.transform.newHeight,o.transform.flipX,o.transform.flipY,BigInt(o.frameRect.frameX),BigInt(o.frameRect.frameY),BigInt(o.frameRect.frameWidth),BigInt(o.frameRect.frameHeight))}))}c++,i(14,R=c/n),i(15,q=`Adding images: ${Math.round(100*R)}%`)}ze((()=>{i(15,q="Generating spritesheet and XML...."),ze((()=>{Ve(t.make_packed_image(),a+".zip"),F.close()}))}))}))}return e.$$set=e=>{"wasm"in e&&i(29,s=e.wasm),"charname"in e&&i(30,a=e.charname),"rangeSelectionMode"in e&&i(28,c=e.rangeSelectionMode)},e.$$.update=()=>{1&e.$$.dirty[0]|1&e.$$.dirty[1]&&null!=k&&i(0,k.checked=r.length>0&&r.every((e=>e.selected))||!1,k)},[k,u,m,p,g,w,_,v,x,b,y,$,I,M,R,q,F,f,d,h,A,P,function(e,n){const i=function(e,{delay:n=0,duration:i=400,easing:r=t}={}){const o=+getComputedStyle(e).opacity;return{delay:n,duration:i,easing:r,css:e=>"opacity: "+e*o}}(e,n);return{duration:n.duration,css:i.css}},S,function(){for(let e=r.length-1;e>=0;e--){const t=r[e];if(t.selected&&(r.splice(e,1),"spritesheet_frame"===t.type)){const e=t.spritesheetId,[n,i]=o.get(e),r=i-1;r>0?Te.update((t=>(t.set(e,[n,r]),t))):Te.update((t=>(t.delete(e),t)))}}Be.set(r)},function(){for(let e=0;e<r.length;e++){const t=r[e];if(t.selected){const e=t.clone();e.selected=!1,e.sprId+="-copy"+Ge.getNewId(),Be.update((t=>[...t,e])),t.selected=!1}}},W,function(){i(28,c=!0),document.getElementById("sprite-frames").style.backgroundColor="#33333333"},c,s,a,r,function(e){Z[e?"unshift":"push"]((()=>{F=e,i(16,F)}))},async e=>{await d(0,b,y)||i(4,g=!1)},()=>{Oe(A,"image/png",!1)},()=>{Oe(P,"text/xml",!1)},function(e){g=e,i(4,g)},()=>{h($.value),i(5,w=!1)},function(e){Z[e?"unshift":"push"]((()=>{$=e,i(11,$)}))},function(e){w=e,i(5,w)},function(e){_=e,i(6,_)},function(e){u=e,i(1,u)},function(e){v=e,i(7,v)},function(e){x=e,i(8,x)},()=>{i(6,_=!0)},()=>{i(2,m=!m)},()=>{i(8,x=!0)},()=>{i(7,v=!0)},function(e){Z[e?"unshift":"push"]((()=>{I=e,i(12,I)}))},function(e){Z[e?"unshift":"push"]((()=>{k=e,i(0,k),i(31,r)}))},()=>{S(k.checked)},()=>{i(3,p=!p)},()=>{i(5,w=!0)},function(e){Z[e?"unshift":"push"]((()=>{M=e,i(13,M)}))},()=>{Oe(f,"image/png",!0)},()=>{i(4,g=!0)},()=>{W().then((()=>{}))}]}class jt extends Pe{constructor(e){super(),Ae(this,e,Nt,Yt,s,{wasm:29,charname:30,rangeSelectionMode:28},null,[-1,-1])}}function Ut(e,t,n){const i=e.slice();return i[10]=t[n],i[11]=t,i[12]=n,i}function zt(e,t){let n,i,r,o;function s(){return t[5](t[12])}function a(e){t[6](e,t[10],t[11],t[12])}let c={rangeSelectionMode:t[2],onRangeClick:s};return void 0!==t[10]&&(c.frameInfo=t[10]),i=new rt({props:c}),Z.push((()=>$e(i,"frameInfo",a))),{key:e,first:null,c(){n=C(""),ke(i.$$.fragment),this.first=n},m(e,t){k(e,n,t),Ie(i,e,t),o=!0},p(e,n){t=e;const o={};4&n&&(o.rangeSelectionMode=t[2]),8&n&&(o.onRangeClick=s),!r&&8&n&&(r=!0,o.frameInfo=t[10],ne((()=>r=!1))),i.$set(o)},i(e){o||(me(i.$$.fragment,e),o=!0)},o(e){pe(i.$$.fragment,e),o=!1},d(e){e&&I(n),Me(i,e)}}}function Gt(e){let t,n,i,r,o,s=[],a=new Map,c=e[3];const l=e=>e[10].sprId;for(let t=0;t<c.length;t+=1){let n=Ut(e,c,t),i=l(n);a.set(i,s[t]=zt(i,n))}function u(t){e[7](t)}let f={charname:e[1],wasm:e[0]};return void 0!==e[2]&&(f.rangeSelectionMode=e[2]),i=new jt({props:f}),Z.push((()=>$e(i,"rangeSelectionMode",u))),{c(){t=M("div");for(let e=0;e<s.length;e+=1)s[e].c();n=A(),ke(i.$$.fragment),q(t,"id","sprite-frames"),q(t,"class","svelte-8tybqo")},m(e,r){k(e,t,r);for(let e=0;e<s.length;e+=1)s[e]&&s[e].m(t,null);k(e,n,r),Ie(i,e,r),o=!0},p(e,[n]){28&n&&(c=e[3],de(),s=ye(s,n,l,1,e,c,a,t,be,zt,null,Ut),he());const o={};2&n&&(o.charname=e[1]),1&n&&(o.wasm=e[0]),!r&&4&n&&(r=!0,o.rangeSelectionMode=e[2],ne((()=>r=!1))),i.$set(o)},i(e){if(!o){for(let e=0;e<c.length;e+=1)me(s[e]);me(i.$$.fragment,e),o=!0}},o(e){for(let e=0;e<s.length;e+=1)pe(s[e]);pe(i.$$.fragment,e),o=!1},d(e){e&&I(t);for(let e=0;e<s.length;e+=1)s[e].d();e&&I(n),Me(i,e)}}}function Dt(e,t,n){let i;l(e,Be,(e=>n(3,i=e)));let{wasm:r}=t,{charname:o}=t,s=!1,a=null,c=null;function u(e){if(s){if(null===a)return void(a=e);if(null===c)return c=e,n(2,s=!1),document.getElementById("sprite-frames").style.backgroundColor=null,Be.update((e=>{let t,n;a<=c?(t=a,n=c):(t=c,n=a);for(let i=t;i<=n;i++)e[i].selected=!e[i].selected;return e})),a=null,void(c=null)}}return e.$$set=e=>{"wasm"in e&&n(0,r=e.wasm),"charname"in e&&n(1,o=e.charname)},[r,o,s,i,u,e=>{u(e)},function(e,t,n,r){n[r]=e,Be.set(i)},function(e){s=e,n(2,s)}]}class Zt extends Pe{constructor(e){super(),Ae(this,e,Dt,Gt,s,{wasm:0,charname:1})}}function Jt(e){let t,n,i;function r(t){e[6](t)}let o={wasm:e[0]};return void 0!==e[1]&&(o.charname=e[1]),t=new Ke({props:o}),Z.push((()=>$e(t,"charname",r))),{c(){ke(t.$$.fragment)},m(e,n){Ie(t,e,n),i=!0},p(e,i){const r={};1&i&&(r.wasm=e[0]),!n&&2&i&&(n=!0,r.charname=e[1],ne((()=>n=!1))),t.$set(r)},i(e){i||(me(t.$$.fragment,e),i=!0)},o(e){pe(t.$$.fragment,e),i=!1},d(e){Me(t,e)}}}function Kt(e){let t,n;return t=new Zt({props:{charname:e[1],wasm:e[0]}}),{c(){ke(t.$$.fragment)},m(e,i){Ie(t,e,i),n=!0},p(e,n){const i={};2&n&&(i.charname=e[1]),1&n&&(i.wasm=e[0]),t.$set(i)},i(e){n||(me(t.$$.fragment,e),n=!0)},o(e){pe(t.$$.fragment,e),n=!1},d(e){Me(t,e)}}}function Qt(e){let t,n,i,r,o,s,a,c,l,u,f,d,h,m,p,g,w,_,v,x,y;function $(t){e[4](t)}let C={id:"spsh",text:"Spritesheet Generation"};function S(t){e[5](t)}void 0!==e[2]&&(C.curChoice=e[2]),u=new qe({props:C}),Z.push((()=>$e(u,"curChoice",$)));let R={id:"icongrid",text:"Icongrid Generation"};void 0!==e[2]&&(R.curChoice=e[2]),h=new qe({props:R}),Z.push((()=>$e(h,"curChoice",S)));const F=[Kt,Jt],W=[];function X(e,t){return"spsh"==e[2]?0:"icongrid"==e[2]?1:-1}return~(w=X(e))&&(_=W[w]=F[w](e)),{c(){t=M("main"),n=M("h1"),n.textContent="FNF Spritesheet and XML Generator Web (experimental version)",i=A(),r=M("div"),o=M("label"),o.textContent="Character Name:",s=A(),a=M("input"),c=A(),l=M("div"),ke(u.$$.fragment),d=A(),ke(h.$$.fragment),p=A(),g=M("div"),_&&_.c(),q(n,"id","title"),q(n,"class","svelte-1p0njb9"),q(o,"for","char-name"),q(o,"class","svelte-1p0njb9"),q(a,"type","text"),q(a,"name","char-name"),q(a,"id","char-name"),q(r,"id","character-name-control"),q(r,"class","svelte-1p0njb9"),q(l,"id","app-tabs"),q(l,"class","svelte-1p0njb9"),q(g,"id","tab-container"),q(g,"class","svelte-1p0njb9")},m(f,m){k(f,t,m),b(t,n),b(t,i),b(t,r),b(r,o),b(r,s),b(r,a),E(a,e[1]),b(t,c),b(t,l),Ie(u,l,null),b(l,d),Ie(h,l,null),b(t,p),b(t,g),~w&&W[w].m(g,null),v=!0,x||(y=P(a,"input",e[3]),x=!0)},p(e,[t]){2&t&&a.value!==e[1]&&E(a,e[1]);const n={};!f&&4&t&&(f=!0,n.curChoice=e[2],ne((()=>f=!1))),u.$set(n);const i={};!m&&4&t&&(m=!0,i.curChoice=e[2],ne((()=>m=!1))),h.$set(i);let r=w;w=X(e),w===r?~w&&W[w].p(e,t):(_&&(de(),pe(W[r],1,1,(()=>{W[r]=null})),he()),~w?(_=W[w],_?_.p(e,t):(_=W[w]=F[w](e),_.c()),me(_,1),_.m(g,null)):_=null)},i(e){v||(me(u.$$.fragment,e),me(h.$$.fragment,e),me(_),v=!0)},o(e){pe(u.$$.fragment,e),pe(h.$$.fragment,e),pe(_),v=!1},d(e){e&&I(t),Me(u),Me(h),~w&&W[w].d(),x=!1,y()}}}function en(e,t,n){let i,{wasm:r}=t,o="spsh";return e.$$set=e=>{"wasm"in e&&n(0,r=e.wasm)},[r,i,o,function(){i=this.value,n(1,i)},function(e){o=e,n(2,o)},function(e){o=e,n(2,o)},function(e){i=e,n(1,i)}]}class tn extends Pe{constructor(e){super(),Ae(this,e,en,Qt,s,{wasm:0})}}let nn;const rn=new Array(128).fill(void 0);function on(e){return rn[e]}rn.push(void 0,null,!0,!1);let sn=0,an=null;function cn(){return null!==an&&0!==an.byteLength||(an=new Uint8Array(nn.memory.buffer)),an}const ln=new TextEncoder("utf-8"),un="function"==typeof ln.encodeInto?function(e,t){return ln.encodeInto(e,t)}:function(e,t){const n=ln.encode(e);return t.set(n),{read:e.length,written:n.length}};function fn(e,t,n){if(void 0===n){const n=ln.encode(e),i=t(n.length);return cn().subarray(i,i+n.length).set(n),sn=n.length,i}let i=e.length,r=t(i);const o=cn();let s=0;for(;s<i;s++){const t=e.charCodeAt(s);if(t>127)break;o[r+s]=t}if(s!==i){0!==s&&(e=e.slice(s)),r=n(r,i,i=s+3*e.length);const t=cn().subarray(r+s,r+i);s+=un(e,t).written}return sn=s,r}let dn=null;function hn(){return null!==dn&&0!==dn.byteLength||(dn=new Int32Array(nn.memory.buffer)),dn}let mn=rn.length;function pn(e){const t=on(e);return function(e){e<132||(rn[e]=mn,mn=e)}(e),t}const gn=new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0});function wn(e,t){return gn.decode(cn().subarray(e,e+t))}function _n(e){mn===rn.length&&rn.push(rn.length+1);const t=mn;return mn=rn[t],rn[t]=e,t}function vn(e,t){const n=t(1*e.length);return cn().set(e,n/1),sn=e.length,n}function xn(e,t){return cn().subarray(e/1,e/1+t)}gn.decode();class bn{static __wrap(e){const t=Object.create(bn.prototype);return t.ptr=e,t}__destroy_into_raw(){const e=this.ptr;return this.ptr=0,e}free(){const e=this.__destroy_into_raw();nn.__wbg_growingpacker_free(e)}static new(e,t){const n=fn(e,nn.__wbindgen_malloc,nn.__wbindgen_realloc),i=sn,r=nn.growingpacker_new(n,i,t);return bn.__wrap(r)}add_image_to_store(e,t){const n=fn(e,nn.__wbindgen_malloc,nn.__wbindgen_realloc),i=sn,r=vn(t,nn.__wbindgen_malloc),o=sn;nn.growingpacker_add_image_to_store(this.ptr,n,i,r,o)}add_single_frame(e,t,n,i,r,o,s,a,c,l){const u=vn(e,nn.__wbindgen_malloc),f=sn,d=fn(t,nn.__wbindgen_malloc,nn.__wbindgen_realloc),h=sn;nn.growingpacker_add_single_frame(this.ptr,u,f,d,h,n,i,r,o,s,a,c,l)}add_spritesheet_frame(e,t,n,i,r,o,s,a,c,l,u,f,d,h){const m=fn(e,nn.__wbindgen_malloc,nn.__wbindgen_realloc),p=sn,g=fn(t,nn.__wbindgen_malloc,nn.__wbindgen_realloc),w=sn;nn.growingpacker_add_spritesheet_frame(this.ptr,m,p,g,w,n,i,r,o,s,a,c,l,u,f,d,h)}make_packed_image(){try{const i=nn.__wbindgen_add_to_stack_pointer(-16);nn.growingpacker_make_packed_image(i,this.ptr);var e=hn()[i/4+0],t=hn()[i/4+1],n=xn(e,t).slice();return nn.__wbindgen_free(e,1*t),n}finally{nn.__wbindgen_add_to_stack_pointer(16)}}}class yn{static __wrap(e){const t=Object.create(yn.prototype);return t.ptr=e,t}__destroy_into_raw(){const e=this.ptr;return this.ptr=0,e}free(){const e=this.__destroy_into_raw();nn.__wbg_iconpacker_free(e)}static new(){const e=nn.iconpacker_new();return yn.__wrap(e)}add_image(e){nn.iconpacker_add_image(this.ptr,_n(e))}make_packed_image(){try{const i=nn.__wbindgen_add_to_stack_pointer(-16);nn.iconpacker_make_packed_image(i,this.ptr);var e=hn()[i/4+0],t=hn()[i/4+1],n=xn(e,t).slice();return nn.__wbindgen_free(e,1*t),n}finally{nn.__wbindgen_add_to_stack_pointer(16)}}}function $n(){const e={wbg:{}};return e.wbg.__wbindgen_string_get=function(e,t){const n=on(t),i="string"==typeof n?n:void 0;var r=null==i?0:fn(i,nn.__wbindgen_malloc,nn.__wbindgen_realloc),o=sn;hn()[e/4+1]=o,hn()[e/4+0]=r},e.wbg.__wbindgen_object_drop_ref=function(e){pn(e)},e.wbg.__wbg_new_abda76e883ba8a5f=function(){return _n(new Error)},e.wbg.__wbg_stack_658279fe44541cf6=function(e,t){const n=fn(on(t).stack,nn.__wbindgen_malloc,nn.__wbindgen_realloc),i=sn;hn()[e/4+1]=i,hn()[e/4+0]=n},e.wbg.__wbg_error_f851667af71bcfc6=function(e,t){try{console.error(wn(e,t))}finally{nn.__wbindgen_free(e,t)}},e.wbg.__wbg_get_27fe3dac1c4d0224=function(e,t){return _n(on(e)[t>>>0])},e.wbg.__wbg_length_e498fbc24f9c1d4f=function(e){return on(e).length},e.wbg.__wbg_buffer_cf65c07de34b9a08=function(e){return _n(on(e).buffer)},e.wbg.__wbg_new_537b7341ce90bb31=function(e){return _n(new Uint8Array(on(e)))},e.wbg.__wbg_set_17499e8aa4003ebd=function(e,t,n){on(e).set(on(t),n>>>0)},e.wbg.__wbg_length_27a2afe8ab42b09f=function(e){return on(e).length},e.wbg.__wbindgen_throw=function(e,t){throw new Error(wn(e,t))},e.wbg.__wbindgen_memory=function(){return _n(nn.memory)},e}function kn(e,t){return nn=e.exports,In.__wbindgen_wasm_module=t,dn=null,an=null,nn}async function In(e){const t=$n();("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:i}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if("application/wasm"==e.headers.get("Content-Type"))throw t;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}(await e,t);return kn(n,i)}var Mn=Object.freeze({__proto__:null,GrowingPacker:bn,IconPacker:yn,default:In,initSync:function(e){const t=$n();return e instanceof WebAssembly.Module||(e=new WebAssembly.Module(e)),kn(new WebAssembly.Instance(e,t),e)},init_panic_hook:function(){nn.init_panic_hook()},make_icongrid_legacy:function(e,t){try{const o=nn.__wbindgen_add_to_stack_pointer(-16),s=vn(e,nn.__wbindgen_malloc),a=sn;nn.make_icongrid_legacy(o,s,a,_n(t));var n=hn()[o/4+0],i=hn()[o/4+1],r=xn(n,i).slice();return nn.__wbindgen_free(n,1*i),r}finally{nn.__wbindgen_add_to_stack_pointer(16)}}});return(async()=>{const e=await(async(e={})=>{let{importHook:t,serverPath:n}=e,i="./build/assets/rust_img_lib-e24a149b.wasm";return null!=n&&(i=n+/[^\/\\]*$/.exec(i)[0]),null!=t&&(i=t(i)),await In(i),Mn})();e.init_panic_hook();return new tn({target:document.body,props:{wasm:e}})})()}();
//# sourceMappingURL=bundle.js.map
