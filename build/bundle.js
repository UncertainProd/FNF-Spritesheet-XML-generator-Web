var app=function(){"use strict";function e(){}const t=e=>e;function n(e){return e()}function i(){return Object.create(null)}function r(e){e.forEach(n)}function s(e){return"function"==typeof e}function o(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}let a;function c(t,...n){if(null==t)return e;const i=t.subscribe(...n);return i.unsubscribe?()=>i.unsubscribe():i}function l(e,t,n){e.$$.on_destroy.push(c(t,n))}function u(e,t,n,i){if(e){const r=f(e,t,n,i);return e[0](r)}}function f(e,t,n,i){return e[1]&&i?function(e,t){for(const n in t)e[n]=t[n];return e}(n.ctx.slice(),e[1](i(t))):n.ctx}function d(e,t,n,i){if(e[2]&&i){const r=e[2](i(n));if(void 0===t.dirty)return r;if("object"==typeof r){const e=[],n=Math.max(t.dirty.length,r.length);for(let i=0;i<n;i+=1)e[i]=t.dirty[i]|r[i];return e}return t.dirty|r}return t.dirty}function h(e,t,n,i,r,s){if(r){const o=f(t,n,i,s);e.p(o,r)}}function m(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let e=0;e<n;e++)t[e]=-1;return t}return-1}const p="undefined"!=typeof window;let g=p?()=>window.performance.now():()=>Date.now(),w=p?e=>requestAnimationFrame(e):e;const _=new Set;function v(e){_.forEach((t=>{t.c(e)||(_.delete(t),t.f())})),0!==_.size&&w(v)}function x(e){let t;return 0===_.size&&w(v),{promise:new Promise((n=>{_.add(t={c:e,f:n})})),abort(){_.delete(t)}}}function b(e,t){e.appendChild(t)}function y(e){if(!e)return document;const t=e.getRootNode?e.getRootNode():e.ownerDocument;return t&&t.host?t:e.ownerDocument}function $(e){const t=C("style");return function(e,t){b(e.head||e,t),t.sheet}(y(e),t),t.sheet}function k(e,t,n){e.insertBefore(t,n||null)}function I(e){e.parentNode&&e.parentNode.removeChild(e)}function C(e){return document.createElement(e)}function A(e){return document.createTextNode(e)}function M(){return A(" ")}function P(e,t,n,i){return e.addEventListener(t,n,i),()=>e.removeEventListener(t,n,i)}function q(e){return function(t){return t.stopPropagation(),e.call(this,t)}}function R(e){return function(t){t.target===this&&e.call(this,t)}}function S(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function F(e){let t;return{p(...n){t=n,t.forEach((t=>e.push(t)))},r(){t.forEach((t=>e.splice(e.indexOf(t),1)))}}}function W(e){return""===e?null:+e}function E(e,t){t=""+t,e.data!==t&&(e.data=t)}function X(e,t){e.value=null==t?"":t}function H(e,t,n,i){null===n?e.style.removeProperty(t):e.style.setProperty(t,n,i?"important":"")}function T(e,t,n){for(let n=0;n<e.options.length;n+=1){const i=e.options[n];if(i.__value===t)return void(i.selected=!0)}n&&void 0===t||(e.selectedIndex=-1)}const L=new Map;let B,O=0;function V(e,t,n,i,r,s,o,a=0){const c=16.666/i;let l="{\n";for(let e=0;e<=1;e+=c){const i=t+(n-t)*s(e);l+=100*e+`%{${o(i,1-i)}}\n`}const u=l+`100% {${o(n,1-n)}}\n}`,f=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(u)}_${a}`,d=y(e),{stylesheet:h,rules:m}=L.get(d)||function(e,t){const n={stylesheet:$(t),rules:{}};return L.set(e,n),n}(d,e);m[f]||(m[f]=!0,h.insertRule(`@keyframes ${f} ${u}`,h.cssRules.length));const p=e.style.animation||"";return e.style.animation=`${p?`${p}, `:""}${f} ${i}ms linear ${r}ms 1 both`,O+=1,f}function Y(e,t){const n=(e.style.animation||"").split(", "),i=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),r=n.length-i.length;r&&(e.style.animation=i.join(", "),O-=r,O||w((()=>{O||(L.forEach((e=>{const{ownerNode:t}=e.stylesheet;t&&I(t)})),L.clear())})))}function N(e){B=e}function j(){if(!B)throw new Error("Function called outside component initialization");return B}function U(e){j().$$.on_mount.push(e)}function D(e){j().$$.on_destroy.push(e)}function z(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach((e=>e.call(this,t)))}const G=[],Z=[];let J=[];const K=[],Q=Promise.resolve();let ee=!1;function te(e){J.push(e)}function ne(e){K.push(e)}const ie=new Set;let re,se=0;function oe(){if(0!==se)return;const e=B;do{try{for(;se<G.length;){const e=G[se];se++,N(e),ae(e.$$)}}catch(e){throw G.length=0,se=0,e}for(N(null),G.length=0,se=0;Z.length;)Z.pop()();for(let e=0;e<J.length;e+=1){const t=J[e];ie.has(t)||(ie.add(t),t())}J.length=0}while(G.length);for(;K.length;)K.pop()();ee=!1,ie.clear(),N(e)}function ae(e){if(null!==e.fragment){e.update(),r(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(te)}}function ce(){return re||(re=Promise.resolve(),re.then((()=>{re=null}))),re}function le(e,t,n){e.dispatchEvent(function(e,t,{bubbles:n=!1,cancelable:i=!1}={}){const r=document.createEvent("CustomEvent");return r.initCustomEvent(e,n,i,t),r}(`${t?"intro":"outro"}${n}`))}const ue=new Set;let fe;function de(){fe={r:0,c:[],p:fe}}function he(){fe.r||r(fe.c),fe=fe.p}function me(e,t){e&&e.i&&(ue.delete(e),e.i(t))}function pe(e,t,n,i){if(e&&e.o){if(ue.has(e))return;ue.add(e),fe.c.push((()=>{ue.delete(e),i&&(n&&e.d(1),i())})),e.o(t)}else i&&i()}const ge={duration:0};function we(n,i,r){const o={direction:"in"};let a,c,l=i(n,r,o),u=!1,f=0;function d(){a&&Y(n,a)}function h(){const{delay:i=0,duration:r=300,easing:s=t,tick:o=e,css:h}=l||ge;h&&(a=V(n,0,1,r,i,s,h,f++)),o(0,1);const m=g()+i,p=m+r;c&&c.abort(),u=!0,te((()=>le(n,!0,"start"))),c=x((e=>{if(u){if(e>=p)return o(1,0),le(n,!0,"end"),d(),u=!1;if(e>=m){const t=s((e-m)/r);o(t,1-t)}}return u}))}let m=!1;return{start(){m||(m=!0,Y(n),s(l)?(l=l(o),ce().then(h)):h())},invalidate(){m=!1},end(){u&&(d(),u=!1)}}}function _e(n,i,o){const a={direction:"out"};let c,l=i(n,o,a),u=!0;const f=fe;function d(){const{delay:i=0,duration:s=300,easing:o=t,tick:a=e,css:d}=l||ge;d&&(c=V(n,1,0,s,i,o,d));const h=g()+i,m=h+s;te((()=>le(n,!1,"start"))),x((e=>{if(u){if(e>=m)return a(0,1),le(n,!1,"end"),--f.r||r(f.c),!1;if(e>=h){const t=o((e-h)/s);a(1-t,t)}}return u}))}return f.r+=1,s(l)?ce().then((()=>{l=l(a),d()})):d(),{end(e){e&&l.tick&&l.tick(1,0),u&&(c&&Y(n,c),u=!1)}}}const ve="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function xe(e,t){e.d(1),t.delete(e.key)}function be(e,t){pe(e,1,1,(()=>{t.delete(e.key)}))}function ye(e,t,n,i,s,o,a,c,l,u,f,d){let h=e.length,m=o.length,p=h;const g={};for(;p--;)g[e[p].key]=p;const w=[],_=new Map,v=new Map,x=[];for(p=m;p--;){const e=d(s,o,p),r=n(e);let c=a.get(r);c?i&&x.push((()=>c.p(e,t))):(c=u(r,e),c.c()),_.set(r,w[p]=c),r in g&&v.set(r,Math.abs(p-g[r]))}const b=new Set,y=new Set;function $(e){me(e,1),e.m(c,f),a.set(e.key,e),f=e.first,m--}for(;h&&m;){const t=w[m-1],n=e[h-1],i=t.key,r=n.key;t===n?(f=t.first,h--,m--):_.has(r)?!a.has(i)||b.has(i)?$(t):y.has(r)?h--:v.get(i)>v.get(r)?(y.add(i),$(t)):(b.add(r),h--):(l(n,a),h--)}for(;h--;){const t=e[h];_.has(t.key)||l(t,a)}for(;m;)$(w[m-1]);return r(x),w}function $e(e,t,n){const i=e.$$.props[t];void 0!==i&&(e.$$.bound[i]=n,n(e.$$.ctx[i]))}function ke(e){e&&e.c()}function Ie(e,t,i,o){const{fragment:a,after_update:c}=e.$$;a&&a.m(t,i),o||te((()=>{const t=e.$$.on_mount.map(n).filter(s);e.$$.on_destroy?e.$$.on_destroy.push(...t):r(t),e.$$.on_mount=[]})),c.forEach(te)}function Ce(e,t){const n=e.$$;null!==n.fragment&&(!function(e){const t=[],n=[];J.forEach((i=>-1===e.indexOf(i)?t.push(i):n.push(i))),n.forEach((e=>e())),J=t}(n.after_update),r(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function Ae(e,t){-1===e.$$.dirty[0]&&(G.push(e),ee||(ee=!0,Q.then(oe)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function Me(t,n,s,o,a,c,l,u=[-1]){const f=B;N(t);const d=t.$$={fragment:null,ctx:[],props:c,update:e,not_equal:a,bound:i(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(n.context||(f?f.$$.context:[])),callbacks:i(),dirty:u,skip_bound:!1,root:n.target||f.$$.root};l&&l(d.root);let h=!1;if(d.ctx=s?s(t,n.props||{},((e,n,...i)=>{const r=i.length?i[0]:n;return d.ctx&&a(d.ctx[e],d.ctx[e]=r)&&(!d.skip_bound&&d.bound[e]&&d.bound[e](r),h&&Ae(t,e)),n})):[],d.update(),h=!0,r(d.before_update),d.fragment=!!o&&o(d.ctx),n.target){if(n.hydrate){const e=function(e){return Array.from(e.childNodes)}(n.target);d.fragment&&d.fragment.l(e),e.forEach(I)}else d.fragment&&d.fragment.c();n.intro&&me(t.$$.fragment),Ie(t,n.target,n.anchor,n.customElement),oe()}N(f)}class Pe{$destroy(){Ce(this,1),this.$destroy=e}$on(t,n){if(!s(n))return e;const i=this.$$.callbacks[t]||(this.$$.callbacks[t]=[]);return i.push(n),()=>{const e=i.indexOf(n);-1!==e&&i.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function qe(t){let n,i,r,s,o,a,c,l,u,f=!1;return c=F(t[4][0]),{c(){n=C("label"),i=C("input"),s=M(),o=A(t[2]),S(i,"type","radio"),S(i,"name","app-choice"),S(i,"id",r="tab-"+t[1]),i.__value=t[1],i.value=i.__value,H(i,"display","none"),S(i,"class","svelte-1f39crp"),S(n,"for",a="tab-"+t[1]),S(n,"class","tabs svelte-1f39crp"),H(n,"background-color",t[0]==t[1]?"blue":"white"),c.p(i)},m(e,r){k(e,n,r),b(n,i),i.checked=i.__value===t[0],b(n,s),b(n,o),l||(u=P(i,"change",t[3]),l=!0)},p(e,[t]){2&t&&r!==(r="tab-"+e[1])&&S(i,"id",r),2&t&&(i.__value=e[1],i.value=i.__value,f=!0),(f||1&t)&&(i.checked=i.__value===e[0]),4&t&&E(o,e[2]),2&t&&a!==(a="tab-"+e[1])&&S(n,"for",a),3&t&&H(n,"background-color",e[0]==e[1]?"blue":"white")},i:e,o:e,d(e){e&&I(n),c.r(),l=!1,u()}}}function Re(e,t,n){let{id:i}=t,{curChoice:r}=t,{text:s}=t;return e.$$set=e=>{"id"in e&&n(1,i=e.id),"curChoice"in e&&n(0,r=e.curChoice),"text"in e&&n(2,s=e.text)},[r,i,s,function(){r=this.__value,n(0,r)},[[]]]}class Se extends Pe{constructor(e){super(),Me(this,e,Re,qe,o,{id:1,curChoice:0,text:2})}}function Fe(e,t){const n=e.replace(/[^A-Za-z0-9+/]/g,""),i=n.length,r=t?Math.ceil((3*i+1>>2)/t)*t:3*i+1>>2,s=new Uint8Array(r);let o,a,c=0,l=0;for(let e=0;e<i;e++)if(a=3&e,c|=((u=n.charCodeAt(e))>64&&u<91?u-65:u>96&&u<123?u-71:u>47&&u<58?u+4:43===u?62:47===u?63:0)<<6*(3-a),3===a||i-e==1){for(o=0;o<3&&l<r;)s[l]=c>>>(16>>>o&24)&255,o++,l++;c=0}var u;return s}function We(e){return e<26?e+65:e<52?e+71:e<62?e-4:62===e?43:63===e?47:65}function Ee(e){let t=2,n="";const i=e.length;let r=0;for(let s=0;s<i;s++)t=s%3,r|=e[s]<<(16>>>t&24),2!==t&&e.length-s!=1||(n+=String.fromCodePoint(We(r>>>18&63),We(r>>>12&63),We(r>>>6&63),We(63&r)),r=0);return n.substring(0,n.length-2+t)+(2===t?"":1===t?"=":"==")}function Xe(e){return Ee(new Uint8Array(e))}const He=[];function Te(t,n=e){let i;const r=new Set;function s(e){if(o(t,e)&&(t=e,i)){const e=!He.length;for(const e of r)e[1](),He.push(e,t);if(e){for(let e=0;e<He.length;e+=2)He[e][0](He[e+1]);He.length=0}}}return{set:s,update:function(e){s(e(t))},subscribe:function(o,a=e){const c=[o,a];return r.add(c),1===r.size&&(i=n(s)||e),o(t),()=>{r.delete(c),0===r.size&&i&&(i(),i=null)}}}}const Le=Te([]),Be=Te(new Map);function Oe(e,t,n=!0){let i=document.createElement("input");i.setAttribute("type","file"),n&&i.setAttribute("multiple","true"),i.setAttribute("style","display: none"),i.setAttribute("accept",t),document.body.append(i),i.onchange=t=>{e(t),document.body.removeChild(i)},i.click()}function Ve(e,t){let n=new Blob([e]),i=URL.createObjectURL(n),r=document.createElement("a");r.setAttribute("href",i),r.setAttribute("download",t),r.click()}function Ye(e,t,n=!1){if(n){for(let n=e.length-1;n>=0;n--)if(t(e[n]))return n}else for(let n=0;n<e.length;n++)if(t(e[n]))return n;return null}async function Ne(e){let t;if("single_frame"==e.type){let n=e.imgfileref;t="data:image/png;base64,"+Ee(new Uint8Array(await n.arrayBuffer()))}else{const n=function(e){let t;return c(e,(e=>t=e))(),t}(Be).get(e.spritesheetId);t=void 0!==n?"data:image/png;base64,"+n[0]:"data:image/png;base64,"}const n=new Image;return n.src=t,await n.decode(),n}async function je(e){const t="data:image/png;base64,"+Xe(await e.arrayBuffer()),n=new Image;return n.src=t,await n.decode(),[n.naturalWidth,n.naturalHeight]}function Ue(e){return!(!e||e.length>255)&&(!/[<>:"/\\|?*\u0000-\u001F]/g.test(e)&&!/^(con|prn|aux|nul|com\d|lpt\d)$/i.test(e)&&("."!==e&&".."!==e))}function De(e,t=0){setTimeout(e,t)}const ze=new class{constructor(){this._val=-1}getNewId(){return this._val++,this._val}};function Ge(t){let n,i,s,o,a;return{c(){n=C("button"),n.textContent="Add Icongrid",i=M(),s=C("button"),s.textContent="Clear Icongrid",S(n,"id","add-icongrid"),S(n,"class","svelte-1omodga"),S(s,"id","clear-icongrid"),S(s,"class","svelte-1omodga")},m(e,r){k(e,n,r),k(e,i,r),k(e,s,r),o||(a=[P(n,"click",t[15]),P(s,"click",t[16])],o=!0)},p:e,d(e){e&&I(n),e&&I(i),e&&I(s),o=!1,r(a)}}}function Ze(t){let n,i,s,o,c,l,u,f,d,h,m,p,g,w,_,v,x,y,$,q,R,F,W,X,T=t[1].length+"",L=t[0]&&Ge(t);return{c(){var e,r;n=C("dialog"),n.innerHTML="<p>Creating Icongrid....</p>",i=M(),s=C("div"),o=C("img"),u=M(),f=C("div"),d=C("label"),h=C("input"),m=A("\r\n        Legacy Mode"),p=M(),g=C("p"),w=A("Number of icons selected: "),_=A(T),v=M(),x=C("button"),x.textContent="Clear Icons",y=M(),L&&L.c(),$=M(),q=C("button"),q.textContent="Add Icons",R=M(),F=C("button"),F.textContent="Generate Icongrid",e=o.src,r=c="",a||(a=document.createElement("a")),a.href=r,e!==a.href&&S(o,"src",""),S(o,"alt",l="The "+(t[0]?"":"final")+" icongrid will be displayed here."),S(s,"id","preview-div"),S(s,"class","svelte-1omodga"),S(h,"type","checkbox"),S(h,"name","legacy-mode"),S(h,"id","legacy-mode"),S(h,"class","svelte-1omodga"),S(d,"for","legacy-mode"),S(d,"id","legacy-mode-label"),S(d,"class","svelte-1omodga"),S(g,"class","svelte-1omodga"),S(x,"class","svelte-1omodga"),S(q,"id","add-icons"),S(q,"class","svelte-1omodga"),S(F,"id","generate-grid"),S(F,"class","svelte-1omodga"),S(f,"id","controls"),H(f,"grid-template-columns",t[5]),S(f,"class","svelte-1omodga")},m(e,r){k(e,n,r),t[12](n),k(e,i,r),k(e,s,r),b(s,o),t[13](o),k(e,u,r),k(e,f,r),b(f,d),b(d,h),h.checked=t[0],b(d,m),b(f,p),b(f,g),b(g,w),b(g,_),b(f,v),b(f,x),b(f,y),L&&L.m(f,null),b(f,$),b(f,q),b(f,R),b(f,F),W||(X=[P(h,"change",t[14]),P(x,"click",t[8]),P(q,"click",t[17]),P(F,"click",t[6])],W=!0)},p(e,[t]){1&t&&l!==(l="The "+(e[0]?"":"final")+" icongrid will be displayed here.")&&S(o,"alt",l),1&t&&(h.checked=e[0]),2&t&&T!==(T=e[1].length+"")&&E(_,T),e[0]?L?L.p(e,t):(L=Ge(e),L.c(),L.m(f,$)):L&&(L.d(1),L=null),32&t&&H(f,"grid-template-columns",e[5])},i:e,o:e,d(e){e&&I(n),t[12](null),e&&I(i),e&&I(s),t[13](null),e&&I(u),e&&I(f),L&&L.d(),W=!1,r(X)}}}function Je(e,t,n){let i,{wasm:r}=t,{charname:s}=t,o=!1,a=[],c=null,l=null,u=null;async function f(e){n(4,u=e.target.files[0]),c.setAttribute("src","data:image/png;base64,"+Xe(await u.arrayBuffer()))}function d(e){n(1,a=[])}function h(e){n(1,a=[...e.target.files])}D((()=>{document.removeEventListener("clearIcons",d)})),document.addEventListener("clearIcons",d);return e.$$set=e=>{"wasm"in e&&n(10,r=e.wasm),"charname"in e&&n(11,s=e.charname)},e.$$.update=()=>{1&e.$$.dirty&&n(5,i="2fr"+(o?" 1fr 1fr":"")+" 1fr 1fr 1fr 2fr")},[o,a,c,l,u,i,async function(){if(o)if(a.length>0)if(null!==u){l.showModal();const e=new Uint8Array(await u.arrayBuffer()),t=[];for(let e of a)t.push(Xe(await e.arrayBuffer()));const n=r.make_icongrid_legacy(e,t);c.setAttribute("src","data:image/png;base64,"+Ee(n)),l.close(),Ve(n,"iconGrid.png")}else alert("No Icongrid selected! Please select an icongrid");else alert("No icons selected! Please select some icons");else{const{IconPacker:e}=r,t=e.new();if(a.length>0){l.showModal();for(let e of a)t.add_image(await e.arrayBuffer());let e=t.make_packed_image();c.setAttribute("src","data:image/png;base64,"+Ee(e)),l.close(),Ve(e,`icon-${void 0!==s?s:"character"}.png`)}else alert("No icons selected! Please select some icons")}},f,d,h,r,s,function(e){Z[e?"unshift":"push"]((()=>{l=e,n(3,l)}))},function(e){Z[e?"unshift":"push"]((()=>{c=e,n(2,c)}))},function(){o=this.checked,n(0,o)},e=>Oe(f,"image/png",!1),()=>{n(4,u=null)},e=>Oe(h,"image/png")]}class Ke extends Pe{constructor(e){super(),Me(this,e,Je,Ze,o,{wasm:10,charname:11})}}class Qe{constructor(e){this.context=e,this.curFrames=[],this.curImgs=[],this.curFrameIndex=0,this.start=null,this.prev=null,this.ticks=0,this.animId=null,this.fps=24,this.animationScale=1,this.isPlaying=!1}resetAnimation(){this.curFrames=[],this.curImgs=[],this.curFrameIndex=0,this.start=null,this.prev=null,this.ticks=0}tick(e){this.start=e,null===this.prev&&(this.prev=e);const t=this.start-this.prev;if(this.ticks+=t,this.ticks>1e3/this.fps){const e=this.curFrames[this.curFrameIndex],t=this.curImgs[this.curFrameIndex];this.curFrameIndex=(this.curFrameIndex+1)%this.curFrames.length,this.clearCanvas(),this.drawImage(t,e),this.ticks=0}this.animId=requestAnimationFrame((e=>{this.tick(e)})),this.prev=this.start}drawImage(e,t,n=!1,i=!1){const r=t.rect,s=t.frameRect,o=t.transform,a=o.flipX?-1:1,c=o.flipY?-1:1,l=a*this.animationScale,u=c*this.animationScale;this.context.save(),this.context.scale(l,u),o.flipX&&this.context.translate(-o.newWidth,0),o.flipY&&this.context.translate(0,-o.newHeight),this.context.drawImage(e,r.x,r.y,r.width,r.height,-s.frameX*a,-s.frameY*c,o.newWidth,o.newHeight),this.context.restore(),i&&(this.context.clearRect(s.frameWidth*this.animationScale,0,this.context.canvas.width,this.context.canvas.height),this.context.clearRect(0,s.frameHeight*this.animationScale,this.context.canvas.width,this.context.canvas.height)),n&&(this.context.beginPath(),this.context.rect(0,0,s.frameWidth*this.animationScale,s.frameHeight*this.animationScale),this.context.stroke())}async initFrames(e){this.curFrames=e,this.curFrameIndex=0,this.curImgs=await Promise.all(this.curFrames.map((async e=>await Ne(e))))}play(){this.animId=requestAnimationFrame((e=>{this.tick(e)})),this.isPlaying=!0}stopAnimation(){null!==this.animId&&cancelAnimationFrame(this.animId),this.resetAnimation(),this.animId=null,this.isPlaying=!1}clearCanvas(){const e=this.context.canvas.width,t=this.context.canvas.height;this.context.clearRect(0,0,e,t)}}function et(t){let n;return{c(){n=C("div"),H(n,"width",nt),H(n,"height",nt+"px")},m(e,t){k(e,n,t)},p:e,d(e){e&&I(n)}}}function tt(t){let n,i,s,o,a,c,l,u,f,d,h,m,p,g,w=t[0].animationPrefix+"",_=!t[1]&&et();return{c(){n=C("div"),i=C("input"),o=M(),a=C("canvas"),c=A("Rendering Error!\r\n        Please use a browser that supports canvas rendering! (like Chrome or Firefox)"),l=M(),_&&_.c(),u=M(),f=C("p"),d=A(w),h=M(),m=C("button"),m.textContent="Delete",S(i,"type","checkbox"),S(i,"name","selected-chkbox"),S(i,"id","selected-chkbox"),i.checked=s=t[0].selected,H(a,"display",t[1]?"block":"none"),S(a,"width",nt+"px"),S(a,"height",nt+"px"),S(n,"class","frame-container svelte-o46j4u"),H(n,"width",nt+"px")},m(e,r){k(e,n,r),b(n,i),b(n,o),b(n,a),b(a,c),t[6](a),b(n,l),_&&_.m(n,null),b(n,u),b(n,f),b(f,d),b(n,h),b(n,m),t[8](n),p||(g=[P(m,"click",q(t[7])),P(n,"click",t[4])],p=!0)},p(e,[t]){1&t&&s!==(s=e[0].selected)&&(i.checked=s),2&t&&H(a,"display",e[1]?"block":"none"),e[1]?_&&(_.d(1),_=null):_?_.p(e,t):(_=et(),_.c(),_.m(n,u)),1&t&&w!==(w=e[0].animationPrefix+"")&&E(d,w)},i:e,o:e,d(e){e&&I(n),t[6](null),_&&_.d(),t[8](null),p=!1,r(g)}}}let nt=120;function it(e,t,n){let i,r,s,o;l(e,Be,(e=>n(10,i=e))),l(e,Le,(e=>n(11,r=e)));let a,{frameInfo:c}=t,u=!1;async function f(){await a.initFrames([c]),a.clearCanvas(),a.animationScale=nt/Math.max(c.frameRect.frameWidth,c.frameRect.frameHeight),a.drawImage(a.curImgs[0],c,!1),n(1,u=!0)}function d(e){const t=r.indexOf(e);if(-1!==t){if(r.splice(t,1),Le.set(r),"spritesheet_frame"===c.type){const e=c.spritesheetId,[t,n]=i.get(e),r=n-1;r>0?Be.update((n=>(n.set(e,[t,r]),n))):Be.update((t=>(t.delete(e),t)))}}else console.log("[ERROR] Could not find element: "+e)}U((()=>{new IntersectionObserver((async(e,t)=>{const i=e[0];i.isIntersecting&&i.intersectionRatio>=.2?u||await f():n(1,u=!1)}),{root:document.getElementById("sprite-frames"),rootMargin:"0px",threshold:[.1,.2]}).observe(o),a=new Qe(s.getContext("2d"))}));return e.$$set=e=>{"frameInfo"in e&&n(0,c=e.frameInfo)},e.$$.update=()=>{3&e.$$.dirty&&u&&c._changed&&(f().then((()=>{})),n(0,c._changed=!1,c))},[c,u,s,o,function(){n(0,c.selected=!c.selected,c)},d,function(e){Z[e?"unshift":"push"]((()=>{s=e,n(2,s)}))},()=>{d(c)},function(e){Z[e?"unshift":"push"]((()=>{o=e,n(3,o)}))}]}class rt extends Pe{constructor(e){super(),Me(this,e,it,tt,o,{frameInfo:0})}}function st(e){return(e/=.5)<1?.5*e*e:-.5*(--e*(e-2)-1)}const ot=e=>({}),at=e=>({}),ct=e=>({}),lt=e=>({});function ut(e){let t,n,i,s,o,a,c,l,f,p,g,w,_,v,x,y;const $=e[5].header,F=u($,e,e[4],lt),W=e[5].default,X=u(W,e,e[4],null),H=e[5]["accept-btn"],T=u(H,e,e[4],at);return{c(){t=C("dialog"),n=C("div"),F&&F.c(),i=M(),s=C("hr"),o=M(),X&&X.c(),a=M(),c=C("hr"),l=M(),T&&T.c(),f=M(),p=C("hr"),g=M(),w=C("button"),_=A(e[2]),w.autofocus=!0,S(w,"class","svelte-1ed8403"),S(n,"class","svelte-1ed8403"),S(t,"class","svelte-1ed8403")},m(r,u){k(r,t,u),b(t,n),F&&F.m(n,null),b(n,i),b(n,s),b(n,o),X&&X.m(n,null),b(n,a),b(n,c),b(n,l),T&&T.m(n,null),b(n,f),b(n,p),b(n,g),b(n,w),b(w,_),e[8](t),v=!0,w.focus(),x||(y=[P(w,"click",e[7]),P(n,"click",q(e[6])),P(t,"close",e[9]),P(t,"click",R(e[10]))],x=!0)},p(e,[t]){F&&F.p&&(!v||16&t)&&h(F,$,e,e[4],v?d($,e[4],t,ct):m(e[4]),lt),X&&X.p&&(!v||16&t)&&h(X,W,e,e[4],v?d(W,e[4],t,null):m(e[4]),null),T&&T.p&&(!v||16&t)&&h(T,H,e,e[4],v?d(H,e[4],t,ot):m(e[4]),at),(!v||4&t)&&E(_,e[2])},i(e){v||(me(F,e),me(X,e),me(T,e),v=!0)},o(e){pe(F,e),pe(X,e),pe(T,e),v=!1},d(n){n&&I(t),F&&F.d(n),X&&X.d(n),T&&T.d(n),e[8](null),x=!1,r(y)}}}function ft(e,t,n){let i,{$$slots:r={},$$scope:s}=t,{showModal:o}=t,{onClose:a=(()=>{})}=t,{closeButtonMsg:c="Close"}=t;return e.$$set=e=>{"showModal"in e&&n(0,o=e.showModal),"onClose"in e&&n(1,a=e.onClose),"closeButtonMsg"in e&&n(2,c=e.closeButtonMsg),"$$scope"in e&&n(4,s=e.$$scope)},e.$$.update=()=>{9&e.$$.dirty&&i&&(o?i.showModal():i.close())},[o,a,c,i,s,r,function(t){z.call(this,e,t)},()=>i.close(),function(e){Z[e?"unshift":"push"]((()=>{i=e,n(3,i)}))},()=>{n(0,o=!1),a()},()=>i.close()]}class dt extends Pe{constructor(e){super(),Me(this,e,ft,ut,o,{showModal:0,onClose:1,closeButtonMsg:2})}}const{Map:ht}=ve;function mt(e,t,n){const i=e.slice();return i[14]=t[n],i}function pt(e,t){let n,i,r,s=t[14]+"";return{key:e,first:null,c(){n=C("option"),i=A(s),n.__value=r=t[14],n.value=n.__value,this.first=n},m(e,t){k(e,n,t),b(n,i)},p(e,o){t=e,2&o&&s!==(s=t[14]+"")&&E(i,s),2&o&&r!==(r=t[14])&&(n.__value=r,n.value=n.__value)},d(e){e&&I(n)}}}function gt(e){let t,n,i,s,o,a,c,l,u;return{c(){t=C("label"),n=C("input"),i=A("\r\n                FPS"),s=M(),o=C("label"),a=C("input"),c=A("\r\n                Animation Scale"),S(n,"type","number"),S(n,"name","fps"),S(n,"id","fps"),S(n,"min","1"),S(n,"max","120"),S(t,"for","fps"),S(a,"type","number"),S(a,"name","anim-scale"),S(a,"id","anim-scale"),S(a,"min","0.01"),S(a,"max","4"),S(a,"step","0.01"),S(o,"for","fps")},m(r,f){k(r,t,f),b(t,n),X(n,e[2].fps),b(t,i),k(r,s,f),k(r,o,f),b(o,a),X(a,e[2].animationScale),b(o,c),l||(u=[P(n,"input",e[10]),P(a,"input",e[11])],l=!0)},p(e,t){4&t&&W(n.value)!==e[2].fps&&X(n,e[2].fps),4&t&&W(a.value)!==e[2].animationScale&&X(a,e[2].animationScale)},d(e){e&&I(t),e&&I(s),e&&I(o),l=!1,r(u)}}}function wt(e){let t,n,i,s,o,a,c,l,u,f,d,h=[],m=new ht,p=e[2]?.isPlaying?"Stop":"Play",g=e[1];const w=e=>e[14];for(let t=0;t<g.length;t+=1){let n=mt(e,g,t),i=w(n);m.set(i,h[t]=pt(i,n))}let _=e[2]&&gt(e);return{c(){t=C("div"),n=C("select");for(let e=0;e<h.length;e+=1)h[e].c();i=M(),s=C("button"),o=A(p),a=A(" Animation"),c=M(),_&&_.c(),l=M(),u=C("canvas"),S(n,"name","anim-prefix"),S(n,"id","anim-prefix"),void 0===e[4]&&te((()=>e[9].call(n)))},m(r,m){k(r,t,m),b(t,n);for(let e=0;e<h.length;e+=1)h[e]&&h[e].m(n,null);T(n,e[4],!0),b(t,i),b(t,s),b(s,o),b(s,a),b(t,c),_&&_.m(t,null),k(r,l,m),k(r,u,m),e[12](u),f||(d=[P(n,"change",e[8]),P(n,"change",e[9]),P(s,"click",e[5])],f=!0)},p(e,i){2&i&&(g=e[1],h=ye(h,i,w,1,e,g,m,n,xe,pt,null,mt)),18&i&&T(n,e[4]),4&i&&p!==(p=e[2]?.isPlaying?"Stop":"Play")&&E(o,p),e[2]?_?_.p(e,i):(_=gt(e),_.c(),_.m(t,null)):_&&(_.d(1),_=null)},d(n){n&&I(t);for(let e=0;e<h.length;e+=1)h[e].d();_&&_.d(),n&&I(l),n&&I(u),e[12](null),f=!1,r(d)}}}function _t(t){let n;return{c(){n=C("h4"),n.textContent="View Animation",S(n,"slot","header")},m(e,t){k(e,n,t)},p:e,d(e){e&&I(n)}}}function vt(e){let t,n,i;function r(t){e[13](t)}let s={$$slots:{header:[_t],default:[wt]},$$scope:{ctx:e}};return void 0!==e[0]&&(s.showModal=e[0]),t=new dt({props:s}),Z.push((()=>$e(t,"showModal",r))),{c(){ke(t.$$.fragment)},m(e,n){Ie(t,e,n),i=!0},p(e,[i]){const r={};131102&i&&(r.$$scope={dirty:i,ctx:e}),!n&&1&i&&(n=!0,r.showModal=e[0],ne((()=>n=!1))),t.$set(r)},i(e){i||(me(t.$$.fragment,e),i=!0)},o(e){pe(t.$$.fragment,e),i=!1},d(e){Ce(t,e)}}}function xt(e,t,n){let i;l(e,Le,(e=>n(7,i=e)));let r,{showView:s=!1}=t,o=null,a=new Map,c=[],u=null;U((()=>{n(2,u=new Qe(o.getContext("2d")))}));return e.$$set=e=>{"showView"in e&&n(0,s=e.showView)},e.$$.update=()=>{if(5&e.$$.dirty&&null!==u&&(s?(console.log("Clearing canvas: ",u.isPlaying),u.clearCanvas()):u.stopAnimation(),n(2,u),n(0,s)),195&e.$$.dirty&&s){n(6,a=new Map),n(1,c=[]);for(let e of i)if(a.has(e.animationPrefix)){let t=a.get(e.animationPrefix);a.set(e.animationPrefix,[...t,e])}else a.set(e.animationPrefix,[e]);for(let e of a.keys())n(1,c=[...c,e])}},[s,c,u,o,r,async function(){null===u.animId?(await u.initFrames(a.get(r)),u.play(),n(2,u.context.canvas.width=.9*window.innerWidth,u),n(2,u.context.canvas.height=.9*window.innerHeight,u)):u.stopAnimation(),console.log("Anim is "+u.animId),n(2,u),n(0,s)},a,i,()=>{u.stopAnimation(),n(2,u),n(0,s)},function(){r=function(e){const t=e.querySelector(":checked");return t&&t.__value}(this),n(4,r),n(1,c),n(0,s),n(7,i),n(6,a)},function(){u.fps=W(this.value),n(2,u),n(0,s)},function(){u.animationScale=W(this.value),n(2,u),n(0,s)},function(e){Z[e?"unshift":"push"]((()=>{o=e,n(3,o)}))},function(e){s=e,n(0,s)}]}class bt extends Pe{constructor(e){super(),Me(this,e,xt,vt,o,{showView:0})}}function yt(e,t,n){const i=e.slice();return i[34]=t[n],i[35]=t,i[36]=n,i}function $t(e,t){let n,i,s,o,a,c,l,u,f,d,h,m,p,g,w,_,v,x,y,$,R,F,W,X,H,T,L,B,O,V,Y,N,j,U,D,z,G,Z,J,K,Q,ee=t[34].animationPrefix+"",te=t[34].rect.width+"",ne=t[34].rect.height+"",ie=t[34].frameRect.frameX+"",re=t[34].frameRect.frameY+"",se=t[34].frameRect.frameWidth+"",oe=t[34].frameRect.frameHeight+"",ae=t[34].transform.newWidth+"",ce=t[34].transform.newHeight+"",le=t[34].transform.flipX+"",ue=t[34].transform.flipY+"",fe=t[36];function de(...e){return t[17](t[36],t[34],...e)}const he=()=>t[18](n,fe),me=()=>t[18](null,fe);function pe(...e){return t[19](t[36],t[34],...e)}return{key:e,first:null,c(){n=C("tr"),i=C("td"),s=C("input"),c=M(),l=C("td"),u=A(ee),f=M(),d=C("td"),h=A(te),m=M(),p=C("td"),g=A(ne),w=M(),_=C("td"),v=A(ie),x=M(),y=C("td"),$=A(re),R=M(),F=C("td"),W=A(se),X=M(),H=C("td"),T=A(oe),L=M(),B=C("td"),O=A(ae),V=M(),Y=C("td"),N=A(ce),j=M(),U=C("td"),D=A(le),z=M(),G=C("td"),Z=A(ue),J=M(),S(s,"type","checkbox"),S(s,"name",o="select-"+t[34].sprId),S(s,"id",a="select-"+t[34].sprId),S(s,"class","svelte-1qvrxoo"),S(i,"class","svelte-1qvrxoo"),S(l,"class","svelte-1qvrxoo"),S(d,"class","svelte-1qvrxoo"),S(p,"class","svelte-1qvrxoo"),S(_,"class","svelte-1qvrxoo"),S(y,"class","svelte-1qvrxoo"),S(F,"class","svelte-1qvrxoo"),S(H,"class","svelte-1qvrxoo"),S(B,"class","svelte-1qvrxoo"),S(Y,"class","svelte-1qvrxoo"),S(U,"class","svelte-1qvrxoo"),S(G,"class","svelte-1qvrxoo"),this.first=n},m(e,t){k(e,n,t),b(n,i),b(i,s),b(n,c),b(n,l),b(l,u),b(n,f),b(n,d),b(d,h),b(n,m),b(n,p),b(p,g),b(n,w),b(n,_),b(_,v),b(n,x),b(n,y),b(y,$),b(n,R),b(n,F),b(F,W),b(n,X),b(n,H),b(H,T),b(n,L),b(n,B),b(B,O),b(n,V),b(n,Y),b(Y,N),b(n,j),b(n,U),b(U,D),b(n,z),b(n,G),b(G,Z),b(n,J),he(),K||(Q=[P(s,"change",de),P(n,"click",q(pe))],K=!0)},p(e,n){t=e,4096&n[0]&&o!==(o="select-"+t[34].sprId)&&S(s,"name",o),4096&n[0]&&a!==(a="select-"+t[34].sprId)&&S(s,"id",a),4096&n[0]&&ee!==(ee=t[34].animationPrefix+"")&&E(u,ee),4096&n[0]&&te!==(te=t[34].rect.width+"")&&E(h,te),4096&n[0]&&ne!==(ne=t[34].rect.height+"")&&E(g,ne),4096&n[0]&&ie!==(ie=t[34].frameRect.frameX+"")&&E(v,ie),4096&n[0]&&re!==(re=t[34].frameRect.frameY+"")&&E($,re),4096&n[0]&&se!==(se=t[34].frameRect.frameWidth+"")&&E(W,se),4096&n[0]&&oe!==(oe=t[34].frameRect.frameHeight+"")&&E(T,oe),4096&n[0]&&ae!==(ae=t[34].transform.newWidth+"")&&E(O,ae),4096&n[0]&&ce!==(ce=t[34].transform.newHeight+"")&&E(N,ce),4096&n[0]&&le!==(le=t[34].transform.flipX+"")&&E(D,le),4096&n[0]&&ue!==(ue=t[34].transform.flipY+"")&&E(Z,ue),fe!==t[36]&&(me(),fe=t[36],he())},d(e){e&&I(n),me(),K=!1,r(Q)}}}function kt(e){let t,n,i,s,o,a,c,l,u,f,d,h,m,p,g,w,_,v,x,y,$,q,R,F,W,E,X,H,T,L,B,O,V,Y,N,j,U,D,z,G,Z,J,K,Q,ee,te,ne,ie,re,se=[],oe=new Map,ae=e[12];const ce=e=>e[34].sprId;for(let t=0;t<ae.length;t+=1){let n=yt(e,ae,t),i=ce(n);oe.set(i,se[t]=$t(i,n))}return{c(){t=C("div"),n=C("div"),i=C("table"),s=C("thead"),s.innerHTML='<th class="svelte-1qvrxoo"></th> \n                    <th class="svelte-1qvrxoo">Prefix</th> \n                    <th class="svelte-1qvrxoo">Width</th> \n                    <th class="svelte-1qvrxoo">Height</th> \n                    <th class="svelte-1qvrxoo">Frame X</th> \n                    <th class="svelte-1qvrxoo">Frame Y</th> \n                    <th class="svelte-1qvrxoo">Frame Width</th> \n                    <th class="svelte-1qvrxoo">Frame Height</th> \n                    <th class="svelte-1qvrxoo">New Image Width</th> \n                    <th class="svelte-1qvrxoo">New Image Height</th> \n                    <th class="svelte-1qvrxoo">flip X</th> \n                    <th class="svelte-1qvrxoo">flip Y</th>',o=M(),a=C("tbody");for(let e=0;e<se.length;e+=1)se[e].c();c=M(),l=C("div"),u=C("div"),f=C("label"),d=A("Frame X\r\n                    "),h=C("input"),m=M(),p=C("label"),g=A("Frame Y\r\n                    "),w=C("input"),_=M(),v=C("label"),x=A("Frame Width\r\n                    "),y=C("input"),$=M(),q=C("label"),R=A("Frame Height\r\n                    "),F=C("input"),W=M(),E=C("label"),X=A("Image Width\r\n                    "),H=C("input"),T=M(),L=C("label"),B=A("Image Height\r\n                    "),O=C("input"),V=M(),Y=C("label"),N=A("Flip X\r\n                    "),j=C("input"),U=M(),D=C("label"),z=A("Flip Y\r\n                    "),G=C("input"),Z=M(),J=C("label"),K=A("Animation Scale\r\n                    "),Q=C("input"),ee=M(),te=C("div"),ne=C("canvas"),S(i,"class","not-selectable svelte-1qvrxoo"),S(n,"id","table-div"),S(n,"class","svelte-1qvrxoo"),S(h,"type","number"),S(h,"name","frame-x"),S(h,"id","frame-x"),S(h,"class","svelte-1qvrxoo"),S(f,"class","xmlview-input svelte-1qvrxoo"),S(f,"for","frame-x"),S(w,"type","number"),S(w,"name","frame-y"),S(w,"id","frame-y"),S(w,"class","svelte-1qvrxoo"),S(p,"class","xmlview-input svelte-1qvrxoo"),S(p,"for","frame-y"),S(y,"type","number"),S(y,"name","frame-width"),S(y,"id","frame-width"),S(y,"class","svelte-1qvrxoo"),S(v,"class","xmlview-input svelte-1qvrxoo"),S(v,"for","frame-width"),S(F,"type","number"),S(F,"name","frame-height"),S(F,"id","frame-height"),S(F,"class","svelte-1qvrxoo"),S(q,"class","xmlview-input svelte-1qvrxoo"),S(q,"for","frame-height"),S(H,"type","number"),S(H,"name","scale-x"),S(H,"id","scale-x"),S(H,"min","1"),S(H,"class","svelte-1qvrxoo"),S(E,"class","xmlview-input svelte-1qvrxoo"),S(E,"for","scale-x"),S(O,"type","number"),S(O,"name","scale-y"),S(O,"id","scale-y"),S(O,"min","1"),S(O,"class","svelte-1qvrxoo"),S(L,"class","xmlview-input svelte-1qvrxoo"),S(L,"for","scale-y"),S(j,"type","checkbox"),S(j,"name","flip-x"),S(j,"id","flip-x"),S(j,"class","svelte-1qvrxoo"),S(Y,"class","xmlview-input svelte-1qvrxoo"),S(Y,"for","flip-x"),S(G,"type","checkbox"),S(G,"name","flip-y"),S(G,"id","flip-y"),S(G,"class","svelte-1qvrxoo"),S(D,"class","xmlview-input svelte-1qvrxoo"),S(D,"for","flip-y"),S(Q,"type","number"),S(Q,"name","animation-scale"),S(Q,"id","animation-scale"),S(Q,"min","0.01"),S(Q,"step","0.01"),S(Q,"class","svelte-1qvrxoo"),S(J,"class","xmlview-input svelte-1qvrxoo"),S(J,"for","animation-scale"),S(u,"class","controls-horizontal svelte-1qvrxoo"),S(ne,"width","550px"),S(ne,"height","500px"),S(ne,"class","svelte-1qvrxoo"),S(te,"class","canvas-div svelte-1qvrxoo"),S(t,"id","view-container"),S(t,"class","svelte-1qvrxoo")},m(r,I){k(r,t,I),b(t,n),b(n,i),b(i,s),b(i,o),b(i,a);for(let e=0;e<se.length;e+=1)se[e]&&se[e].m(a,null);b(t,c),b(t,l),b(l,u),b(u,f),b(f,d),b(f,h),e[20](h),b(u,m),b(u,p),b(p,g),b(p,w),e[21](w),b(u,_),b(u,v),b(v,x),b(v,y),e[22](y),b(u,$),b(u,q),b(q,R),b(q,F),e[23](F),b(u,W),b(u,E),b(E,X),b(E,H),e[24](H),b(u,T),b(u,L),b(L,B),b(L,O),e[25](O),b(u,V),b(u,Y),b(Y,N),b(Y,j),e[26](j),b(u,U),b(u,D),b(D,z),b(D,G),e[27](G),b(u,Z),b(u,J),b(J,K),b(J,Q),e[28](Q),b(l,ee),b(l,te),b(te,ne),e[29](ne),ie||(re=[P(h,"input",e[16]),P(w,"input",e[16]),P(y,"input",e[16]),P(F,"input",e[16]),P(H,"input",e[16]),P(O,"input",e[16]),P(j,"input",e[16]),P(G,"input",e[16]),P(Q,"input",e[14])],ie=!0)},p(e,t){46080&t[0]&&(ae=e[12],se=ye(se,t,ce,1,e,ae,oe,a,xe,$t,null,yt))},d(n){n&&I(t);for(let e=0;e<se.length;e+=1)se[e].d();e[20](null),e[21](null),e[22](null),e[23](null),e[24](null),e[25](null),e[26](null),e[27](null),e[28](null),e[29](null),ie=!1,r(re)}}}function It(t){let n;return{c(){n=C("div"),n.innerHTML="<h4>XML View</h4>",S(n,"slot","header")},m(e,t){k(e,n,t)},p:e,d(e){e&&I(n)}}}function Ct(e){let t,n,i;function r(t){e[30](t)}let s={closeButtonMsg:"Save and Close",$$slots:{header:[It],default:[kt]},$$scope:{ctx:e}};return void 0!==e[0]&&(s.showModal=e[0]),t=new dt({props:s}),Z.push((()=>$e(t,"showModal",r))),{c(){ke(t.$$.fragment)},m(e,n){Ie(t,e,n),i=!0},p(e,i){const r={};8190&i[0]|64&i[1]&&(r.$$scope={dirty:i,ctx:e}),!n&&1&i[0]&&(n=!0,r.showModal=e[0],ne((()=>n=!1))),t.$set(r)},i(e){i||(me(t.$$.fragment,e),i=!0)},o(e){pe(t.$$.fragment,e),i=!1},d(e){Ce(t,e)}}}function At(e,t,n){let i;l(e,Le,(e=>n(12,i=e)));let{showView:r=!1}=t,s=null,o=null,a=null,c=null,u=null,f=null,d=null,h=null,m=null,p=null,g=[],w=null,_=new Qe(null);async function v(e){w&&(await _.initFrames([e]),_.clearCanvas(),_.drawImage(_.curImgs[0],e,!0))}function x(e){s=i[e];for(const e of g)e&&(e.style.backgroundColor="white");n(10,g[e].style.backgroundColor="blue",g),n(2,a.value=""+s.frameRect.frameX,a),n(3,c.value=""+s.frameRect.frameY,c),n(4,u.value=""+s.frameRect.frameWidth,u),n(5,f.value=""+s.frameRect.frameHeight,f),n(6,d.value=""+s.transform.newWidth,d),n(7,h.value=""+s.transform.newHeight,h),n(8,m.checked=s.transform.flipX,m),n(9,p.checked=s.transform.flipY,p)}U((()=>{_=new Qe(w.getContext("2d")),n(1,o.value=""+_.animationScale,o)}));return e.$$set=e=>{"showView"in e&&n(0,r=e.showView)},[r,o,a,c,u,f,d,h,m,p,g,w,i,v,function(e){_.animationScale=parseFloat(e.target.value),v(s).then((()=>{}))},x,function(e){s.frameRect.frameX=+a.value,s.frameRect.frameY=+c.value,s.frameRect.frameWidth=+u.value,s.frameRect.frameHeight=+f.value,s.transform.newWidth=+d.value,s.transform.newHeight=+h.value,s.transform.flipX=m.checked,s.transform.flipY=p.checked,s._changed=!0,Le.set(i),v(s).then((()=>{}))},async(e,t,n)=>{x(e),await v(t)},function(e,t){Z[e?"unshift":"push"]((()=>{g[t]=e,n(10,g)}))},async(e,t,n)=>{x(e),await v(t)},function(e){Z[e?"unshift":"push"]((()=>{a=e,n(2,a)}))},function(e){Z[e?"unshift":"push"]((()=>{c=e,n(3,c)}))},function(e){Z[e?"unshift":"push"]((()=>{u=e,n(4,u)}))},function(e){Z[e?"unshift":"push"]((()=>{f=e,n(5,f)}))},function(e){Z[e?"unshift":"push"]((()=>{d=e,n(6,d)}))},function(e){Z[e?"unshift":"push"]((()=>{h=e,n(7,h)}))},function(e){Z[e?"unshift":"push"]((()=>{m=e,n(8,m)}))},function(e){Z[e?"unshift":"push"]((()=>{p=e,n(9,p)}))},function(e){Z[e?"unshift":"push"]((()=>{o=e,n(1,o)}))},function(e){Z[e?"unshift":"push"]((()=>{w=e,n(11,w)}))},function(e){r=e,n(0,r)}]}class Mt extends Pe{constructor(e){super(),Me(this,e,At,Ct,o,{showView:0},null,[-1,-1])}}class Pt{constructor(e,t,n,i,r){this.sprId=e,this.type=t,this.imgfileref=n,this.xmlfileref=i,this.selected=!1,this.spritesheetId=r,this.animationPrefix="",this.rect={x:0,y:0,width:null,height:null},this.transform={newWidth:null,newHeight:null,flipX:!1,flipY:!1},this.frameRect={frameX:0,frameY:0,frameWidth:null,frameHeight:null},this._changed=!1}clone(){const e=new Pt(this.sprId,this.type,this.imgfileref,this.xmlfileref,this.spritesheetId);return e.selected=this.selected,e.animationPrefix=this.animationPrefix,e.rect=Object.assign({},this.rect),e.transform=Object.assign({},this.transform),e.frameRect=Object.assign({},this.frameRect),e}}function qt(e){let t,n,i,s,o,a,c,l,u,f,d,h,m,p,g,w,_,v,x,y,$,q,R,E,H,T,L,B,O,V,Y,N,j,U,D,z,G,Z,J,K;return Z=F(e[4][0]),{c(){t=C("div"),n=C("label"),n.textContent="Image Padding",i=M(),s=C("input"),o=M(),a=C("br"),c=M(),l=C("br"),u=M(),f=C("br"),d=M(),h=C("label"),h.textContent="Animation Name Prefixing",m=M(),p=C("br"),g=M(),w=C("label"),_=C("input"),v=A("\r\n            Use character name as prefix"),x=M(),y=C("label"),$=C("input"),q=A("\r\n            Use custom name as prefix"),R=M(),E=C("label"),E.textContent="Custom Prefix",H=M(),T=C("input"),B=M(),O=C("label"),V=C("input"),Y=A("\r\n            Do not use a prefix"),N=M(),j=C("br"),U=M(),D=C("label"),z=C("input"),G=A("\r\n            Use Prefix even if frame is imported from existing Spritesheet"),S(n,"for","padding"),S(s,"type","number"),S(s,"name","padding"),S(s,"id","padding"),S(s,"min","0"),S(s,"max","20"),S(h,"for","prefix-type"),S(_,"type","radio"),S(_,"name","prefix-type"),S(_,"id","prefix-type-character-name"),_.__value="character-name",_.value=_.__value,S(w,"for","prefix-type-character-name"),S($,"type","radio"),S($,"name","prefix-type"),S($,"id","prefix-type-custom-prefix"),$.__value="custom-prefix",$.value=$.__value,S(y,"for","prefix-type-custom-prefix"),S(E,"for","custom-prefix"),S(T,"type","text"),S(T,"id","custom-prefix"),T.disabled=L="custom-prefix"!==e[1].prefixType,S(V,"type","radio"),S(V,"name","prefix-type"),S(V,"id","prefix-type-no-prefix"),V.__value="no-prefix",V.value=V.__value,S(O,"for","prefix-type-no-prefix"),S(z,"type","checkbox"),S(z,"name","use-prefix-on-existing-xmls"),S(z,"id","use-prefix-on-existing-xmls"),S(D,"for","use-prefix-on-existing-xmls"),S(t,"id","modal-content"),S(t,"class","svelte-6d2dce"),Z.p(_,$,V)},m(r,I){k(r,t,I),b(t,n),b(t,i),b(t,s),X(s,e[1].padding),b(t,o),b(t,a),b(t,c),b(t,l),b(t,u),b(t,f),b(t,d),b(t,h),b(t,m),b(t,p),b(t,g),b(t,w),b(w,_),_.checked=_.__value===e[1].prefixType,b(w,v),b(t,x),b(t,y),b(y,$),$.checked=$.__value===e[1].prefixType,b(y,q),b(t,R),b(t,E),b(t,H),b(t,T),X(T,e[1].customPrefix),b(t,B),b(t,O),b(O,V),V.checked=V.__value===e[1].prefixType,b(O,Y),b(t,N),b(t,j),b(t,U),b(t,D),b(D,z),z.checked=e[1].usePrefixOnXMLFrames,b(D,G),J||(K=[P(s,"input",e[2]),P(_,"change",e[3]),P($,"change",e[5]),P(T,"input",e[6]),P(V,"change",e[7]),P(z,"change",e[8])],J=!0)},p(e,t){2&t&&W(s.value)!==e[1].padding&&X(s,e[1].padding),2&t&&(_.checked=_.__value===e[1].prefixType),2&t&&($.checked=$.__value===e[1].prefixType),2&t&&L!==(L="custom-prefix"!==e[1].prefixType)&&(T.disabled=L),2&t&&T.value!==e[1].customPrefix&&X(T,e[1].customPrefix),2&t&&(V.checked=V.__value===e[1].prefixType),2&t&&(z.checked=e[1].usePrefixOnXMLFrames)},d(e){e&&I(t),Z.r(),J=!1,r(K)}}}function Rt(t){let n;return{c(){n=C("h4"),n.textContent="Settings",S(n,"slot","header"),S(n,"class","svelte-6d2dce")},m(e,t){k(e,n,t)},p:e,d(e){e&&I(n)}}}function St(e){let t,n,i;function r(t){e[9](t)}let s={$$slots:{header:[Rt],default:[qt]},$$scope:{ctx:e}};return void 0!==e[0]&&(s.showModal=e[0]),t=new dt({props:s}),Z.push((()=>$e(t,"showModal",r))),{c(){ke(t.$$.fragment)},m(e,n){Ie(t,e,n),i=!0},p(e,[i]){const r={};1026&i&&(r.$$scope={dirty:i,ctx:e}),!n&&1&i&&(n=!0,r.showModal=e[0],ne((()=>n=!1))),t.$set(r)},i(e){i||(me(t.$$.fragment,e),i=!0)},o(e){pe(t.$$.fragment,e),i=!1},d(e){Ce(t,e)}}}function Ft(e,t,n){let{showView:i=!1}=t,{settings:r={padding:2,prefixType:"no-prefix",usePrefixOnXMLFrames:!1,customPrefix:""}}=t;return e.$$set=e=>{"showView"in e&&n(0,i=e.showView),"settings"in e&&n(1,r=e.settings)},[i,r,function(){r.padding=W(this.value),n(1,r)},function(){r.prefixType=this.__value,n(1,r)},[[]],function(){r.prefixType=this.__value,n(1,r)},function(){r.customPrefix=this.value,n(1,r)},function(){r.prefixType=this.__value,n(1,r)},function(){r.usePrefixOnXMLFrames=this.checked,n(1,r)},function(e){i=e,n(0,i)}]}class Wt extends Pe{constructor(e){super(),Me(this,e,Ft,St,o,{showView:0,settings:1})}}function Et(e){let t,n,i,s,o,a,c,l,u,f,d,h,m,p=(null!==e[9]?e[9].name:"")+"",g=(null!==e[10]?e[10].name:"")+"";return{c(){t=C("button"),t.textContent="Spritesheet (.png)",n=M(),i=C("button"),i.textContent="XML File (.xml)",s=M(),o=C("p"),a=A("Spritesheet selected: "),c=A(p),l=M(),u=C("p"),f=A("XML selected: "),d=A(g)},m(r,p){k(r,t,p),k(r,n,p),k(r,i,p),k(r,s,p),k(r,o,p),b(o,a),b(o,c),k(r,l,p),k(r,u,p),b(u,f),b(u,d),h||(m=[P(t,"click",e[32]),P(i,"click",e[33])],h=!0)},p(e,t){512&t[0]&&p!==(p=(null!==e[9]?e[9].name:"")+"")&&E(c,p),1024&t[0]&&g!==(g=(null!==e[10]?e[10].name:"")+"")&&E(d,g)},d(e){e&&I(t),e&&I(n),e&&I(i),e&&I(s),e&&I(o),e&&I(l),e&&I(u),h=!1,r(m)}}}function Xt(t){let n;return{c(){n=C("p"),n.textContent="Select Spritesheet or XML file",S(n,"slot","header")},m(e,t){k(e,n,t)},p:e,d(e){e&&I(n)}}}function Ht(t){let n,i,r;return{c(){n=C("button"),n.textContent="Add Spritesheet and XML",S(n,"slot","accept-btn")},m(e,s){k(e,n,s),i||(r=P(n,"click",t[31]),i=!0)},p:e,d(e){e&&I(n),i=!1,r()}}}function Tt(t){let n;return{c(){n=C("input"),S(n,"type","text"),S(n,"name","anim-prefix"),S(n,"id","anim-prefix"),n.value="name"},m(e,i){k(e,n,i),t[36](n)},p:e,d(e){e&&I(n),t[36](null)}}}function Lt(t){let n;return{c(){n=C("p"),n.textContent="Enter animation prefix",S(n,"slot","header")},m(e,t){k(e,n,t)},p:e,d(e){e&&I(n)}}}function Bt(t){let n,i,r;return{c(){n=C("button"),n.textContent="Set animation prefix",S(n,"slot","accept-btn")},m(e,s){k(e,n,s),i||(r=P(n,"click",t[35]),i=!0)},p:e,d(e){e&&I(n),i=!1,r()}}}function Ot(e){let t,n,i,s,o,a,c,l,u;return{c(){t=C("div"),n=C("button"),n.textContent="View XML structure",i=M(),s=C("button"),s.textContent="View Animation",S(t,"class","view-menu svelte-1t8ssxh"),S(t,"id","view-opts")},m(r,o){k(r,t,o),b(t,n),b(t,i),b(t,s),e[46](t),c=!0,l||(u=[P(n,"click",q(e[44])),P(s,"click",q(e[45]))],l=!0)},p(t,n){e=t},i(n){c||(te((()=>{c&&(a&&a.end(1),o=we(t,e[22],{duration:100,easing:st}),o.start())})),c=!0)},o(n){o&&o.invalidate(),a=_e(t,e[22],{duration:100,easing:st}),c=!1},d(n){n&&I(t),e[46](null),n&&a&&a.end(),l=!1,r(u)}}}function Vt(e){let t,n,i,s,o,a,c,l,u,f,d;return{c(){t=C("div"),n=C("button"),n.textContent="Set animation prefix",i=M(),s=C("button"),s.textContent="Delete Selection",o=M(),a=C("button"),a.textContent="Clone Selection",S(t,"class","view-menu svelte-1t8ssxh"),S(t,"id","view-selection-opts")},m(r,c){k(r,t,c),b(t,n),b(t,i),b(t,s),b(t,o),b(t,a),e[51](t),u=!0,f||(d=[P(n,"click",q(e[50])),P(s,"click",q(e[24])),P(a,"click",q(e[25]))],f=!0)},p(t,n){e=t},i(n){u||(te((()=>{u&&(l&&l.end(1),c=we(t,e[22],{duration:100,easing:st}),c.start())})),u=!0)},o(n){c&&c.invalidate(),l=_e(t,e[22],{duration:100,easing:st}),u=!1},d(n){n&&I(t),e[51](null),n&&l&&l.end(),f=!1,r(d)}}}function Yt(e){let t,n,i,s,o,a,c,l,u,f,d,h,m,p,g,w,_,v,x,y,$,F,W,X,H,T,L,B,O,V,Y,N,j,U,D,z,G,J,K,Q,ee,te,ie,re,se;function oe(t){e[34](t)}let ae={$$slots:{"accept-btn":[Ht],header:[Xt],default:[Et]},$$scope:{ctx:e}};function ce(t){e[37](t)}void 0!==e[4]&&(ae.showModal=e[4]),u=new dt({props:ae}),Z.push((()=>$e(u,"showModal",oe)));let le={$$slots:{"accept-btn":[Bt],header:[Lt],default:[Tt]},$$scope:{ctx:e}};function ue(t){e[38](t)}function fe(t){e[39](t)}void 0!==e[5]&&(le.showModal=e[5]),h=new dt({props:le}),Z.push((()=>$e(h,"showModal",ce)));let ge={};function we(t){e[40](t)}void 0!==e[6]&&(ge.showView=e[6]),void 0!==e[1]&&(ge.settings=e[1]),g=new Wt({props:ge}),Z.push((()=>$e(g,"showView",ue))),Z.push((()=>$e(g,"settings",fe)));let _e={};function ve(t){e[41](t)}void 0!==e[7]&&(_e.showView=e[7]),x=new bt({props:_e}),Z.push((()=>$e(x,"showView",we)));let xe={};void 0!==e[8]&&(xe.showView=e[8]),F=new Mt({props:xe}),Z.push((()=>$e(F,"showView",ve)));let be=e[2]&&Ot(e),ye=e[3]&&Vt(e);return{c(){t=C("dialog"),n=C("div"),i=C("label"),s=A(e[15]),o=M(),a=C("progress"),l=M(),ke(u.$$.fragment),d=M(),ke(h.$$.fragment),p=M(),ke(g.$$.fragment),v=M(),ke(x.$$.fragment),$=M(),ke(F.$$.fragment),X=M(),H=C("div"),T=C("button"),T.textContent="Settings",L=M(),B=C("button"),B.textContent="View",O=M(),be&&be.c(),V=M(),Y=C("label"),N=C("input"),j=A("\r\n        Select all"),U=M(),D=C("button"),D.textContent="Selection",z=M(),ye&&ye.c(),G=M(),J=C("button"),J.textContent="Add PNGs",K=M(),Q=C("button"),Q.textContent="Add Spritesheet",ee=M(),te=C("button"),te.textContent="Generate XML",S(i,"for","gen-progress"),S(a,"id","gen-progress"),a.value=c=Math.round(100*e[14]),S(a,"max","100"),S(N,"type","checkbox"),S(N,"name","select-all"),S(N,"id","select-all"),S(Y,"for","select-all"),S(H,"id","controls"),S(H,"class","svelte-1t8ssxh")},m(r,c){k(r,t,c),b(t,n),b(n,i),b(i,s),b(n,o),b(n,a),e[30](t),k(r,l,c),Ie(u,r,c),k(r,d,c),Ie(h,r,c),k(r,p,c),Ie(g,r,c),k(r,v,c),Ie(x,r,c),k(r,$,c),Ie(F,r,c),k(r,X,c),k(r,H,c),b(H,T),b(H,L),b(H,B),b(H,O),be&&be.m(H,null),b(H,V),b(H,Y),b(Y,N),e[47](N),b(Y,j),b(H,U),b(H,D),b(H,z),ye&&ye.m(H,null),b(H,G),b(H,J),b(H,K),b(H,Q),b(H,ee),b(H,te),ie=!0,re||(se=[P(T,"click",e[42]),P(B,"click",R(q(e[43]))),P(N,"change",e[48]),P(D,"click",q(e[49])),P(J,"click",e[52]),P(Q,"click",e[53]),P(te,"click",e[54])],re=!0)},p(e,t){(!ie||32768&t[0])&&E(s,e[15]),(!ie||16384&t[0]&&c!==(c=Math.round(100*e[14])))&&(a.value=c);const n={};1552&t[0]|67108864&t[1]&&(n.$$scope={dirty:t,ctx:e}),!f&&16&t[0]&&(f=!0,n.showModal=e[4],ne((()=>f=!1))),u.$set(n);const i={};2080&t[0]|67108864&t[1]&&(i.$$scope={dirty:t,ctx:e}),!m&&32&t[0]&&(m=!0,i.showModal=e[5],ne((()=>m=!1))),h.$set(i);const r={};!w&&64&t[0]&&(w=!0,r.showView=e[6],ne((()=>w=!1))),!_&&2&t[0]&&(_=!0,r.settings=e[1],ne((()=>_=!1))),g.$set(r);const o={};!y&&128&t[0]&&(y=!0,o.showView=e[7],ne((()=>y=!1))),x.$set(o);const l={};!W&&256&t[0]&&(W=!0,l.showView=e[8],ne((()=>W=!1))),F.$set(l),e[2]?be?(be.p(e,t),4&t[0]&&me(be,1)):(be=Ot(e),be.c(),me(be,1),be.m(H,V)):be&&(de(),pe(be,1,1,(()=>{be=null})),he()),e[3]?ye?(ye.p(e,t),8&t[0]&&me(ye,1)):(ye=Vt(e),ye.c(),me(ye,1),ye.m(H,G)):ye&&(de(),pe(ye,1,1,(()=>{ye=null})),he())},i(e){ie||(me(u.$$.fragment,e),me(h.$$.fragment,e),me(g.$$.fragment,e),me(x.$$.fragment,e),me(F.$$.fragment,e),me(be),me(ye),ie=!0)},o(e){pe(u.$$.fragment,e),pe(h.$$.fragment,e),pe(g.$$.fragment,e),pe(x.$$.fragment,e),pe(F.$$.fragment,e),pe(be),pe(ye),ie=!1},d(n){n&&I(t),e[30](null),n&&I(l),Ce(u,n),n&&I(d),Ce(h,n),n&&I(p),Ce(g,n),n&&I(v),Ce(x,n),n&&I($),Ce(F,n),n&&I(X),n&&I(H),be&&be.d(),e[47](null),ye&&ye.d(),re=!1,r(se)}}}function Nt(e,n,i){let r,s;l(e,Le,(e=>i(29,r=e))),l(e,Be,(e=>i(55,s=e)));let{wasm:o}=n,{charname:a}=n,c={padding:2,prefixType:"no-prefix",usePrefixOnXMLFrames:!1,customPrefix:""};async function u(e){const t=e.target;let n=[];for(let e of t.files){const[t,i]=await je(e),r=new Pt(e.name+"::"+ze.getNewId(),"single_frame",e,null,null);r.rect.width=t,r.rect.height=i,r.transform.newWidth=t,r.transform.newHeight=i,r.frameRect.frameWidth=t,r.frameRect.frameHeight=i,r.animationPrefix=e.name.substring(0,e.name.indexOf(".png")),n.push(r)}Le.update((e=>[...e,...n]))}async function f(e,t,n){if(null==t)return alert("Please select a spritesheet"),!0;if(null==n)return alert("Please select an XML"),!0;let i=await t.arrayBuffer();const r=await async function(e){const t=await crypto.subtle.digest("SHA-1",e);return Ee(new Uint8Array(t))}(new Uint8Array(i)),s=Xe(i);Be.update((e=>(e.has(r)||e.set(r,[s,0]),e)));const o=await n.text(),a=(new DOMParser).parseFromString(o,"text/xml").getElementsByTagName("SubTexture"),c=[];for(let e of a){const i=e.getAttribute("name"),s=Ye(i,(e=>!(e>="0"&&e<="9")),!0),o=new Pt(t.name+"::"+ze.getNewId(),"spritesheet_frame",t,n,r);o.animationPrefix=i.substring(0,s+1),o.rect={x:parseInt(e.getAttribute("x")),y:parseInt(e.getAttribute("y")),width:parseInt(e.getAttribute("width")),height:parseInt(e.getAttribute("height"))},o.frameRect={frameX:parseInt(e.getAttribute("frameX"))||0,frameY:parseInt(e.getAttribute("frameY"))||0,frameWidth:parseInt(e.getAttribute("frameWidth"))||o.rect.width,frameHeight:parseInt(e.getAttribute("frameHeight"))||o.rect.height},o.transform.newWidth=o.rect.width,o.transform.newHeight=o.rect.height,c.push(o)}return Le.update((e=>[...e,...c])),Be.update((e=>{const[t,n]=e.get(r);return e.set(r,[t,n+a.length]),e})),t=null,n=null,!1}function d(e){for(let t=0;t<r.length;t++){let n=r[t];n.selected&&(n.animationPrefix=e,n.selected=!1)}Le.set(r)}let h=!1,m=!1,p=!1,g=!1,w=!1,_=!1,v=!1,x=null,b=null,y=null,$=null,k=null,I=null;const C=e=>{k&&e.target!==k&&i(2,h=!1),I&&e.target!==I&&i(3,m=!1)};function A(e){i(9,x=e.target.files[0])}function M(e){i(10,b=e.target.files[0])}function P(e){Le.update((t=>t.map((t=>(t.selected=e,t)))))}U((()=>{document.body.addEventListener("click",C)})),D((()=>{document.body.removeEventListener("click",C)}));let q=0,R="Adding images: 0%",S=null;async function F(){if(console.log(c),!Ue(a)||!Ue(a+".zip"))return void alert("Please enter a valid filename as the name of your character!");if(r.length<=0)return void alert("Please add some images/spritesheets!");i(15,R="Adding images: 0%"),i(14,q=0),S.showModal();const{GrowingPacker:e}=o,t=e.new(a,c.padding),n=Array.from(s.entries()).length+r.length;let l=0;De((()=>{for(const e of s){const r=e[0],s=e[1][0];console.log("adding "+r+" to store!"),t.add_image_to_store(r,Fe(s,null)),l++,i(14,q=l/n),i(15,R=`Adding images: ${Math.round(100*q)}%`)}})),De((async()=>{let e="";switch(c.prefixType){case"character-name":e=a+" ";break;case"custom-prefix":e=c.customPrefix+" "}for(const s of r){switch(s.type){case"single_frame":console.log("Reading single frame"+s.sprId);const n=await s.imgfileref.arrayBuffer();t.add_single_frame(new Uint8Array(n),e+s.animationPrefix,s.transform.newWidth,s.transform.newHeight,s.transform.flipX,s.transform.flipY,BigInt(s.frameRect.frameX),BigInt(s.frameRect.frameY),BigInt(s.frameRect.frameWidth),BigInt(s.frameRect.frameHeight));break;case"spritesheet_frame":console.log("Putting spritesheet frame"+s.sprId),De((()=>{t.add_spritesheet_frame(s.spritesheetId,(c.usePrefixOnXMLFrames?e:"")+s.animationPrefix,s.rect.x,s.rect.y,s.rect.width,s.rect.height,s.transform.newWidth,s.transform.newHeight,s.transform.flipX,s.transform.flipY,BigInt(s.frameRect.frameX),BigInt(s.frameRect.frameY),BigInt(s.frameRect.frameWidth),BigInt(s.frameRect.frameHeight))}))}l++,i(14,q=l/n),i(15,R=`Adding images: ${Math.round(100*q)}%`)}De((()=>{i(15,R="Generating spritesheet and XML...."),De((()=>{Ve(t.make_packed_image(),a+".zip"),S.close()}))}))}))}return e.$$set=e=>{"wasm"in e&&i(27,o=e.wasm),"charname"in e&&i(28,a=e.charname)},e.$$.update=()=>{536870913&e.$$.dirty[0]&&null!=$&&i(0,$.checked=r.length>0&&r.every((e=>e.selected))||!1,$)},[$,c,h,m,p,g,w,_,v,x,b,y,k,I,q,R,S,u,f,d,A,M,function(e,n){const i=function(e,{delay:n=0,duration:i=400,easing:r=t}={}){const s=+getComputedStyle(e).opacity;return{delay:n,duration:i,easing:r,css:e=>"opacity: "+e*s}}(e,n);return{duration:n.duration,css:i.css}},P,function(){for(let e=r.length-1;e>=0;e--){const t=r[e];if(t.selected&&(r.splice(e,1),"spritesheet_frame"===t.type)){const e=t.spritesheetId,[n,i]=s.get(e),r=i-1;r>0?Be.update((t=>(t.set(e,[n,r]),t))):Be.update((t=>(t.delete(e),t)))}}Le.set(r)},function(){for(let e=0;e<r.length;e++){const t=r[e];if(t.selected){const e=t.clone();e.selected=!1,e.sprId+="-copy"+ze.getNewId(),Le.update((t=>[...t,e])),t.selected=!1}}},F,o,a,r,function(e){Z[e?"unshift":"push"]((()=>{S=e,i(16,S)}))},async e=>{await f(0,x,b)||i(4,p=!1)},()=>{Oe(A,"image/png",!1)},()=>{Oe(M,"text/xml",!1)},function(e){p=e,i(4,p)},()=>{d(y.value),i(5,g=!1)},function(e){Z[e?"unshift":"push"]((()=>{y=e,i(11,y)}))},function(e){g=e,i(5,g)},function(e){w=e,i(6,w)},function(e){c=e,i(1,c)},function(e){_=e,i(7,_)},function(e){v=e,i(8,v)},()=>{i(6,w=!0)},()=>{i(2,h=!h)},()=>{i(8,v=!0)},()=>{i(7,_=!0)},function(e){Z[e?"unshift":"push"]((()=>{k=e,i(12,k)}))},function(e){Z[e?"unshift":"push"]((()=>{$=e,i(0,$),i(29,r)}))},()=>{P($.checked)},()=>{i(3,m=!m)},()=>{i(5,g=!0)},function(e){Z[e?"unshift":"push"]((()=>{I=e,i(13,I)}))},()=>{Oe(u,"image/png",!0)},()=>{i(4,p=!0)},()=>{F().then((()=>{}))}]}class jt extends Pe{constructor(e){super(),Me(this,e,Nt,Yt,o,{wasm:27,charname:28},null,[-1,-1])}}function Ut(e,t,n){const i=e.slice();return i[4]=t[n],i[5]=t,i[6]=n,i}function Dt(e,t){let n,i,r,s;function o(e){t[3](e,t[4],t[5],t[6])}let a={};return void 0!==t[4]&&(a.frameInfo=t[4]),i=new rt({props:a}),Z.push((()=>$e(i,"frameInfo",o))),{key:e,first:null,c(){n=A(""),ke(i.$$.fragment),this.first=n},m(e,t){k(e,n,t),Ie(i,e,t),s=!0},p(e,n){t=e;const s={};!r&&4&n&&(r=!0,s.frameInfo=t[4],ne((()=>r=!1))),i.$set(s)},i(e){s||(me(i.$$.fragment,e),s=!0)},o(e){pe(i.$$.fragment,e),s=!1},d(e){e&&I(n),Ce(i,e)}}}function zt(e){let t,n,i,r,s=[],o=new Map,a=e[2];const c=e=>e[4].sprId;for(let t=0;t<a.length;t+=1){let n=Ut(e,a,t),i=c(n);o.set(i,s[t]=Dt(i,n))}return i=new jt({props:{charname:e[1],wasm:e[0]}}),{c(){t=C("div");for(let e=0;e<s.length;e+=1)s[e].c();n=M(),ke(i.$$.fragment),S(t,"id","sprite-frames"),S(t,"class","svelte-8tybqo")},m(e,o){k(e,t,o);for(let e=0;e<s.length;e+=1)s[e]&&s[e].m(t,null);k(e,n,o),Ie(i,e,o),r=!0},p(e,[n]){4&n&&(a=e[2],de(),s=ye(s,n,c,1,e,a,o,t,be,Dt,null,Ut),he());const r={};2&n&&(r.charname=e[1]),1&n&&(r.wasm=e[0]),i.$set(r)},i(e){if(!r){for(let e=0;e<a.length;e+=1)me(s[e]);me(i.$$.fragment,e),r=!0}},o(e){for(let e=0;e<s.length;e+=1)pe(s[e]);pe(i.$$.fragment,e),r=!1},d(e){e&&I(t);for(let e=0;e<s.length;e+=1)s[e].d();e&&I(n),Ce(i,e)}}}function Gt(e,t,n){let i;l(e,Le,(e=>n(2,i=e)));let{wasm:r}=t,{charname:s}=t;return e.$$set=e=>{"wasm"in e&&n(0,r=e.wasm),"charname"in e&&n(1,s=e.charname)},[r,s,i,function(e,t,n,r){n[r]=e,Le.set(i)}]}class Zt extends Pe{constructor(e){super(),Me(this,e,Gt,zt,o,{wasm:0,charname:1})}}function Jt(e){let t,n,i;function r(t){e[6](t)}let s={wasm:e[0]};return void 0!==e[1]&&(s.charname=e[1]),t=new Ke({props:s}),Z.push((()=>$e(t,"charname",r))),{c(){ke(t.$$.fragment)},m(e,n){Ie(t,e,n),i=!0},p(e,i){const r={};1&i&&(r.wasm=e[0]),!n&&2&i&&(n=!0,r.charname=e[1],ne((()=>n=!1))),t.$set(r)},i(e){i||(me(t.$$.fragment,e),i=!0)},o(e){pe(t.$$.fragment,e),i=!1},d(e){Ce(t,e)}}}function Kt(e){let t,n;return t=new Zt({props:{charname:e[1],wasm:e[0]}}),{c(){ke(t.$$.fragment)},m(e,i){Ie(t,e,i),n=!0},p(e,n){const i={};2&n&&(i.charname=e[1]),1&n&&(i.wasm=e[0]),t.$set(i)},i(e){n||(me(t.$$.fragment,e),n=!0)},o(e){pe(t.$$.fragment,e),n=!1},d(e){Ce(t,e)}}}function Qt(e){let t,n,i,r,s,o,a,c,l,u,f,d,h,m,p,g,w,_,v,x,y;function $(t){e[4](t)}let A={id:"spsh",text:"Spritesheet Generation"};function q(t){e[5](t)}void 0!==e[2]&&(A.curChoice=e[2]),u=new Se({props:A}),Z.push((()=>$e(u,"curChoice",$)));let R={id:"icongrid",text:"Icongrid Generation"};void 0!==e[2]&&(R.curChoice=e[2]),h=new Se({props:R}),Z.push((()=>$e(h,"curChoice",q)));const F=[Kt,Jt],W=[];function E(e,t){return"spsh"==e[2]?0:"icongrid"==e[2]?1:-1}return~(w=E(e))&&(_=W[w]=F[w](e)),{c(){t=C("main"),n=C("h1"),n.textContent="Spritesheet XML Web Testbench",i=M(),r=C("div"),s=C("label"),s.textContent="Character Name:",o=M(),a=C("input"),c=M(),l=C("div"),ke(u.$$.fragment),d=M(),ke(h.$$.fragment),p=M(),g=C("div"),_&&_.c(),S(n,"id","title"),S(n,"class","svelte-1aj93wi"),S(s,"for","char-name"),S(s,"class","svelte-1aj93wi"),S(a,"type","text"),S(a,"name","char-name"),S(a,"id","char-name"),S(r,"id","character-name-control"),S(r,"class","svelte-1aj93wi"),S(l,"id","app-tabs"),S(l,"class","svelte-1aj93wi"),S(g,"id","tab-container"),S(g,"class","svelte-1aj93wi")},m(f,m){k(f,t,m),b(t,n),b(t,i),b(t,r),b(r,s),b(r,o),b(r,a),X(a,e[1]),b(t,c),b(t,l),Ie(u,l,null),b(l,d),Ie(h,l,null),b(t,p),b(t,g),~w&&W[w].m(g,null),v=!0,x||(y=P(a,"input",e[3]),x=!0)},p(e,[t]){2&t&&a.value!==e[1]&&X(a,e[1]);const n={};!f&&4&t&&(f=!0,n.curChoice=e[2],ne((()=>f=!1))),u.$set(n);const i={};!m&&4&t&&(m=!0,i.curChoice=e[2],ne((()=>m=!1))),h.$set(i);let r=w;w=E(e),w===r?~w&&W[w].p(e,t):(_&&(de(),pe(W[r],1,1,(()=>{W[r]=null})),he()),~w?(_=W[w],_?_.p(e,t):(_=W[w]=F[w](e),_.c()),me(_,1),_.m(g,null)):_=null)},i(e){v||(me(u.$$.fragment,e),me(h.$$.fragment,e),me(_),v=!0)},o(e){pe(u.$$.fragment,e),pe(h.$$.fragment,e),pe(_),v=!1},d(e){e&&I(t),Ce(u),Ce(h),~w&&W[w].d(),x=!1,y()}}}function en(e,t,n){let i,{wasm:r}=t,s="spsh";return e.$$set=e=>{"wasm"in e&&n(0,r=e.wasm)},[r,i,s,function(){i=this.value,n(1,i)},function(e){s=e,n(2,s)},function(e){s=e,n(2,s)},function(e){i=e,n(1,i)}]}class tn extends Pe{constructor(e){super(),Me(this,e,en,Qt,o,{wasm:0})}}let nn;const rn=new Array(128).fill(void 0);function sn(e){return rn[e]}rn.push(void 0,null,!0,!1);let on=0,an=null;function cn(){return null!==an&&0!==an.byteLength||(an=new Uint8Array(nn.memory.buffer)),an}const ln="undefined"!=typeof TextEncoder?new TextEncoder("utf-8"):{encode:()=>{throw Error("TextEncoder not available")}},un="function"==typeof ln.encodeInto?function(e,t){return ln.encodeInto(e,t)}:function(e,t){const n=ln.encode(e);return t.set(n),{read:e.length,written:n.length}};function fn(e,t,n){if(void 0===n){const n=ln.encode(e),i=t(n.length)>>>0;return cn().subarray(i,i+n.length).set(n),on=n.length,i}let i=e.length,r=t(i)>>>0;const s=cn();let o=0;for(;o<i;o++){const t=e.charCodeAt(o);if(t>127)break;s[r+o]=t}if(o!==i){0!==o&&(e=e.slice(o)),r=n(r,i,i=o+3*e.length)>>>0;const t=cn().subarray(r+o,r+i);o+=un(e,t).written}return on=o,r}let dn=null;function hn(){return null!==dn&&0!==dn.byteLength||(dn=new Int32Array(nn.memory.buffer)),dn}let mn=rn.length;function pn(e){const t=sn(e);return function(e){e<132||(rn[e]=mn,mn=e)}(e),t}const gn="undefined"!=typeof TextDecoder?new TextDecoder("utf-8",{ignoreBOM:!0,fatal:!0}):{decode:()=>{throw Error("TextDecoder not available")}};function wn(e,t){return e>>>=0,gn.decode(cn().subarray(e,e+t))}function _n(e){mn===rn.length&&rn.push(rn.length+1);const t=mn;return mn=rn[t],rn[t]=e,t}function vn(e,t){const n=t(1*e.length)>>>0;return cn().set(e,n/1),on=e.length,n}function xn(e,t){return e>>>=0,cn().subarray(e/1,e/1+t)}"undefined"!=typeof TextDecoder&&gn.decode();class bn{static __wrap(e){e>>>=0;const t=Object.create(bn.prototype);return t.__wbg_ptr=e,t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,e}free(){const e=this.__destroy_into_raw();nn.__wbg_growingpacker_free(e)}static new(e,t){const n=fn(e,nn.__wbindgen_malloc,nn.__wbindgen_realloc),i=on,r=nn.growingpacker_new(n,i,t);return bn.__wrap(r)}add_image_to_store(e,t){const n=fn(e,nn.__wbindgen_malloc,nn.__wbindgen_realloc),i=on,r=vn(t,nn.__wbindgen_malloc),s=on;nn.growingpacker_add_image_to_store(this.__wbg_ptr,n,i,r,s)}add_single_frame(e,t,n,i,r,s,o,a,c,l){const u=vn(e,nn.__wbindgen_malloc),f=on,d=fn(t,nn.__wbindgen_malloc,nn.__wbindgen_realloc),h=on;nn.growingpacker_add_single_frame(this.__wbg_ptr,u,f,d,h,n,i,r,s,o,a,c,l)}add_spritesheet_frame(e,t,n,i,r,s,o,a,c,l,u,f,d,h){const m=fn(e,nn.__wbindgen_malloc,nn.__wbindgen_realloc),p=on,g=fn(t,nn.__wbindgen_malloc,nn.__wbindgen_realloc),w=on;nn.growingpacker_add_spritesheet_frame(this.__wbg_ptr,m,p,g,w,n,i,r,s,o,a,c,l,u,f,d,h)}make_packed_image(){try{const i=nn.__wbindgen_add_to_stack_pointer(-16);nn.growingpacker_make_packed_image(i,this.__wbg_ptr);var e=hn()[i/4+0],t=hn()[i/4+1],n=xn(e,t).slice();return nn.__wbindgen_free(e,1*t),n}finally{nn.__wbindgen_add_to_stack_pointer(16)}}}class yn{static __wrap(e){e>>>=0;const t=Object.create(yn.prototype);return t.__wbg_ptr=e,t}__destroy_into_raw(){const e=this.__wbg_ptr;return this.__wbg_ptr=0,e}free(){const e=this.__destroy_into_raw();nn.__wbg_iconpacker_free(e)}static new(){const e=nn.iconpacker_new();return yn.__wrap(e)}add_image(e){nn.iconpacker_add_image(this.__wbg_ptr,_n(e))}make_packed_image(){try{const i=nn.__wbindgen_add_to_stack_pointer(-16);nn.iconpacker_make_packed_image(i,this.__wbg_ptr);var e=hn()[i/4+0],t=hn()[i/4+1],n=xn(e,t).slice();return nn.__wbindgen_free(e,1*t),n}finally{nn.__wbindgen_add_to_stack_pointer(16)}}}function $n(){const e={wbg:{}};return e.wbg.__wbindgen_string_get=function(e,t){const n=sn(t),i="string"==typeof n?n:void 0;var r=null==i?0:fn(i,nn.__wbindgen_malloc,nn.__wbindgen_realloc),s=on;hn()[e/4+1]=s,hn()[e/4+0]=r},e.wbg.__wbindgen_object_drop_ref=function(e){pn(e)},e.wbg.__wbg_new_abda76e883ba8a5f=function(){return _n(new Error)},e.wbg.__wbg_stack_658279fe44541cf6=function(e,t){const n=fn(sn(t).stack,nn.__wbindgen_malloc,nn.__wbindgen_realloc),i=on;hn()[e/4+1]=i,hn()[e/4+0]=n},e.wbg.__wbg_error_f851667af71bcfc6=function(e,t){let n,i;try{n=e,i=t,console.error(wn(e,t))}finally{nn.__wbindgen_free(n,i)}},e.wbg.__wbg_get_7303ed2ef026b2f5=function(e,t){return _n(sn(e)[t>>>0])},e.wbg.__wbg_length_820c786973abdd8a=function(e){return sn(e).length},e.wbg.__wbg_buffer_55ba7a6b1b92e2ac=function(e){return _n(sn(e).buffer)},e.wbg.__wbg_new_09938a7d020f049b=function(e){return _n(new Uint8Array(sn(e)))},e.wbg.__wbg_set_3698e3ca519b3c3c=function(e,t,n){sn(e).set(sn(t),n>>>0)},e.wbg.__wbg_length_0aab7ffd65ad19ed=function(e){return sn(e).length},e.wbg.__wbindgen_throw=function(e,t){throw new Error(wn(e,t))},e.wbg.__wbindgen_memory=function(){return _n(nn.memory)},e}function kn(e,t){return nn=e.exports,In.__wbindgen_wasm_module=t,dn=null,an=null,nn}async function In(e){if(void 0!==nn)return nn;const t=$n();("string"==typeof e||"function"==typeof Request&&e instanceof Request||"function"==typeof URL&&e instanceof URL)&&(e=fetch(e));const{instance:n,module:i}=await async function(e,t){if("function"==typeof Response&&e instanceof Response){if("function"==typeof WebAssembly.instantiateStreaming)try{return await WebAssembly.instantiateStreaming(e,t)}catch(t){if("application/wasm"==e.headers.get("Content-Type"))throw t;console.warn("`WebAssembly.instantiateStreaming` failed because your server does not serve wasm with `application/wasm` MIME type. Falling back to `WebAssembly.instantiate` which is slower. Original error:\n",t)}const n=await e.arrayBuffer();return await WebAssembly.instantiate(n,t)}{const n=await WebAssembly.instantiate(e,t);return n instanceof WebAssembly.Instance?{instance:n,module:e}:n}}(await e,t);return kn(n,i)}var Cn=Object.freeze({__proto__:null,GrowingPacker:bn,IconPacker:yn,default:In,initSync:function(e){if(void 0!==nn)return nn;const t=$n();return e instanceof WebAssembly.Module||(e=new WebAssembly.Module(e)),kn(new WebAssembly.Instance(e,t),e)},init_panic_hook:function(){nn.init_panic_hook()},make_icongrid_legacy:function(e,t){try{const s=nn.__wbindgen_add_to_stack_pointer(-16),o=vn(e,nn.__wbindgen_malloc),a=on;nn.make_icongrid_legacy(s,o,a,_n(t));var n=hn()[s/4+0],i=hn()[s/4+1],r=xn(n,i).slice();return nn.__wbindgen_free(n,1*i),r}finally{nn.__wbindgen_add_to_stack_pointer(16)}}});return(async()=>{const e=await(async(e={})=>{let{importHook:t,serverPath:n}=e,i="./build/assets/rust_img_lib-edc6bbfd.wasm";return null!=n&&(i=n+/[^\/\\]*$/.exec(i)[0]),null!=t&&(i=t(i)),await In(i),Cn})();e.init_panic_hook();return new tn({target:document.body,props:{wasm:e}})})()}();
//# sourceMappingURL=bundle.js.map
